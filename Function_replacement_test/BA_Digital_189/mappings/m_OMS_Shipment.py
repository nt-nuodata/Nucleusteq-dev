# Databricks notebook source
# MAGIC %run "./udf_informatica"

# COMMAND ----------


from pyspark.sql.types import *

spark.sql("use DELTA_TRAINING")
spark.sql("set spark.sql.legacy.timeParserPolicy = LEGACY")

# COMMAND ----------
%run ../WorkflowUtility

# COMMAND ----------
mainWorkflowId = dbutils.widgets.get("mainWorkflowId")
mainWorkflowRunId = dbutils.widgets.get("mainWorkflowRunId")
parentName = dbutils.widgets.get("parentName")
preVariableAssignment = dbutils.widgets.get("preVariableAssignment")
postVariableAssignment = dbutils.widgets.get("postVariableAssignment")
truncTargetTableOptions = dbutils.widgets.get("truncTargetTableOptions")
variablesTableName = dbutils.widgets.get("variablesTableName")

# COMMAND ----------
#Truncate Target Tables
truncateTargetTables(truncTargetTableOptions)

# COMMAND ----------
#Pre presession variable updation
updateVariable(preVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Shipment")

# COMMAND ----------
fetchAndCreateVariables(parentName,"m_OMS_Shipment", variablesTableName, mainWorkflowId)

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_SHIPMENT_DDS1_0


query_0 = f"""SELECT
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_TC_SHIPMENT_ID AS OMS_TC_SHIPMENT_ID,
  OMS_SHIPMENT_TYPE_CD AS OMS_SHIPMENT_TYPE_CD,
  OMS_SHIPMENT_STATUS_ID AS OMS_SHIPMENT_STATUS_ID,
  SHIPMENT_CLOSED_IND AS SHIPMENT_CLOSED_IND,
  OMS_STATUS_CHANGE_TSTMP AS OMS_STATUS_CHANGE_TSTMP,
  OMS_CREATION_TYPE_ID AS OMS_CREATION_TYPE_ID,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  AUTO_DELIVERED_FLAG AS AUTO_DELIVERED_FLAG,
  SHIPMENT_RECONCILED_FLAG AS SHIPMENT_RECONCILED_FLAG,
  OMS_SHIPMENT_LEG_TYPE_ID AS OMS_SHIPMENT_LEG_TYPE_ID,
  DELIVERY_REQ AS DELIVERY_REQ,
  OMS_AVAILABLE_TSTMP AS OMS_AVAILABLE_TSTMP,
  OMS_REGION_ID AS OMS_REGION_ID,
  OMS_INBOUND_REGION_ID AS OMS_INBOUND_REGION_ID,
  OMS_OUTBOUND_REGION_ID AS OMS_OUTBOUND_REGION_ID,
  OMS_O_FACILITY_NBR AS OMS_O_FACILITY_NBR,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  O_ADDR AS O_ADDR,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_ADDR AS D_ADDR,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  PERISHABLE_FLAG AS PERISHABLE_FLAG,
  HAS_NOTES_FLAG AS HAS_NOTES_FLAG,
  HAS_ALERTS_FLAG AS HAS_ALERTS_FLAG,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  HAS_IMPORT_ERROR_FLAG AS HAS_IMPORT_ERROR_FLAG,
  HAS_SOFT_CHECK_ERROR_FLAG AS HAS_SOFT_CHECK_ERROR_FLAG,
  HAS_TRACKING_MSG_FLAG AS HAS_TRACKING_MSG_FLAG,
  TRACKING_MSG_PROBLEM_FLAG AS TRACKING_MSG_PROBLEM_FLAG,
  USE_BROKER_AS_CARRIER_FLAG AS USE_BROKER_AS_CARRIER_FLAG,
  UPDATE_SENT_FLAG AS UPDATE_SENT_FLAG,
  MANUAL_ASSIGN_FLAG AS MANUAL_ASSIGN_FLAG,
  OMS_PRIORITY_TYPE_ID AS OMS_PRIORITY_TYPE_ID,
  RETAIN_CONSOLIDATOR_TIMES_FLAG AS RETAIN_CONSOLIDATOR_TIMES_FLAG,
  OMS_EVENT_IND_TYPE_ID AS OMS_EVENT_IND_TYPE_ID,
  OMS_DELAY_TYPE_ID AS OMS_DELAY_TYPE_ID,
  OMS_ASSIGNED_CARRIER_ID AS OMS_ASSIGNED_CARRIER_ID,
  OMS_ASSIGNED_CARRIER_CD AS OMS_ASSIGNED_CARRIER_CD,
  OMS_BILLING_METHOD_ID AS OMS_BILLING_METHOD_ID,
  OMS_TRANS_RESP_CD AS OMS_TRANS_RESP_CD,
  OMS_PICK_START_TSTMP AS OMS_PICK_START_TSTMP,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  TOTAL_TIME AS TOTAL_TIME,
  ORDER_QTY AS ORDER_QTY,
  REPORTED_COST AS REPORTED_COST,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  TOTAL_COST AS TOTAL_COST,
  CURRENCY_CD AS CURRENCY_CD,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_SOURCE_TYPE_ID AS OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  OMS_LAST_UPDATED_SOURCE AS OMS_LAST_UPDATED_SOURCE,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_SHIPMENT_DDS"""

df_0 = spark.sql(query_0)

df_0.createOrReplaceTempView("Shortcut_to_OMS_SHIPMENT_DDS1_0")

# COMMAND ----------
# DBTITLE 1, SQ_SHIPMENT_DDS_1


query_1 = f"""SELECT
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_TC_SHIPMENT_ID AS OMS_TC_SHIPMENT_ID,
  OMS_SHIPMENT_TYPE_CD AS OMS_SHIPMENT_TYPE_CD,
  OMS_SHIPMENT_STATUS_ID AS OMS_SHIPMENT_STATUS_ID,
  SHIPMENT_CLOSED_IND AS SHIPMENT_CLOSED_IND,
  OMS_STATUS_CHANGE_TSTMP AS OMS_STATUS_CHANGE_TSTMP,
  OMS_CREATION_TYPE_ID AS OMS_CREATION_TYPE_ID,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  AUTO_DELIVERED_FLAG AS AUTO_DELIVERED_FLAG,
  SHIPMENT_RECONCILED_FLAG AS SHIPMENT_RECONCILED_FLAG,
  OMS_SHIPMENT_LEG_TYPE_ID AS OMS_SHIPMENT_LEG_TYPE_ID,
  DELIVERY_REQ AS DELIVERY_REQ,
  OMS_AVAILABLE_TSTMP AS OMS_AVAILABLE_TSTMP,
  OMS_REGION_ID AS OMS_REGION_ID,
  OMS_INBOUND_REGION_ID AS OMS_INBOUND_REGION_ID,
  OMS_OUTBOUND_REGION_ID AS OMS_OUTBOUND_REGION_ID,
  OMS_O_FACILITY_NBR AS OMS_O_FACILITY_NBR,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  O_ADDR AS O_ADDR,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_ADDR AS D_ADDR,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  PERISHABLE_FLAG AS PERISHABLE_FLAG,
  HAS_NOTES_FLAG AS HAS_NOTES_FLAG,
  HAS_ALERTS_FLAG AS HAS_ALERTS_FLAG,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  HAS_IMPORT_ERROR_FLAG AS HAS_IMPORT_ERROR_FLAG,
  HAS_SOFT_CHECK_ERROR_FLAG AS HAS_SOFT_CHECK_ERROR_FLAG,
  HAS_TRACKING_MSG_FLAG AS HAS_TRACKING_MSG_FLAG,
  TRACKING_MSG_PROBLEM_FLAG AS TRACKING_MSG_PROBLEM_FLAG,
  USE_BROKER_AS_CARRIER_FLAG AS USE_BROKER_AS_CARRIER_FLAG,
  UPDATE_SENT_FLAG AS UPDATE_SENT_FLAG,
  MANUAL_ASSIGN_FLAG AS MANUAL_ASSIGN_FLAG,
  OMS_PRIORITY_TYPE_ID AS OMS_PRIORITY_TYPE_ID,
  RETAIN_CONSOLIDATOR_TIMES_FLAG AS RETAIN_CONSOLIDATOR_TIMES_FLAG,
  OMS_EVENT_IND_TYPE_ID AS OMS_EVENT_IND_TYPE_ID,
  OMS_DELAY_TYPE_ID AS OMS_DELAY_TYPE_ID,
  OMS_ASSIGNED_CARRIER_ID AS OMS_ASSIGNED_CARRIER_ID,
  OMS_ASSIGNED_CARRIER_CD AS OMS_ASSIGNED_CARRIER_CD,
  OMS_BILLING_METHOD_ID AS OMS_BILLING_METHOD_ID,
  OMS_TRANS_RESP_CD AS OMS_TRANS_RESP_CD,
  OMS_PICK_START_TSTMP AS OMS_PICK_START_TSTMP,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  TOTAL_TIME AS TOTAL_TIME,
  ORDER_QTY AS ORDER_QTY,
  REPORTED_COST AS REPORTED_COST,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  TOTAL_COST AS TOTAL_COST,
  CURRENCY_CD AS CURRENCY_CD,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_SOURCE_TYPE_ID AS OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  OMS_LAST_UPDATED_SOURCE AS OMS_LAST_UPDATED_SOURCE,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_SHIPMENT_DDS1_0"""

df_1 = spark.sql(query_1)

df_1.createOrReplaceTempView("SQ_SHIPMENT_DDS_1")

# COMMAND ----------
# DBTITLE 1, FLT_UPDATE_TSTMP_2


query_2 = f"""SELECT
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_TC_SHIPMENT_ID AS OMS_TC_SHIPMENT_ID,
  OMS_SHIPMENT_TYPE_CD AS OMS_SHIPMENT_TYPE_CD,
  OMS_SHIPMENT_STATUS_ID AS OMS_SHIPMENT_STATUS_ID,
  SHIPMENT_CLOSED_IND AS SHIPMENT_CLOSED_IND,
  OMS_STATUS_CHANGE_TSTMP AS OMS_STATUS_CHANGE_TSTMP,
  OMS_CREATION_TYPE_ID AS OMS_CREATION_TYPE_ID,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  AUTO_DELIVERED_FLAG AS AUTO_DELIVERED_FLAG,
  SHIPMENT_RECONCILED_FLAG AS SHIPMENT_RECONCILED_FLAG,
  OMS_SHIPMENT_LEG_TYPE_ID AS OMS_SHIPMENT_LEG_TYPE_ID,
  DELIVERY_REQ AS DELIVERY_REQ,
  OMS_AVAILABLE_TSTMP AS OMS_AVAILABLE_TSTMP,
  OMS_REGION_ID AS OMS_REGION_ID,
  OMS_INBOUND_REGION_ID AS OMS_INBOUND_REGION_ID,
  OMS_OUTBOUND_REGION_ID AS OMS_OUTBOUND_REGION_ID,
  OMS_O_FACILITY_NBR AS OMS_O_FACILITY_NBR,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  O_ADDR AS O_ADDR,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_ADDR AS D_ADDR,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  PERISHABLE_FLAG AS PERISHABLE_FLAG,
  HAS_NOTES_FLAG AS HAS_NOTES_FLAG,
  HAS_ALERTS_FLAG AS HAS_ALERTS_FLAG,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  HAS_IMPORT_ERROR_FLAG AS HAS_IMPORT_ERROR_FLAG,
  HAS_SOFT_CHECK_ERROR_FLAG AS HAS_SOFT_CHECK_ERROR_FLAG,
  HAS_TRACKING_MSG_FLAG AS HAS_TRACKING_MSG_FLAG,
  TRACKING_MSG_PROBLEM_FLAG AS TRACKING_MSG_PROBLEM_FLAG,
  USE_BROKER_AS_CARRIER_FLAG AS USE_BROKER_AS_CARRIER_FLAG,
  UPDATE_SENT_FLAG AS UPDATE_SENT_FLAG,
  MANUAL_ASSIGN_FLAG AS MANUAL_ASSIGN_FLAG,
  OMS_PRIORITY_TYPE_ID AS OMS_PRIORITY_TYPE_ID,
  RETAIN_CONSOLIDATOR_TIMES_FLAG AS RETAIN_CONSOLIDATOR_TIMES_FLAG,
  OMS_EVENT_IND_TYPE_ID AS OMS_EVENT_IND_TYPE_ID,
  OMS_DELAY_TYPE_ID AS OMS_DELAY_TYPE_ID,
  OMS_ASSIGNED_CARRIER_ID AS OMS_ASSIGNED_CARRIER_ID,
  OMS_ASSIGNED_CARRIER_CD AS OMS_ASSIGNED_CARRIER_CD,
  OMS_BILLING_METHOD_ID AS OMS_BILLING_METHOD_ID,
  OMS_TRANS_RESP_CD AS OMS_TRANS_RESP_CD,
  OMS_PICK_START_TSTMP AS OMS_PICK_START_TSTMP,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  TOTAL_TIME AS TOTAL_TIME,
  ORDER_QTY AS ORDER_QTY,
  REPORTED_COST AS REPORTED_COST,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  TOTAL_COST AS TOTAL_COST,
  CURRENCY_CD AS CURRENCY_CD,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_SOURCE_TYPE_ID AS OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  OMS_LAST_UPDATED_SOURCE AS OMS_LAST_UPDATED_SOURCE,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_SHIPMENT_DDS_1
WHERE
  UPDATE_TSTMP > TRUNC(now())"""

df_2 = spark.sql(query_2)

df_2.createOrReplaceTempView("FLT_UPDATE_TSTMP_2")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_LPN_DDS_3


query_3 = f"""SELECT
  OMS_LPN_ID AS OMS_LPN_ID,
  OMS_TC_LPN_ID AS OMS_TC_LPN_ID,
  OMS_PARENT_LPN_ID AS OMS_PARENT_LPN_ID,
  OMS_LPN_TYPE_ID AS OMS_LPN_TYPE_ID,
  OMS_LPN_STATUS_ID AS OMS_LPN_STATUS_ID,
  OMS_LPN_STATUS_UPDATED_TSTMP AS OMS_LPN_STATUS_UPDATED_TSTMP,
  OMS_ORDER_ID AS OMS_ORDER_ID,
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  OMS_ASN_ID AS OMS_ASN_ID,
  OMS_TC_ASN_ID AS OMS_TC_ASN_ID,
  OMS_FINAL_DEST_FACILITY_ALIAS_ID AS OMS_FINAL_DEST_FACILITY_ALIAS_ID,
  OMS_TRACKING_NBR AS OMS_TRACKING_NBR,
  BASE_CHARGE_AMT AS BASE_CHARGE_AMT,
  BASE_CHARGE_CURRENCY_CD AS BASE_CHARGE_CURRENCY_CD,
  ADDL_OPTION_CHARGE_AMT AS ADDL_OPTION_CHARGE_AMT,
  ADDL_OPTION_CHARGE_CURRENCY_CD AS ADDL_OPTION_CHARGE_CURRENCY_CD,
  ACTUAL_CHARGE_AMT AS ACTUAL_CHARGE_AMT,
  ACTUAL_CHARGE_CURRENCY_CD AS ACTUAL_CHARGE_CURRENCY_CD,
  DIST_CHARGE_AMT AS DIST_CHARGE_AMT,
  DIST_CHARGE_CURRENCY_CD AS DIST_CHARGE_CURRENCY_CD,
  FREIGHT_CHARGE_AMT AS FREIGHT_CHARGE_AMT,
  FREIGHT_CHARGE_CURRENCY_CD AS FREIGHT_CHARGE_CURRENCY_CD,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_LPN_DDS"""

df_3 = spark.sql(query_3)

df_3.createOrReplaceTempView("Shortcut_to_OMS_LPN_DDS_3")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_LPN_DDS_4


query_4 = f"""SELECT
  OMS_ORDER_ID AS OMS_ORDER_ID,
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_LPN_DDS_3"""

df_4 = spark.sql(query_4)

df_4.createOrReplaceTempView("SQ_Shortcut_to_OMS_LPN_DDS_4")

# COMMAND ----------
# DBTITLE 1, SRT_LPN_5


query_5 = f"""SELECT
  OMS_ORDER_ID AS OMS_ORDER_ID,
  OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_LPN_DDS_4
ORDER BY
  OMS_ORDER_ID ASC,
  OMS_SHIPMENT_ID ASC"""

df_5 = spark.sql(query_5)

df_5.createOrReplaceTempView("SRT_LPN_5")

# COMMAND ----------
# DBTITLE 1, JNR_LPN_6


query_6 = f"""SELECT
  MASTER.OMS_ORDER_ID AS OMS_ORDER_ID,
  DETAIL.OMS_SHIPMENT_ID AS OMS_SHIPMENT_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_SHIPMENT_ID AS OMS_TC_SHIPMENT_ID,
  DETAIL.OMS_SHIPMENT_TYPE_CD AS OMS_SHIPMENT_TYPE_CD,
  DETAIL.OMS_SHIPMENT_STATUS_ID AS OMS_SHIPMENT_STATUS_ID,
  DETAIL.SHIPMENT_CLOSED_IND AS SHIPMENT_CLOSED_IND,
  DETAIL.OMS_STATUS_CHANGE_TSTMP AS OMS_STATUS_CHANGE_TSTMP,
  DETAIL.OMS_CREATION_TYPE_ID AS OMS_CREATION_TYPE_ID,
  DETAIL.CANCELLED_FLAG AS CANCELLED_FLAG,
  DETAIL.AUTO_DELIVERED_FLAG AS AUTO_DELIVERED_FLAG,
  DETAIL.SHIPMENT_RECONCILED_FLAG AS SHIPMENT_RECONCILED_FLAG,
  DETAIL.OMS_SHIPMENT_LEG_TYPE_ID AS OMS_SHIPMENT_LEG_TYPE_ID,
  DETAIL.DELIVERY_REQ AS DELIVERY_REQ,
  DETAIL.OMS_AVAILABLE_TSTMP AS OMS_AVAILABLE_TSTMP,
  DETAIL.OMS_REGION_ID AS OMS_REGION_ID,
  DETAIL.OMS_INBOUND_REGION_ID AS OMS_INBOUND_REGION_ID,
  DETAIL.OMS_OUTBOUND_REGION_ID AS OMS_OUTBOUND_REGION_ID,
  DETAIL.OMS_O_FACILITY_NBR AS OMS_O_FACILITY_NBR,
  DETAIL.OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  DETAIL.O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  DETAIL.D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  DETAIL.O_ADDR AS O_ADDR,
  DETAIL.O_CITY AS O_CITY,
  DETAIL.O_STATE_PROV AS O_STATE_PROV,
  DETAIL.O_POSTAL_CD AS O_POSTAL_CD,
  DETAIL.O_COUNTRY_CD AS O_COUNTRY_CD,
  DETAIL.D_ADDR AS D_ADDR,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CD AS D_POSTAL_CD,
  DETAIL.D_COUNTRY_CD AS D_COUNTRY_CD,
  DETAIL.PERISHABLE_FLAG AS PERISHABLE_FLAG,
  DETAIL.HAS_NOTES_FLAG AS HAS_NOTES_FLAG,
  DETAIL.HAS_ALERTS_FLAG AS HAS_ALERTS_FLAG,
  DETAIL.HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  DETAIL.SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  DETAIL.HAS_IMPORT_ERROR_FLAG AS HAS_IMPORT_ERROR_FLAG,
  DETAIL.HAS_SOFT_CHECK_ERROR_FLAG AS HAS_SOFT_CHECK_ERROR_FLAG,
  DETAIL.HAS_TRACKING_MSG_FLAG AS HAS_TRACKING_MSG_FLAG,
  DETAIL.TRACKING_MSG_PROBLEM_FLAG AS TRACKING_MSG_PROBLEM_FLAG,
  DETAIL.USE_BROKER_AS_CARRIER_FLAG AS USE_BROKER_AS_CARRIER_FLAG,
  DETAIL.UPDATE_SENT_FLAG AS UPDATE_SENT_FLAG,
  DETAIL.MANUAL_ASSIGN_FLAG AS MANUAL_ASSIGN_FLAG,
  DETAIL.OMS_PRIORITY_TYPE_ID AS OMS_PRIORITY_TYPE_ID,
  DETAIL.RETAIN_CONSOLIDATOR_TIMES_FLAG AS RETAIN_CONSOLIDATOR_TIMES_FLAG,
  DETAIL.OMS_EVENT_IND_TYPE_ID AS OMS_EVENT_IND_TYPE_ID,
  DETAIL.OMS_DELAY_TYPE_ID AS OMS_DELAY_TYPE_ID,
  DETAIL.OMS_ASSIGNED_CARRIER_ID AS OMS_ASSIGNED_CARRIER_ID,
  DETAIL.OMS_ASSIGNED_CARRIER_CD AS OMS_ASSIGNED_CARRIER_CD,
  DETAIL.OMS_BILLING_METHOD_ID AS OMS_BILLING_METHOD_ID,
  DETAIL.OMS_TRANS_RESP_CD AS OMS_TRANS_RESP_CD,
  DETAIL.OMS_PICK_START_TSTMP AS OMS_PICK_START_TSTMP,
  DETAIL.OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  DETAIL.OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  DETAIL.OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  DETAIL.OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  DETAIL.OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  DETAIL.OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  DETAIL.NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  DETAIL.NUM_STOPS AS NUM_STOPS,
  DETAIL.NUM_DOCKS AS NUM_DOCKS,
  DETAIL.TOTAL_TIME AS TOTAL_TIME,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.REPORTED_COST AS REPORTED_COST,
  DETAIL.WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  DETAIL.WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  DETAIL.TOTAL_COST AS TOTAL_COST,
  DETAIL.CURRENCY_CD AS CURRENCY_CD,
  DETAIL.MV_CURRENCY_CD AS MV_CURRENCY_CD,
  DETAIL.OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  DETAIL.OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.OMS_LAST_UPDATED_SOURCE_TYPE_ID AS OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  DETAIL.OMS_LAST_UPDATED_SOURCE AS OMS_LAST_UPDATED_SOURCE,
  DETAIL.OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  DETAIL.UPDATE_TSTMP AS UPDATE_TSTMP,
  DETAIL.LOAD_TSTMP AS LOAD_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SRT_LPN_5 MASTER
  RIGHT JOIN FLT_UPDATE_TSTMP_2 DETAIL ON MASTER.OMS_SHIPMENT_ID = DETAIL.OMS_SHIPMENT_ID"""

df_6 = spark.sql(query_6)

df_6.createOrReplaceTempView("JNR_LPN_6")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_SHIPMENT_7


query_7 = f"""SELECT
  SHIPMENT_ID AS SHIPMENT_ID,
  OMS_DIST_ORDER_ID AS OMS_DIST_ORDER_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  RS_AREA_ID AS RS_AREA_ID,
  TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  PP_SHIPMENT_ID AS PP_SHIPMENT_ID,
  SHIPMENT_STATUS AS SHIPMENT_STATUS,
  UPDATE_SENT AS UPDATE_SENT,
  BUSINESS_PROCESS AS BUSINESS_PROCESS,
  CREATION_TYPE AS CREATION_TYPE,
  CONS_RUN_ID AS CONS_RUN_ID,
  IS_CANCELLED AS IS_CANCELLED,
  RS_TYPE AS RS_TYPE,
  RS_CONFIG_ID AS RS_CONFIG_ID,
  RS_CONFIG_CYCLE_ID AS RS_CONFIG_CYCLE_ID,
  CONFIG_CYCLE_SEQ AS CONFIG_CYCLE_SEQ,
  CYCLE_DEADLINE_DT AS CYCLE_DEADLINE_DT,
  CYCLE_EXECUTION_DT AS CYCLE_EXECUTION_DT,
  LAST_RS_NOTIFICATION_DT AS LAST_RS_NOTIFICATION_DT,
  CFMF_STATUS AS CFMF_STATUS,
  AVAILABLE_DT AS AVAILABLE_DT,
  CMID AS CMID,
  CM_DISCOUNT AS CM_DISCOUNT,
  O_FACILITY_NBR AS O_FACILITY_NBR,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_ADDRESS AS O_ADDRESS,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTY AS O_COUNTY,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_FACILITY_NBR AS D_FACILITY_NBR,
  D_FACILITY_ID AS D_FACILITY_ID,
  D_ADDRESS AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  DISTANCE AS DISTANCE,
  DIRECT_DISTANCE AS DIRECT_DISTANCE,
  OUT_OF_ROUTE_DISTANCE AS OUT_OF_ROUTE_DISTANCE,
  DISTANCE_UOM AS DISTANCE_UOM,
  BUSINESS_PARTNER_ID AS BUSINESS_PARTNER_ID,
  COMMODITY_CLASS AS COMMODITY_CLASS,
  IS_HAZMAT AS IS_HAZMAT,
  IS_PERISHABLE AS IS_PERISHABLE,
  BILLING_METHOD AS BILLING_METHOD,
  DSG_CARRIER_CD AS DSG_CARRIER_CD,
  REC_CMID AS REC_CMID,
  REC_CM_SHIPMENT_ID AS REC_CM_SHIPMENT_ID,
  ASSIGNED_CARRIER_CD AS ASSIGNED_CARRIER_CD,
  SHIPMENT_REF_ID AS SHIPMENT_REF_ID,
  BILL_TO_CD AS BILL_TO_CD,
  BILL_TO_TITLE AS BILL_TO_TITLE,
  BILL_TO_NAME AS BILL_TO_NAME,
  BILL_TO_ADDRESS AS BILL_TO_ADDRESS,
  BILL_TO_CITY AS BILL_TO_CITY,
  BILL_TO_STATE_PROV AS BILL_TO_STATE_PROV,
  BILL_TO_POSTAL_CD AS BILL_TO_POSTAL_CD,
  BILL_TO_COUNTRY_CD AS BILL_TO_COUNTRY_CD,
  BILL_TO_PHONE_NBR AS BILL_TO_PHONE_NBR,
  PURCHASE_ORDER AS PURCHASE_ORDER,
  PRO_NBR AS PRO_NBR,
  TRANS_RESP_CD AS TRANS_RESP_CD,
  BASELINE_COST AS BASELINE_COST,
  ESTIMATED_COST AS ESTIMATED_COST,
  LINEHAUL_COST AS LINEHAUL_COST,
  ACCESSORIAL_COST AS ACCESSORIAL_COST,
  STOP_COST AS STOP_COST,
  ESTIMATED_SAVINGS AS ESTIMATED_SAVINGS,
  SPOT_CHARGE AS SPOT_CHARGE,
  CURRENCY_CD AS CURRENCY_CD,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  ON_TIME_INDICATOR AS ON_TIME_INDICATOR,
  HAS_NOTES AS HAS_NOTES,
  HAS_ALERTS AS HAS_ALERTS,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_SOFT_CHECK_ERROR AS HAS_SOFT_CHECK_ERROR,
  HAS_TRACKING_MSG AS HAS_TRACKING_MSG,
  TRACKING_MSG_PROBLEM AS TRACKING_MSG_PROBLEM,
  REC_LINEHAUL_COST AS REC_LINEHAUL_COST,
  REC_ACCESSORIAL_COST AS REC_ACCESSORIAL_COST,
  REC_TOTAL_COST AS REC_TOTAL_COST,
  CYCLE_RESP_DEADLINE_TZ AS CYCLE_RESP_DEADLINE_TZ,
  TENDER_RESP_DEADLINE_TZ AS TENDER_RESP_DEADLINE_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  DELIVERY_TZ AS DELIVERY_TZ,
  ASSIGNED_LANE_ID AS ASSIGNED_LANE_ID,
  ASSIGNED_LANE_DETAIL_ID AS ASSIGNED_LANE_DETAIL_ID,
  REC_SPOT_CHARGE AS REC_SPOT_CHARGE,
  REC_LANE_ID AS REC_LANE_ID,
  REC_LANE_DETAIL_ID AS REC_LANE_DETAIL_ID,
  TENDER_DT AS TENDER_DT,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  ASSIGNED_CM_SHIPMENT_ID AS ASSIGNED_CM_SHIPMENT_ID,
  REC_CM_DISCOUNT AS REC_CM_DISCOUNT,
  REC_STOP_COST AS REC_STOP_COST,
  LAST_SELECTOR_RUN_DT AS LAST_SELECTOR_RUN_DT,
  LAST_CM_OPTION_GEN_DT AS LAST_CM_OPTION_GEN_DT,
  IS_CM_OPTION_GEN_ACTIVE AS IS_CM_OPTION_GEN_ACTIVE,
  RS_CYCLE_REMAINING AS RS_CYCLE_REMAINING,
  IS_TIME_FEAS_D AS IS_TIME_FEAS_D,
  EXT_SYS_SHIPMENT_ID AS EXT_SYS_SHIPMENT_ID,
  EXTRACTION_DT AS EXTRACTION_DT,
  ASSIGNED_BROKER_CARRIER_CD AS ASSIGNED_BROKER_CARRIER_CD,
  USE_BROKER_AS_CARRIER AS USE_BROKER_AS_CARRIER,
  BROKER_REF AS BROKER_REF,
  RATING_QUALIFIER AS RATING_QUALIFIER,
  STATUS_CHANGE_DT AS STATUS_CHANGE_DT,
  BUDG_TOTAL_COST AS BUDG_TOTAL_COST,
  NORMALIZED_MARGIN AS NORMALIZED_MARGIN,
  NORMALIZED_TOTAL_COST AS NORMALIZED_TOTAL_COST,
  BUDG_NORMALIZED_TOTAL_COST AS BUDG_NORMALIZED_TOTAL_COST,
  REC_BUDG_LINEHAUL_COST AS REC_BUDG_LINEHAUL_COST,
  REC_BUDG_STOP_COST AS REC_BUDG_STOP_COST,
  REC_BUDG_CM_DISCOUNT AS REC_BUDG_CM_DISCOUNT,
  REC_BUDG_ACCESSORIAL_COST AS REC_BUDG_ACCESSORIAL_COST,
  REC_BUDG_TOTAL_COST AS REC_BUDG_TOTAL_COST,
  REC_MARGIN AS REC_MARGIN,
  REC_NORMALIZED_MARGIN AS REC_NORMALIZED_MARGIN,
  REC_NORMALIZED_TOTAL_COST AS REC_NORMALIZED_TOTAL_COST,
  REC_BUDG_NORMALIZED_TOTAL_COST AS REC_BUDG_NORMALIZED_TOTAL_COST,
  BUDG_CURRENCY_CD AS BUDG_CURRENCY_CD,
  SPOT_CHARGE_CURRENCY_CD AS SPOT_CHARGE_CURRENCY_CD,
  REC_CURRENCY_CD AS REC_CURRENCY_CD,
  REC_BUDG_CURRENCY_CD AS REC_BUDG_CURRENCY_CD,
  REC_SPOT_CHARGE_CURRENCY_CD AS REC_SPOT_CHARGE_CURRENCY_CD,
  RATING_LANE_ID AS RATING_LANE_ID,
  FRT_REV_RATING_LANE_ID AS FRT_REV_RATING_LANE_ID,
  REC_RATING_LANE_ID AS REC_RATING_LANE_ID,
  REC_BUDG_RATING_LANE_ID AS REC_BUDG_RATING_LANE_ID,
  RATING_LANE_DETAIL_ID AS RATING_LANE_DETAIL_ID,
  FRT_REV_RATING_LANE_DETAIL_ID AS FRT_REV_RATING_LANE_DETAIL_ID,
  REC_RATING_LANE_DETAIL_ID AS REC_RATING_LANE_DETAIL_ID,
  REC_BUDG_RATING_LANE_DETAIL_ID AS REC_BUDG_RATING_LANE_DETAIL_ID,
  BUDG_CM_DISCOUNT AS BUDG_CM_DISCOUNT,
  NORMALIZED_BASELINE_COST AS NORMALIZED_BASELINE_COST,
  BASELINE_COST_CURRENCY_CD AS BASELINE_COST_CURRENCY_CD,
  REPORTED_COST AS REPORTED_COST,
  TRACTOR_NBR AS TRACTOR_NBR,
  IS_AUTO_DELIVERED AS IS_AUTO_DELIVERED,
  SHIPMENT_TYPE AS SHIPMENT_TYPE,
  ORIG_BUDG_TOTAL_COST AS ORIG_BUDG_TOTAL_COST,
  ACCESSORIAL_COST_TO_CARRIER AS ACCESSORIAL_COST_TO_CARRIER,
  CARRIER_CHARGE AS CARRIER_CHARGE,
  ACTUAL_COST AS ACTUAL_COST,
  EARNED_INCOME AS EARNED_INCOME,
  SENT_TO_PKMS AS SENT_TO_PKMS,
  IS_SHIPMENT_RECONCILED AS IS_SHIPMENT_RECONCILED,
  DELIVERY_REQ AS DELIVERY_REQ,
  DROPOFF_PICKUP AS DROPOFF_PICKUP,
  PACKAGING AS PACKAGING,
  SENT_TO_PKMS_DT AS SENT_TO_PKMS_DT,
  WMS_STATUS_CD AS WMS_STATUS_CD,
  SPOT_CHARGE_AND_PAYEE_ACC AS SPOT_CHARGE_AND_PAYEE_ACC,
  SPOT_CHARGE_AND_PAYEE_ACC_CC AS SPOT_CHARGE_AND_PAYEE_ACC_CC,
  NORM_SPOT_CHARGE_AND_PAYEE_ACC AS NORM_SPOT_CHARGE_AND_PAYEE_ACC,
  FACILITY_SCHEDULE_ID AS FACILITY_SCHEDULE_ID,
  EARNED_INCOME_CURRENCY_CD AS EARNED_INCOME_CURRENCY_CD,
  ACTUAL_COST_CURRENCY_CD AS ACTUAL_COST_CURRENCY_CD,
  SHIPMENT_RECON_DT AS SHIPMENT_RECON_DT,
  PLN_RATING_LANE_ID AS PLN_RATING_LANE_ID,
  PLN_RATING_LANE_DETAIL_ID AS PLN_RATING_LANE_DETAIL_ID,
  PLN_TOTAL_COST AS PLN_TOTAL_COST,
  PLN_LINEHAUL_COST AS PLN_LINEHAUL_COST,
  PLN_TOTAL_ACCESSORIAL_COST AS PLN_TOTAL_ACCESSORIAL_COST,
  PLN_STOP_OFF_COST AS PLN_STOP_OFF_COST,
  PLN_NORMALIZED_TOTAL_COST AS PLN_NORMALIZED_TOTAL_COST,
  PLN_CURRENCY_CD AS PLN_CURRENCY_CD,
  PLN_ACCESSORL_COST_TO_CARRIER AS PLN_ACCESSORL_COST_TO_CARRIER,
  PLN_CARRIER_CHARGE AS PLN_CARRIER_CHARGE,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  GRS_OPERATION AS GRS_OPERATION,
  IS_GRS_OPT_CYCLE_RUNNING AS IS_GRS_OPT_CYCLE_RUNNING,
  IS_MANUAL_ASSIGN AS IS_MANUAL_ASSIGN,
  LAST_RUN_GRS_DT AS LAST_RUN_GRS_DT,
  GRS_MAX_SHIPMENT_STATUS AS GRS_MAX_SHIPMENT_STATUS,
  PRIORITY_TYPE AS PRIORITY_TYPE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  PROD_SCHED_REF_NBR AS PROD_SCHED_REF_NBR,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  UN_NUMERIC_ID AS UN_NUMERIC_ID,
  CONTRACT_NBR AS CONTRACT_NBR,
  BOOKING_REF_SHIPPER AS BOOKING_REF_SHIPPER,
  BOOKING_REF_CARRIER AS BOOKING_REF_CARRIER,
  BK_RESOURCE_REF_EXTERNAL AS BK_RESOURCE_REF_EXTERNAL,
  BK_RESOURCE_NAME_EXTERNAL AS BK_RESOURCE_NAME_EXTERNAL,
  BK_O_FACILITY_ID AS BK_O_FACILITY_ID,
  BK_D_FACILITY_ID AS BK_D_FACILITY_ID,
  BK_MASTER_AIRWAY_BILL AS BK_MASTER_AIRWAY_BILL,
  BK_FORWARDER_AIRWAY_BILL AS BK_FORWARDER_AIRWAY_BILL,
  ASSIGNED_SCNDR_CARRIER_CD AS ASSIGNED_SCNDR_CARRIER_CD,
  CUSTOMER_CREDIT_LIMIT_ID AS CUSTOMER_CREDIT_LIMIT_ID,
  SHIPMENT_LEG_TYPE AS SHIPMENT_LEG_TYPE,
  SHIPMENT_CLOSED_INDICATOR AS SHIPMENT_CLOSED_INDICATOR,
  OCEAN_ROUTING_STAGE AS OCEAN_ROUTING_STAGE,
  BK_DEPARTURE_DT AS BK_DEPARTURE_DT,
  BK_DEPARTURE_TZ AS BK_DEPARTURE_TZ,
  BK_ARRIVAL_DT AS BK_ARRIVAL_DT,
  BK_ARRIVAL_TZ AS BK_ARRIVAL_TZ,
  BK_PICKUP_DT AS BK_PICKUP_DT,
  BK_PICKUP_TZ AS BK_PICKUP_TZ,
  BK_CUTOFF_DT AS BK_CUTOFF_DT,
  BK_CUTOFF_TZ AS BK_CUTOFF_TZ,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  RATE_TYPE AS RATE_TYPE,
  RATE_UOM AS RATE_UOM,
  PICK_START_DT AS PICK_START_DT,
  PAPERWORK_START_DT AS PAPERWORK_START_DT,
  VEHICLE_CHECK_START_DT AS VEHICLE_CHECK_START_DT,
  SHIPMENT_START_DT AS SHIPMENT_START_DT,
  SHIPMENT_END_DT AS SHIPMENT_END_DT,
  FEASIBLE_DRIVER_TYPE AS FEASIBLE_DRIVER_TYPE,
  WAVE_ID AS WAVE_ID,
  ESTIMATED_DISPATCH_DT AS ESTIMATED_DISPATCH_DT,
  TOTAL_TIME AS TOTAL_TIME,
  LOC_REFERENCE AS LOC_REFERENCE,
  BK_O_FACILITY_ALIAS_ID AS BK_O_FACILITY_ALIAS_ID,
  BK_D_FACILITY_ALIAS_ID AS BK_D_FACILITY_ALIAS_ID,
  EQUIP_UTIL_PER AS EQUIP_UTIL_PER,
  MOVE_TYPE AS MOVE_TYPE,
  DRIVER_TYPE_ID AS DRIVER_TYPE_ID,
  EQUIPMENT_TYPE AS EQUIPMENT_TYPE,
  RADIAL_DISTANCE AS RADIAL_DISTANCE,
  RADIAL_DISTANCE_UOM AS RADIAL_DISTANCE_UOM,
  DESIGNATED_TRACTOR_CD AS DESIGNATED_TRACTOR_CD,
  DESIGNATED_DRIVER_TYPE AS DESIGNATED_DRIVER_TYPE,
  IS_WAVE_MAN_CHANGED AS IS_WAVE_MAN_CHANGED,
  RETAIN_CONSOLIDATOR_TIMES AS RETAIN_CONSOLIDATOR_TIMES,
  TARIFF AS TARIFF,
  MIN_RATE AS MIN_RATE,
  FIRST_UPDATE_SENT_TO_PKMS AS FIRST_UPDATE_SENT_TO_PKMS,
  EVENT_IND_TYPEID AS EVENT_IND_TYPEID,
  TANDEM_PATH_ID AS TANDEM_PATH_ID,
  O_TANDEM_FACILITY AS O_TANDEM_FACILITY,
  D_TANDEM_FACILITY AS D_TANDEM_FACILITY,
  O_TANDEM_FACILITY_ALIAS AS O_TANDEM_FACILITY_ALIAS,
  D_TANDEM_FACILITY_ALIAS AS D_TANDEM_FACILITY_ALIAS,
  DELAY_TYPE AS DELAY_TYPE,
  ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  REC_CARRIER_ID AS REC_CARRIER_ID,
  FEASIBLE_CARRIER_ID AS FEASIBLE_CARRIER_ID,
  PAYEE_CARRIER_ID AS PAYEE_CARRIER_ID,
  SCNDR_CARRIER_ID AS SCNDR_CARRIER_ID,
  BROKER_CARRIER_ID AS BROKER_CARRIER_ID,
  ASSIGNED_SCNDR_CARRIER_ID AS ASSIGNED_SCNDR_CARRIER_ID,
  DSG_SCNDR_CARRIER_ID AS DSG_SCNDR_CARRIER_ID,
  ASSIGNED_BROKER_CARRIER_ID AS ASSIGNED_BROKER_CARRIER_ID,
  LH_PAYEE_CARRIER_ID AS LH_PAYEE_CARRIER_ID,
  REC_BROKER_CARRIER_ID AS REC_BROKER_CARRIER_ID,
  ASSIGNED_EQUIPMENT_ID AS ASSIGNED_EQUIPMENT_ID,
  DSG_EQUIPMENT_ID AS DSG_EQUIPMENT_ID,
  FEASIBLE_EQUIPMENT_ID AS FEASIBLE_EQUIPMENT_ID,
  FEASIBLE_EQUIPMENT2_ID AS FEASIBLE_EQUIPMENT2_ID,
  REC_EQUIPMENT_ID AS REC_EQUIPMENT_ID,
  ASSIGNED_MOT_ID AS ASSIGNED_MOT_ID,
  DSG_MOT_ID AS DSG_MOT_ID,
  FEASIBLE_MOT_ID AS FEASIBLE_MOT_ID,
  REC_MOT_ID AS REC_MOT_ID,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  ASSIGNED_SERVICE_LEVEL_ID AS ASSIGNED_SERVICE_LEVEL_ID,
  DSG_SERVICE_LEVEL_ID AS DSG_SERVICE_LEVEL_ID,
  FEASIBLE_SERVICE_LEVEL_ID AS FEASIBLE_SERVICE_LEVEL_ID,
  REC_SERVICE_LEVEL_ID AS REC_SERVICE_LEVEL_ID,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  REGION_ID AS REGION_ID,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  FINANCIAL_WT AS FINANCIAL_WT,
  IS_BOOKING_REQUIRED AS IS_BOOKING_REQUIRED,
  TOTAL_COST_EXCL_TAX AS TOTAL_COST_EXCL_TAX,
  TOTAL_TAX_AMOUNT AS TOTAL_TAX_AMOUNT,
  IS_ASSOCIATED_TO_OUTBOUND AS IS_ASSOCIATED_TO_OUTBOUND,
  RECEIVED_DT AS RECEIVED_DT,
  BOOKING_ID AS BOOKING_ID,
  IS_MISROUTED AS IS_MISROUTED,
  FEASIBLE_CARRIER_CD AS FEASIBLE_CARRIER_CD,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  DT_PARAM_SET_ID AS DT_PARAM_SET_ID,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  STATIC_ROUTE_ID AS STATIC_ROUTE_ID,
  IS_FILO AS IS_FILO,
  IS_COOLER_AT_NOSE AS IS_COOLER_AT_NOSE,
  AUTH_NBR AS AUTH_NBR,
  CONS_LOCN_ID AS CONS_LOCN_ID,
  RTE_TYPE AS RTE_TYPE,
  TRLR_TYPE AS TRLR_TYPE,
  TRLR_SIZE AS TRLR_SIZE,
  CONS_ADDR_CD AS CONS_ADDR_CD,
  HUB_ID AS HUB_ID,
  TRLR_GEN_CD AS TRLR_GEN_CD,
  MAX_NBR_OF_CTNS AS MAX_NBR_OF_CTNS,
  APPT_DOOR_SCHED_TYPE AS APPT_DOOR_SCHED_TYPE,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  DSG_SCNDR_CARRIER_CD AS DSG_SCNDR_CARRIER_CD,
  LH_PAYEE_CARRIER_CD AS LH_PAYEE_CARRIER_CD,
  REC_BROKER_CARRIER_CD AS REC_BROKER_CARRIER_CD,
  REC_CARRIER_CD AS REC_CARRIER_CD,
  LPN_ASSIGNMENT_STOPPED AS LPN_ASSIGNMENT_STOPPED,
  SEAL_NBR AS SEAL_NBR,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  SHIP_GROUP_ID AS SHIP_GROUP_ID,
  RATE AS RATE,
  MONETARY_VALUE AS MONETARY_VALUE,
  DOOR AS DOOR,
  RTE_TYPE_1 AS RTE_TYPE_1,
  RTE_TYPE_2 AS RTE_TYPE_2,
  SCHEDULED_PICKUP_DT AS SCHEDULED_PICKUP_DT,
  MANIFEST_ID AS MANIFEST_ID,
  DAYS_TO_DELIVER AS DAYS_TO_DELIVER,
  SED_GENERATED_FLAG AS SED_GENERATED_FLAG,
  SERV_AREA_CD AS SERV_AREA_CD,
  TENDER_RESP_DEADLINE_TSTMP AS TENDER_RESP_DEADLINE_TSTMP,
  PRINT_CONS_BOL AS PRINT_CONS_BOL,
  LEFT_WT AS LEFT_WT,
  RIGHT_WT AS RIGHT_WT,
  LANE_NAME AS LANE_NAME,
  DECLARED_VALUE AS DECLARED_VALUE,
  DV_CURRENCY_CD AS DV_CURRENCY_CD,
  COD_AMOUNT AS COD_AMOUNT,
  CUSTOMER_ID AS CUSTOMER_ID,
  CUST_FRGT_CHARGE AS CUST_FRGT_CHARGE,
  COD_CURRENCY_CD AS COD_CURRENCY_CD,
  PLANNED_WEIGHT AS PLANNED_WEIGHT,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  PLANNED_VOLUME AS PLANNED_VOLUME,
  VOLUME_UOM_ID_BASE AS VOLUME_UOM_ID_BASE,
  SIZE1_VALUE AS SIZE1_VALUE,
  SIZE1_UOM_ID AS SIZE1_UOM_ID,
  SIZE2_VALUE AS SIZE2_VALUE,
  SIZE2_UOM_ID AS SIZE2_UOM_ID,
  ASSIGNED_SHIP_VIA AS ASSIGNED_SHIP_VIA,
  INSURANCE_STATUS AS INSURANCE_STATUS,
  RTE_SWC_NBR AS RTE_SWC_NBR,
  RTE_TO AS RTE_TO,
  BILL_OF_LADING_NBR AS BILL_OF_LADING_NBR,
  TRAILER_NBR AS TRAILER_NBR,
  TRANS_PLAN_OWNER AS TRANS_PLAN_OWNER,
  TOTAL_REVENUE_CURRENCY_CD AS TOTAL_REVENUE_CURRENCY_CD,
  TOTAL_REVENUE AS TOTAL_REVENUE,
  FRT_REV_SPOT_CHARGE_CURR_CD AS FRT_REV_SPOT_CHARGE_CURR_CD,
  NORMALIZED_TOTAL_REVENUE AS NORMALIZED_TOTAL_REVENUE,
  FRT_REV_SPOT_CHARGE AS FRT_REV_SPOT_CHARGE,
  DSG_VOYAGE_FLIGHT AS DSG_VOYAGE_FLIGHT,
  FEASIBLE_VOYAGE_FLIGHT AS FEASIBLE_VOYAGE_FLIGHT,
  CURRENCY_TSTMP AS CURRENCY_TSTMP,
  FRT_REV_LINEHAUL_CHARGE AS FRT_REV_LINEHAUL_CHARGE,
  FRT_REV_STOP_CHARGE AS FRT_REV_STOP_CHARGE,
  FRT_REV_ACCESSORIAL_CHARGE AS FRT_REV_ACCESSORIAL_CHARGE,
  MARGIN AS MARGIN,
  TOTAL_COST AS TOTAL_COST,
  INCOTERM_ID AS INCOTERM_ID,
  ORDER_QTY AS ORDER_QTY,
  QTY_UOM_ID AS QTY_UOM_ID,
  REF_SHIPMENT_NBR AS REF_SHIPMENT_NBR,
  STAGING_LOCN_ID AS STAGING_LOCN_ID,
  LOADING_SEQ_ORD AS LOADING_SEQ_ORD,
  HAZMAT_CERT_CONTACT AS HAZMAT_CERT_CONTACT,
  HAZMAT_CERT_DECLARATION AS HAZMAT_CERT_DECLARATION,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_SHIPMENT"""

df_7 = spark.sql(query_7)

df_7.createOrReplaceTempView("Shortcut_to_OMS_SHIPMENT_7")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_SHIPMENT_8


query_8 = f"""SELECT
  SHIPMENT_ID AS SHIPMENT_ID,
  OMS_DIST_ORDER_ID AS OMS_DIST_ORDER_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  RS_AREA_ID AS RS_AREA_ID,
  TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  PP_SHIPMENT_ID AS PP_SHIPMENT_ID,
  SHIPMENT_STATUS AS SHIPMENT_STATUS,
  UPDATE_SENT AS UPDATE_SENT,
  BUSINESS_PROCESS AS BUSINESS_PROCESS,
  CREATION_TYPE AS CREATION_TYPE,
  CONS_RUN_ID AS CONS_RUN_ID,
  IS_CANCELLED AS IS_CANCELLED,
  RS_TYPE AS RS_TYPE,
  RS_CONFIG_ID AS RS_CONFIG_ID,
  RS_CONFIG_CYCLE_ID AS RS_CONFIG_CYCLE_ID,
  CONFIG_CYCLE_SEQ AS CONFIG_CYCLE_SEQ,
  CYCLE_DEADLINE_DT AS CYCLE_DEADLINE_DT,
  CYCLE_EXECUTION_DT AS CYCLE_EXECUTION_DT,
  LAST_RS_NOTIFICATION_DT AS LAST_RS_NOTIFICATION_DT,
  CFMF_STATUS AS CFMF_STATUS,
  AVAILABLE_DT AS AVAILABLE_DT,
  CMID AS CMID,
  CM_DISCOUNT AS CM_DISCOUNT,
  O_FACILITY_NBR AS O_FACILITY_NBR,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_ADDRESS AS O_ADDRESS,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTY AS O_COUNTY,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_FACILITY_NBR AS D_FACILITY_NBR,
  D_FACILITY_ID AS D_FACILITY_ID,
  D_ADDRESS AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  DISTANCE AS DISTANCE,
  DIRECT_DISTANCE AS DIRECT_DISTANCE,
  OUT_OF_ROUTE_DISTANCE AS OUT_OF_ROUTE_DISTANCE,
  DISTANCE_UOM AS DISTANCE_UOM,
  BUSINESS_PARTNER_ID AS BUSINESS_PARTNER_ID,
  COMMODITY_CLASS AS COMMODITY_CLASS,
  IS_HAZMAT AS IS_HAZMAT,
  IS_PERISHABLE AS IS_PERISHABLE,
  BILLING_METHOD AS BILLING_METHOD,
  DSG_CARRIER_CD AS DSG_CARRIER_CD,
  REC_CMID AS REC_CMID,
  REC_CM_SHIPMENT_ID AS REC_CM_SHIPMENT_ID,
  ASSIGNED_CARRIER_CD AS ASSIGNED_CARRIER_CD,
  SHIPMENT_REF_ID AS SHIPMENT_REF_ID,
  BILL_TO_CD AS BILL_TO_CD,
  BILL_TO_TITLE AS BILL_TO_TITLE,
  BILL_TO_NAME AS BILL_TO_NAME,
  BILL_TO_ADDRESS AS BILL_TO_ADDRESS,
  BILL_TO_CITY AS BILL_TO_CITY,
  BILL_TO_STATE_PROV AS BILL_TO_STATE_PROV,
  BILL_TO_POSTAL_CD AS BILL_TO_POSTAL_CD,
  BILL_TO_COUNTRY_CD AS BILL_TO_COUNTRY_CD,
  BILL_TO_PHONE_NBR AS BILL_TO_PHONE_NBR,
  PURCHASE_ORDER AS PURCHASE_ORDER,
  PRO_NBR AS PRO_NBR,
  TRANS_RESP_CD AS TRANS_RESP_CD,
  BASELINE_COST AS BASELINE_COST,
  ESTIMATED_COST AS ESTIMATED_COST,
  LINEHAUL_COST AS LINEHAUL_COST,
  ACCESSORIAL_COST AS ACCESSORIAL_COST,
  STOP_COST AS STOP_COST,
  ESTIMATED_SAVINGS AS ESTIMATED_SAVINGS,
  SPOT_CHARGE AS SPOT_CHARGE,
  CURRENCY_CD AS CURRENCY_CD,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  ON_TIME_INDICATOR AS ON_TIME_INDICATOR,
  HAS_NOTES AS HAS_NOTES,
  HAS_ALERTS AS HAS_ALERTS,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_SOFT_CHECK_ERROR AS HAS_SOFT_CHECK_ERROR,
  HAS_TRACKING_MSG AS HAS_TRACKING_MSG,
  TRACKING_MSG_PROBLEM AS TRACKING_MSG_PROBLEM,
  REC_LINEHAUL_COST AS REC_LINEHAUL_COST,
  REC_ACCESSORIAL_COST AS REC_ACCESSORIAL_COST,
  REC_TOTAL_COST AS REC_TOTAL_COST,
  CYCLE_RESP_DEADLINE_TZ AS CYCLE_RESP_DEADLINE_TZ,
  TENDER_RESP_DEADLINE_TZ AS TENDER_RESP_DEADLINE_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  DELIVERY_TZ AS DELIVERY_TZ,
  ASSIGNED_LANE_ID AS ASSIGNED_LANE_ID,
  ASSIGNED_LANE_DETAIL_ID AS ASSIGNED_LANE_DETAIL_ID,
  REC_SPOT_CHARGE AS REC_SPOT_CHARGE,
  REC_LANE_ID AS REC_LANE_ID,
  REC_LANE_DETAIL_ID AS REC_LANE_DETAIL_ID,
  TENDER_DT AS TENDER_DT,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  ASSIGNED_CM_SHIPMENT_ID AS ASSIGNED_CM_SHIPMENT_ID,
  REC_CM_DISCOUNT AS REC_CM_DISCOUNT,
  REC_STOP_COST AS REC_STOP_COST,
  LAST_SELECTOR_RUN_DT AS LAST_SELECTOR_RUN_DT,
  LAST_CM_OPTION_GEN_DT AS LAST_CM_OPTION_GEN_DT,
  IS_CM_OPTION_GEN_ACTIVE AS IS_CM_OPTION_GEN_ACTIVE,
  RS_CYCLE_REMAINING AS RS_CYCLE_REMAINING,
  IS_TIME_FEAS_D AS IS_TIME_FEAS_D,
  EXT_SYS_SHIPMENT_ID AS EXT_SYS_SHIPMENT_ID,
  EXTRACTION_DT AS EXTRACTION_DT,
  ASSIGNED_BROKER_CARRIER_CD AS ASSIGNED_BROKER_CARRIER_CD,
  USE_BROKER_AS_CARRIER AS USE_BROKER_AS_CARRIER,
  BROKER_REF AS BROKER_REF,
  RATING_QUALIFIER AS RATING_QUALIFIER,
  STATUS_CHANGE_DT AS STATUS_CHANGE_DT,
  BUDG_TOTAL_COST AS BUDG_TOTAL_COST,
  NORMALIZED_MARGIN AS NORMALIZED_MARGIN,
  NORMALIZED_TOTAL_COST AS NORMALIZED_TOTAL_COST,
  BUDG_NORMALIZED_TOTAL_COST AS BUDG_NORMALIZED_TOTAL_COST,
  REC_BUDG_LINEHAUL_COST AS REC_BUDG_LINEHAUL_COST,
  REC_BUDG_STOP_COST AS REC_BUDG_STOP_COST,
  REC_BUDG_CM_DISCOUNT AS REC_BUDG_CM_DISCOUNT,
  REC_BUDG_ACCESSORIAL_COST AS REC_BUDG_ACCESSORIAL_COST,
  REC_BUDG_TOTAL_COST AS REC_BUDG_TOTAL_COST,
  REC_MARGIN AS REC_MARGIN,
  REC_NORMALIZED_MARGIN AS REC_NORMALIZED_MARGIN,
  REC_NORMALIZED_TOTAL_COST AS REC_NORMALIZED_TOTAL_COST,
  REC_BUDG_NORMALIZED_TOTAL_COST AS REC_BUDG_NORMALIZED_TOTAL_COST,
  BUDG_CURRENCY_CD AS BUDG_CURRENCY_CD,
  SPOT_CHARGE_CURRENCY_CD AS SPOT_CHARGE_CURRENCY_CD,
  REC_CURRENCY_CD AS REC_CURRENCY_CD,
  REC_BUDG_CURRENCY_CD AS REC_BUDG_CURRENCY_CD,
  REC_SPOT_CHARGE_CURRENCY_CD AS REC_SPOT_CHARGE_CURRENCY_CD,
  RATING_LANE_ID AS RATING_LANE_ID,
  FRT_REV_RATING_LANE_ID AS FRT_REV_RATING_LANE_ID,
  REC_RATING_LANE_ID AS REC_RATING_LANE_ID,
  REC_BUDG_RATING_LANE_ID AS REC_BUDG_RATING_LANE_ID,
  RATING_LANE_DETAIL_ID AS RATING_LANE_DETAIL_ID,
  FRT_REV_RATING_LANE_DETAIL_ID AS FRT_REV_RATING_LANE_DETAIL_ID,
  REC_RATING_LANE_DETAIL_ID AS REC_RATING_LANE_DETAIL_ID,
  REC_BUDG_RATING_LANE_DETAIL_ID AS REC_BUDG_RATING_LANE_DETAIL_ID,
  BUDG_CM_DISCOUNT AS BUDG_CM_DISCOUNT,
  NORMALIZED_BASELINE_COST AS NORMALIZED_BASELINE_COST,
  BASELINE_COST_CURRENCY_CD AS BASELINE_COST_CURRENCY_CD,
  REPORTED_COST AS REPORTED_COST,
  TRACTOR_NBR AS TRACTOR_NBR,
  IS_AUTO_DELIVERED AS IS_AUTO_DELIVERED,
  SHIPMENT_TYPE AS SHIPMENT_TYPE,
  ORIG_BUDG_TOTAL_COST AS ORIG_BUDG_TOTAL_COST,
  ACCESSORIAL_COST_TO_CARRIER AS ACCESSORIAL_COST_TO_CARRIER,
  CARRIER_CHARGE AS CARRIER_CHARGE,
  ACTUAL_COST AS ACTUAL_COST,
  EARNED_INCOME AS EARNED_INCOME,
  SENT_TO_PKMS AS SENT_TO_PKMS,
  IS_SHIPMENT_RECONCILED AS IS_SHIPMENT_RECONCILED,
  DELIVERY_REQ AS DELIVERY_REQ,
  DROPOFF_PICKUP AS DROPOFF_PICKUP,
  PACKAGING AS PACKAGING,
  SENT_TO_PKMS_DT AS SENT_TO_PKMS_DT,
  WMS_STATUS_CD AS WMS_STATUS_CD,
  SPOT_CHARGE_AND_PAYEE_ACC AS SPOT_CHARGE_AND_PAYEE_ACC,
  SPOT_CHARGE_AND_PAYEE_ACC_CC AS SPOT_CHARGE_AND_PAYEE_ACC_CC,
  NORM_SPOT_CHARGE_AND_PAYEE_ACC AS NORM_SPOT_CHARGE_AND_PAYEE_ACC,
  FACILITY_SCHEDULE_ID AS FACILITY_SCHEDULE_ID,
  EARNED_INCOME_CURRENCY_CD AS EARNED_INCOME_CURRENCY_CD,
  ACTUAL_COST_CURRENCY_CD AS ACTUAL_COST_CURRENCY_CD,
  SHIPMENT_RECON_DT AS SHIPMENT_RECON_DT,
  PLN_RATING_LANE_ID AS PLN_RATING_LANE_ID,
  PLN_RATING_LANE_DETAIL_ID AS PLN_RATING_LANE_DETAIL_ID,
  PLN_TOTAL_COST AS PLN_TOTAL_COST,
  PLN_LINEHAUL_COST AS PLN_LINEHAUL_COST,
  PLN_TOTAL_ACCESSORIAL_COST AS PLN_TOTAL_ACCESSORIAL_COST,
  PLN_STOP_OFF_COST AS PLN_STOP_OFF_COST,
  PLN_NORMALIZED_TOTAL_COST AS PLN_NORMALIZED_TOTAL_COST,
  PLN_CURRENCY_CD AS PLN_CURRENCY_CD,
  PLN_ACCESSORL_COST_TO_CARRIER AS PLN_ACCESSORL_COST_TO_CARRIER,
  PLN_CARRIER_CHARGE AS PLN_CARRIER_CHARGE,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  GRS_OPERATION AS GRS_OPERATION,
  IS_GRS_OPT_CYCLE_RUNNING AS IS_GRS_OPT_CYCLE_RUNNING,
  IS_MANUAL_ASSIGN AS IS_MANUAL_ASSIGN,
  LAST_RUN_GRS_DT AS LAST_RUN_GRS_DT,
  GRS_MAX_SHIPMENT_STATUS AS GRS_MAX_SHIPMENT_STATUS,
  PRIORITY_TYPE AS PRIORITY_TYPE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  PROD_SCHED_REF_NBR AS PROD_SCHED_REF_NBR,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  UN_NUMERIC_ID AS UN_NUMERIC_ID,
  CONTRACT_NBR AS CONTRACT_NBR,
  BOOKING_REF_SHIPPER AS BOOKING_REF_SHIPPER,
  BOOKING_REF_CARRIER AS BOOKING_REF_CARRIER,
  BK_RESOURCE_REF_EXTERNAL AS BK_RESOURCE_REF_EXTERNAL,
  BK_RESOURCE_NAME_EXTERNAL AS BK_RESOURCE_NAME_EXTERNAL,
  BK_O_FACILITY_ID AS BK_O_FACILITY_ID,
  BK_D_FACILITY_ID AS BK_D_FACILITY_ID,
  BK_MASTER_AIRWAY_BILL AS BK_MASTER_AIRWAY_BILL,
  BK_FORWARDER_AIRWAY_BILL AS BK_FORWARDER_AIRWAY_BILL,
  ASSIGNED_SCNDR_CARRIER_CD AS ASSIGNED_SCNDR_CARRIER_CD,
  CUSTOMER_CREDIT_LIMIT_ID AS CUSTOMER_CREDIT_LIMIT_ID,
  SHIPMENT_LEG_TYPE AS SHIPMENT_LEG_TYPE,
  SHIPMENT_CLOSED_INDICATOR AS SHIPMENT_CLOSED_INDICATOR,
  OCEAN_ROUTING_STAGE AS OCEAN_ROUTING_STAGE,
  BK_DEPARTURE_DT AS BK_DEPARTURE_DT,
  BK_DEPARTURE_TZ AS BK_DEPARTURE_TZ,
  BK_ARRIVAL_DT AS BK_ARRIVAL_DT,
  BK_ARRIVAL_TZ AS BK_ARRIVAL_TZ,
  BK_PICKUP_DT AS BK_PICKUP_DT,
  BK_PICKUP_TZ AS BK_PICKUP_TZ,
  BK_CUTOFF_DT AS BK_CUTOFF_DT,
  BK_CUTOFF_TZ AS BK_CUTOFF_TZ,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  RATE_TYPE AS RATE_TYPE,
  RATE_UOM AS RATE_UOM,
  PICK_START_DT AS PICK_START_DT,
  PAPERWORK_START_DT AS PAPERWORK_START_DT,
  VEHICLE_CHECK_START_DT AS VEHICLE_CHECK_START_DT,
  SHIPMENT_START_DT AS SHIPMENT_START_DT,
  SHIPMENT_END_DT AS SHIPMENT_END_DT,
  FEASIBLE_DRIVER_TYPE AS FEASIBLE_DRIVER_TYPE,
  WAVE_ID AS WAVE_ID,
  ESTIMATED_DISPATCH_DT AS ESTIMATED_DISPATCH_DT,
  TOTAL_TIME AS TOTAL_TIME,
  LOC_REFERENCE AS LOC_REFERENCE,
  BK_O_FACILITY_ALIAS_ID AS BK_O_FACILITY_ALIAS_ID,
  BK_D_FACILITY_ALIAS_ID AS BK_D_FACILITY_ALIAS_ID,
  EQUIP_UTIL_PER AS EQUIP_UTIL_PER,
  MOVE_TYPE AS MOVE_TYPE,
  DRIVER_TYPE_ID AS DRIVER_TYPE_ID,
  EQUIPMENT_TYPE AS EQUIPMENT_TYPE,
  RADIAL_DISTANCE AS RADIAL_DISTANCE,
  RADIAL_DISTANCE_UOM AS RADIAL_DISTANCE_UOM,
  DESIGNATED_TRACTOR_CD AS DESIGNATED_TRACTOR_CD,
  DESIGNATED_DRIVER_TYPE AS DESIGNATED_DRIVER_TYPE,
  IS_WAVE_MAN_CHANGED AS IS_WAVE_MAN_CHANGED,
  RETAIN_CONSOLIDATOR_TIMES AS RETAIN_CONSOLIDATOR_TIMES,
  TARIFF AS TARIFF,
  MIN_RATE AS MIN_RATE,
  FIRST_UPDATE_SENT_TO_PKMS AS FIRST_UPDATE_SENT_TO_PKMS,
  EVENT_IND_TYPEID AS EVENT_IND_TYPEID,
  TANDEM_PATH_ID AS TANDEM_PATH_ID,
  O_TANDEM_FACILITY AS O_TANDEM_FACILITY,
  D_TANDEM_FACILITY AS D_TANDEM_FACILITY,
  O_TANDEM_FACILITY_ALIAS AS O_TANDEM_FACILITY_ALIAS,
  D_TANDEM_FACILITY_ALIAS AS D_TANDEM_FACILITY_ALIAS,
  DELAY_TYPE AS DELAY_TYPE,
  ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  REC_CARRIER_ID AS REC_CARRIER_ID,
  FEASIBLE_CARRIER_ID AS FEASIBLE_CARRIER_ID,
  PAYEE_CARRIER_ID AS PAYEE_CARRIER_ID,
  SCNDR_CARRIER_ID AS SCNDR_CARRIER_ID,
  BROKER_CARRIER_ID AS BROKER_CARRIER_ID,
  ASSIGNED_SCNDR_CARRIER_ID AS ASSIGNED_SCNDR_CARRIER_ID,
  DSG_SCNDR_CARRIER_ID AS DSG_SCNDR_CARRIER_ID,
  ASSIGNED_BROKER_CARRIER_ID AS ASSIGNED_BROKER_CARRIER_ID,
  LH_PAYEE_CARRIER_ID AS LH_PAYEE_CARRIER_ID,
  REC_BROKER_CARRIER_ID AS REC_BROKER_CARRIER_ID,
  ASSIGNED_EQUIPMENT_ID AS ASSIGNED_EQUIPMENT_ID,
  DSG_EQUIPMENT_ID AS DSG_EQUIPMENT_ID,
  FEASIBLE_EQUIPMENT_ID AS FEASIBLE_EQUIPMENT_ID,
  FEASIBLE_EQUIPMENT2_ID AS FEASIBLE_EQUIPMENT2_ID,
  REC_EQUIPMENT_ID AS REC_EQUIPMENT_ID,
  ASSIGNED_MOT_ID AS ASSIGNED_MOT_ID,
  DSG_MOT_ID AS DSG_MOT_ID,
  FEASIBLE_MOT_ID AS FEASIBLE_MOT_ID,
  REC_MOT_ID AS REC_MOT_ID,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  ASSIGNED_SERVICE_LEVEL_ID AS ASSIGNED_SERVICE_LEVEL_ID,
  DSG_SERVICE_LEVEL_ID AS DSG_SERVICE_LEVEL_ID,
  FEASIBLE_SERVICE_LEVEL_ID AS FEASIBLE_SERVICE_LEVEL_ID,
  REC_SERVICE_LEVEL_ID AS REC_SERVICE_LEVEL_ID,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  REGION_ID AS REGION_ID,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  FINANCIAL_WT AS FINANCIAL_WT,
  IS_BOOKING_REQUIRED AS IS_BOOKING_REQUIRED,
  TOTAL_COST_EXCL_TAX AS TOTAL_COST_EXCL_TAX,
  TOTAL_TAX_AMOUNT AS TOTAL_TAX_AMOUNT,
  IS_ASSOCIATED_TO_OUTBOUND AS IS_ASSOCIATED_TO_OUTBOUND,
  RECEIVED_DT AS RECEIVED_DT,
  BOOKING_ID AS BOOKING_ID,
  IS_MISROUTED AS IS_MISROUTED,
  FEASIBLE_CARRIER_CD AS FEASIBLE_CARRIER_CD,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  DT_PARAM_SET_ID AS DT_PARAM_SET_ID,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  STATIC_ROUTE_ID AS STATIC_ROUTE_ID,
  IS_FILO AS IS_FILO,
  IS_COOLER_AT_NOSE AS IS_COOLER_AT_NOSE,
  AUTH_NBR AS AUTH_NBR,
  CONS_LOCN_ID AS CONS_LOCN_ID,
  RTE_TYPE AS RTE_TYPE,
  TRLR_TYPE AS TRLR_TYPE,
  TRLR_SIZE AS TRLR_SIZE,
  CONS_ADDR_CD AS CONS_ADDR_CD,
  HUB_ID AS HUB_ID,
  TRLR_GEN_CD AS TRLR_GEN_CD,
  MAX_NBR_OF_CTNS AS MAX_NBR_OF_CTNS,
  APPT_DOOR_SCHED_TYPE AS APPT_DOOR_SCHED_TYPE,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  DSG_SCNDR_CARRIER_CD AS DSG_SCNDR_CARRIER_CD,
  LH_PAYEE_CARRIER_CD AS LH_PAYEE_CARRIER_CD,
  REC_BROKER_CARRIER_CD AS REC_BROKER_CARRIER_CD,
  REC_CARRIER_CD AS REC_CARRIER_CD,
  LPN_ASSIGNMENT_STOPPED AS LPN_ASSIGNMENT_STOPPED,
  SEAL_NBR AS SEAL_NBR,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  SHIP_GROUP_ID AS SHIP_GROUP_ID,
  RATE AS RATE,
  MONETARY_VALUE AS MONETARY_VALUE,
  DOOR AS DOOR,
  RTE_TYPE_1 AS RTE_TYPE_1,
  RTE_TYPE_2 AS RTE_TYPE_2,
  SCHEDULED_PICKUP_DT AS SCHEDULED_PICKUP_DT,
  MANIFEST_ID AS MANIFEST_ID,
  DAYS_TO_DELIVER AS DAYS_TO_DELIVER,
  SED_GENERATED_FLAG AS SED_GENERATED_FLAG,
  SERV_AREA_CD AS SERV_AREA_CD,
  TENDER_RESP_DEADLINE_TSTMP AS TENDER_RESP_DEADLINE_TSTMP,
  PRINT_CONS_BOL AS PRINT_CONS_BOL,
  LEFT_WT AS LEFT_WT,
  RIGHT_WT AS RIGHT_WT,
  LANE_NAME AS LANE_NAME,
  DECLARED_VALUE AS DECLARED_VALUE,
  DV_CURRENCY_CD AS DV_CURRENCY_CD,
  COD_AMOUNT AS COD_AMOUNT,
  CUSTOMER_ID AS CUSTOMER_ID,
  CUST_FRGT_CHARGE AS CUST_FRGT_CHARGE,
  COD_CURRENCY_CD AS COD_CURRENCY_CD,
  PLANNED_WEIGHT AS PLANNED_WEIGHT,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  PLANNED_VOLUME AS PLANNED_VOLUME,
  VOLUME_UOM_ID_BASE AS VOLUME_UOM_ID_BASE,
  SIZE1_VALUE AS SIZE1_VALUE,
  SIZE1_UOM_ID AS SIZE1_UOM_ID,
  SIZE2_VALUE AS SIZE2_VALUE,
  SIZE2_UOM_ID AS SIZE2_UOM_ID,
  ASSIGNED_SHIP_VIA AS ASSIGNED_SHIP_VIA,
  INSURANCE_STATUS AS INSURANCE_STATUS,
  RTE_SWC_NBR AS RTE_SWC_NBR,
  RTE_TO AS RTE_TO,
  BILL_OF_LADING_NBR AS BILL_OF_LADING_NBR,
  TRAILER_NBR AS TRAILER_NBR,
  TRANS_PLAN_OWNER AS TRANS_PLAN_OWNER,
  TOTAL_REVENUE_CURRENCY_CD AS TOTAL_REVENUE_CURRENCY_CD,
  TOTAL_REVENUE AS TOTAL_REVENUE,
  FRT_REV_SPOT_CHARGE_CURR_CD AS FRT_REV_SPOT_CHARGE_CURR_CD,
  NORMALIZED_TOTAL_REVENUE AS NORMALIZED_TOTAL_REVENUE,
  FRT_REV_SPOT_CHARGE AS FRT_REV_SPOT_CHARGE,
  DSG_VOYAGE_FLIGHT AS DSG_VOYAGE_FLIGHT,
  FEASIBLE_VOYAGE_FLIGHT AS FEASIBLE_VOYAGE_FLIGHT,
  CURRENCY_TSTMP AS CURRENCY_TSTMP,
  FRT_REV_LINEHAUL_CHARGE AS FRT_REV_LINEHAUL_CHARGE,
  FRT_REV_STOP_CHARGE AS FRT_REV_STOP_CHARGE,
  FRT_REV_ACCESSORIAL_CHARGE AS FRT_REV_ACCESSORIAL_CHARGE,
  MARGIN AS MARGIN,
  TOTAL_COST AS TOTAL_COST,
  INCOTERM_ID AS INCOTERM_ID,
  ORDER_QTY AS ORDER_QTY,
  QTY_UOM_ID AS QTY_UOM_ID,
  REF_SHIPMENT_NBR AS REF_SHIPMENT_NBR,
  STAGING_LOCN_ID AS STAGING_LOCN_ID,
  LOADING_SEQ_ORD AS LOADING_SEQ_ORD,
  HAZMAT_CERT_CONTACT AS HAZMAT_CERT_CONTACT,
  HAZMAT_CERT_DECLARATION AS HAZMAT_CERT_DECLARATION,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_SHIPMENT_7"""

df_8 = spark.sql(query_8)

df_8.createOrReplaceTempView("SQ_Shortcut_to_OMS_SHIPMENT_8")

# COMMAND ----------
# DBTITLE 1, EXP_EDW_9


query_9 = f"""SELECT
  SHIPMENT_ID AS SHIPMENT_ID,
  OMS_DIST_ORDER_ID AS OMS_DIST_ORDER_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  SHIPMENT_STATUS AS SHIPMENT_STATUS,
  UPDATE_SENT AS UPDATE_SENT,
  CREATION_TYPE AS CREATION_TYPE,
  IS_CANCELLED AS IS_CANCELLED,
  AVAILABLE_DT AS AVAILABLE_DT,
  O_FACILITY_NBR AS O_FACILITY_NBR,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_ADDRESS AS O_ADDRESS,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  D_ADDRESS AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  IS_PERISHABLE AS IS_PERISHABLE,
  BILLING_METHOD AS BILLING_METHOD,
  ASSIGNED_CARRIER_CD AS ASSIGNED_CARRIER_CD,
  TRANS_RESP_CD AS TRANS_RESP_CD,
  CURRENCY_CD AS CURRENCY_CD,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  HAS_NOTES AS HAS_NOTES,
  HAS_ALERTS AS HAS_ALERTS,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_SOFT_CHECK_ERROR AS HAS_SOFT_CHECK_ERROR,
  HAS_TRACKING_MSG AS HAS_TRACKING_MSG,
  TRACKING_MSG_PROBLEM AS TRACKING_MSG_PROBLEM,
  DELIVERY_TZ AS DELIVERY_TZ,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  USE_BROKER_AS_CARRIER AS USE_BROKER_AS_CARRIER,
  STATUS_CHANGE_DT AS STATUS_CHANGE_DT,
  REPORTED_COST AS REPORTED_COST,
  IS_AUTO_DELIVERED AS IS_AUTO_DELIVERED,
  SHIPMENT_TYPE AS SHIPMENT_TYPE,
  IS_SHIPMENT_RECONCILED AS IS_SHIPMENT_RECONCILED,
  DELIVERY_REQ AS DELIVERY_REQ,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  IS_MANUAL_ASSIGN AS IS_MANUAL_ASSIGN,
  PRIORITY_TYPE AS PRIORITY_TYPE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  SHIPMENT_LEG_TYPE AS SHIPMENT_LEG_TYPE,
  SHIPMENT_CLOSED_INDICATOR AS SHIPMENT_CLOSED_INDICATOR,
  BK_PICKUP_TZ AS BK_PICKUP_TZ,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  PICK_START_DT AS PICK_START_DT,
  TOTAL_TIME AS TOTAL_TIME,
  RETAIN_CONSOLIDATOR_TIMES AS RETAIN_CONSOLIDATOR_TIMES,
  EVENT_IND_TYPEID AS EVENT_IND_TYPEID,
  DELAY_TYPE AS DELAY_TYPE,
  ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  REGION_ID AS REGION_ID,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  TOTAL_COST AS TOTAL_COST,
  ORDER_QTY AS ORDER_QTY,
  LOAD_TSTMP AS LOAD_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_SHIPMENT_8"""

df_9 = spark.sql(query_9)

df_9.createOrReplaceTempView("EXP_EDW_9")

# COMMAND ----------
# DBTITLE 1, JNR_OMS_SHIPMENT_10


query_10 = f"""SELECT
  MASTER.OMS_ORDER_ID AS src_OMS_ORDER_ID,
  MASTER.OMS_SHIPMENT_ID AS src_OMS_SHIPMENT_ID,
  MASTER.OMS_TC_COMPANY_ID AS src_OMS_TC_COMPANY_ID,
  MASTER.OMS_TC_SHIPMENT_ID AS src_OMS_TC_SHIPMENT_ID,
  MASTER.OMS_SHIPMENT_TYPE_CD AS src_OMS_SHIPMENT_TYPE_CD,
  MASTER.OMS_SHIPMENT_STATUS_ID AS src_OMS_SHIPMENT_STATUS_ID,
  MASTER.SHIPMENT_CLOSED_IND AS src_SHIPMENT_CLOSED_IND,
  MASTER.OMS_STATUS_CHANGE_TSTMP AS src_OMS_STATUS_CHANGE_TSTMP,
  MASTER.OMS_CREATION_TYPE_ID AS src_OMS_CREATION_TYPE_ID,
  MASTER.CANCELLED_FLAG AS src_CANCELLED_FLAG,
  MASTER.AUTO_DELIVERED_FLAG AS src_AUTO_DELIVERED_FLAG,
  MASTER.SHIPMENT_RECONCILED_FLAG AS src_SHIPMENT_RECONCILED_FLAG,
  MASTER.OMS_SHIPMENT_LEG_TYPE_ID AS src_OMS_SHIPMENT_LEG_TYPE_ID,
  MASTER.DELIVERY_REQ AS src_DELIVERY_REQ,
  MASTER.OMS_AVAILABLE_TSTMP AS src_OMS_AVAILABLE_TSTMP,
  MASTER.OMS_REGION_ID AS src_OMS_REGION_ID,
  MASTER.OMS_INBOUND_REGION_ID AS src_OMS_INBOUND_REGION_ID,
  MASTER.OMS_OUTBOUND_REGION_ID AS src_OMS_OUTBOUND_REGION_ID,
  MASTER.OMS_O_FACILITY_NBR AS src_OMS_O_FACILITY_NBR,
  MASTER.OMS_O_FACILITY_ID AS src_OMS_O_FACILITY_ID,
  MASTER.O_STOP_LOCATION_NAME AS src_O_STOP_LOCATION_NAME,
  MASTER.D_STOP_LOCATION_NAME AS src_D_STOP_LOCATION_NAME,
  MASTER.O_ADDR AS src_O_ADDR,
  MASTER.O_CITY AS src_O_CITY,
  MASTER.O_STATE_PROV AS src_O_STATE_PROV,
  MASTER.O_POSTAL_CD AS src_O_POSTAL_CD,
  MASTER.O_COUNTRY_CD AS src_O_COUNTRY_CD,
  MASTER.D_ADDR AS src_D_ADDR,
  MASTER.D_CITY AS src_D_CITY,
  MASTER.D_STATE_PROV AS src_D_STATE_PROV,
  MASTER.D_POSTAL_CD AS src_D_POSTAL_CD,
  MASTER.D_COUNTRY_CD AS src_D_COUNTRY_CD,
  MASTER.PERISHABLE_FLAG AS src_PERISHABLE_FLAG,
  MASTER.HAS_NOTES_FLAG AS src_HAS_NOTES_FLAG,
  MASTER.HAS_ALERTS_FLAG AS src_HAS_ALERTS_FLAG,
  MASTER.HAS_EM_NOTIFY_FLAG AS src_HAS_EM_NOTIFY_FLAG,
  MASTER.SHIPMENT_WIN_ADJ_FLAG AS src_SHIPMENT_WIN_ADJ_FLAG,
  MASTER.HAS_IMPORT_ERROR_FLAG AS src_HAS_IMPORT_ERROR_FLAG,
  MASTER.HAS_SOFT_CHECK_ERROR_FLAG AS src_HAS_SOFT_CHECK_ERROR_FLAG,
  MASTER.HAS_TRACKING_MSG_FLAG AS src_HAS_TRACKING_MSG_FLAG,
  MASTER.TRACKING_MSG_PROBLEM_FLAG AS src_TRACKING_MSG_PROBLEM_FLAG,
  MASTER.USE_BROKER_AS_CARRIER_FLAG AS src_USE_BROKER_AS_CARRIER_FLAG,
  MASTER.UPDATE_SENT_FLAG AS src_UPDATE_SENT_FLAG,
  MASTER.MANUAL_ASSIGN_FLAG AS src_MANUAL_ASSIGN_FLAG,
  MASTER.OMS_PRIORITY_TYPE_ID AS src_OMS_PRIORITY_TYPE_ID,
  MASTER.RETAIN_CONSOLIDATOR_TIMES_FLAG AS src_RETAIN_CONSOLIDATOR_TIMES_FLAG,
  MASTER.OMS_EVENT_IND_TYPE_ID AS src_OMS_EVENT_IND_TYPE_ID,
  MASTER.OMS_DELAY_TYPE_ID AS src_OMS_DELAY_TYPE_ID,
  MASTER.OMS_ASSIGNED_CARRIER_ID AS src_OMS_ASSIGNED_CARRIER_ID,
  MASTER.OMS_ASSIGNED_CARRIER_CD AS src_OMS_ASSIGNED_CARRIER_CD,
  MASTER.OMS_BILLING_METHOD_ID AS src_OMS_BILLING_METHOD_ID,
  MASTER.OMS_TRANS_RESP_CD AS src_OMS_TRANS_RESP_CD,
  MASTER.OMS_PICK_START_TSTMP AS src_OMS_PICK_START_TSTMP,
  MASTER.OMS_PICKUP_START_TSTMP AS src_OMS_PICKUP_START_TSTMP,
  MASTER.OMS_PICKUP_END_TSTMP AS src_OMS_PICKUP_END_TSTMP,
  MASTER.OMS_PICKUP_TZ_ID AS src_OMS_PICKUP_TZ_ID,
  MASTER.OMS_DELIVERY_START_TSTMP AS src_OMS_DELIVERY_START_TSTMP,
  MASTER.OMS_DELIVERY_END_TSTMP AS src_OMS_DELIVERY_END_TSTMP,
  MASTER.OMS_DELIVERY_TZ_ID AS src_OMS_DELIVERY_TZ_ID,
  MASTER.NUM_CHARGE_LAYOVERS AS src_NUM_CHARGE_LAYOVERS,
  MASTER.NUM_STOPS AS src_NUM_STOPS,
  MASTER.NUM_DOCKS AS src_NUM_DOCKS,
  MASTER.TOTAL_TIME AS src_TOTAL_TIME,
  MASTER.ORDER_QTY AS src_ORDER_QTY,
  MASTER.REPORTED_COST AS src_REPORTED_COST,
  MASTER.WAYPOINT_TOTAL_COST AS src_WAYPOINT_TOTAL_COST,
  MASTER.WAYPOINT_HANDLING_COST AS src_WAYPOINT_HANDLING_COST,
  MASTER.TOTAL_COST AS src_TOTAL_COST,
  MASTER.CURRENCY_CD AS src_CURRENCY_CD,
  MASTER.MV_CURRENCY_CD AS src_MV_CURRENCY_CD,
  MASTER.OMS_CREATED_SOURCE_TYPE_ID AS src_OMS_CREATED_SOURCE_TYPE_ID,
  MASTER.OMS_CREATED_SOURCE AS src_OMS_CREATED_SOURCE,
  MASTER.OMS_CREATED_TSTMP AS src_OMS_CREATED_TSTMP,
  MASTER.OMS_LAST_UPDATED_SOURCE_TYPE_ID AS src_OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  MASTER.OMS_LAST_UPDATED_SOURCE AS src_OMS_LAST_UPDATED_SOURCE,
  MASTER.OMS_LAST_UPDATED_TSTMP AS src_OMS_LAST_UPDATED_TSTMP,
  MASTER.LOAD_TSTMP AS src_LOAD_TSTMP,
  DETAIL.SHIPMENT_ID AS lkp_SHIPMENT_ID,
  DETAIL.OMS_DIST_ORDER_ID AS lkp_OMS_DIST_ORDER_ID,
  DETAIL.TC_COMPANY_ID AS lkp_TC_COMPANY_ID,
  DETAIL.TC_SHIPMENT_ID AS lkp_TC_SHIPMENT_ID,
  DETAIL.SHIPMENT_STATUS AS lkp_SHIPMENT_STATUS,
  DETAIL.UPDATE_SENT AS lkp_UPDATE_SENT,
  DETAIL.CREATION_TYPE AS lkp_CREATION_TYPE,
  DETAIL.IS_CANCELLED AS lkp_IS_CANCELLED,
  DETAIL.AVAILABLE_DT AS lkp_AVAILABLE_DT,
  DETAIL.O_FACILITY_NBR AS lkp_O_FACILITY_NBR,
  DETAIL.O_FACILITY_ID AS lkp_O_FACILITY_ID,
  DETAIL.O_ADDRESS AS lkp_O_ADDRESS,
  DETAIL.O_CITY AS lkp_O_CITY,
  DETAIL.O_STATE_PROV AS lkp_O_STATE_PROV,
  DETAIL.O_POSTAL_CD AS lkp_O_POSTAL_CD,
  DETAIL.O_COUNTRY_CD AS lkp_O_COUNTRY_CD,
  DETAIL.D_ADDRESS AS lkp_D_ADDRESS,
  DETAIL.D_CITY AS lkp_D_CITY,
  DETAIL.D_STATE_PROV AS lkp_D_STATE_PROV,
  DETAIL.D_POSTAL_CD AS lkp_D_POSTAL_CD,
  DETAIL.D_COUNTRY_CD AS lkp_D_COUNTRY_CD,
  DETAIL.IS_PERISHABLE AS lkp_IS_PERISHABLE,
  DETAIL.BILLING_METHOD AS lkp_BILLING_METHOD,
  DETAIL.ASSIGNED_CARRIER_CD AS lkp_ASSIGNED_CARRIER_CD,
  DETAIL.TRANS_RESP_CD AS lkp_TRANS_RESP_CD,
  DETAIL.CURRENCY_CD AS lkp_CURRENCY_CD,
  DETAIL.PICKUP_START_DT AS lkp_PICKUP_START_DT,
  DETAIL.PICKUP_END_DT AS lkp_PICKUP_END_DT,
  DETAIL.DELIVERY_START_DT AS lkp_DELIVERY_START_DT,
  DETAIL.DELIVERY_END_DT AS lkp_DELIVERY_END_DT,
  DETAIL.NUM_STOPS AS lkp_NUM_STOPS,
  DETAIL.NUM_DOCKS AS lkp_NUM_DOCKS,
  DETAIL.HAS_NOTES AS lkp_HAS_NOTES,
  DETAIL.HAS_ALERTS AS lkp_HAS_ALERTS,
  DETAIL.HAS_IMPORT_ERROR AS lkp_HAS_IMPORT_ERROR,
  DETAIL.HAS_SOFT_CHECK_ERROR AS lkp_HAS_SOFT_CHECK_ERROR,
  DETAIL.HAS_TRACKING_MSG AS lkp_HAS_TRACKING_MSG,
  DETAIL.TRACKING_MSG_PROBLEM AS lkp_TRACKING_MSG_PROBLEM,
  DETAIL.DELIVERY_TZ AS lkp_DELIVERY_TZ,
  DETAIL.O_STOP_LOCATION_NAME AS lkp_O_STOP_LOCATION_NAME,
  DETAIL.D_STOP_LOCATION_NAME AS lkp_D_STOP_LOCATION_NAME,
  DETAIL.USE_BROKER_AS_CARRIER AS lkp_USE_BROKER_AS_CARRIER,
  DETAIL.STATUS_CHANGE_DT AS lkp_STATUS_CHANGE_DT,
  DETAIL.REPORTED_COST AS lkp_REPORTED_COST,
  DETAIL.IS_AUTO_DELIVERED AS lkp_IS_AUTO_DELIVERED,
  DETAIL.SHIPMENT_TYPE AS lkp_SHIPMENT_TYPE,
  DETAIL.IS_SHIPMENT_RECONCILED AS lkp_IS_SHIPMENT_RECONCILED,
  DETAIL.DELIVERY_REQ AS lkp_DELIVERY_REQ,
  DETAIL.WAYPOINT_TOTAL_COST AS lkp_WAYPOINT_TOTAL_COST,
  DETAIL.WAYPOINT_HANDLING_COST AS lkp_WAYPOINT_HANDLING_COST,
  DETAIL.IS_MANUAL_ASSIGN AS lkp_IS_MANUAL_ASSIGN,
  DETAIL.PRIORITY_TYPE AS lkp_PRIORITY_TYPE,
  DETAIL.MV_CURRENCY_CD AS lkp_MV_CURRENCY_CD,
  DETAIL.SHIPMENT_LEG_TYPE AS lkp_SHIPMENT_LEG_TYPE,
  DETAIL.SHIPMENT_CLOSED_INDICATOR AS lkp_SHIPMENT_CLOSED_INDICATOR,
  DETAIL.BK_PICKUP_TZ AS lkp_BK_PICKUP_TZ,
  DETAIL.NUM_CHARGE_LAYOVERS AS lkp_NUM_CHARGE_LAYOVERS,
  DETAIL.PICK_START_DT AS lkp_PICK_START_DT,
  DETAIL.TOTAL_TIME AS lkp_TOTAL_TIME,
  DETAIL.RETAIN_CONSOLIDATOR_TIMES AS lkp_RETAIN_CONSOLIDATOR_TIMES,
  DETAIL.EVENT_IND_TYPEID AS lkp_EVENT_IND_TYPEID,
  DETAIL.DELAY_TYPE AS lkp_DELAY_TYPE,
  DETAIL.ASSIGNED_CARRIER_ID AS lkp_ASSIGNED_CARRIER_ID,
  DETAIL.HAS_EM_NOTIFY_FLAG AS lkp_HAS_EM_NOTIFY_FLAG,
  DETAIL.REGION_ID AS lkp_REGION_ID,
  DETAIL.INBOUND_REGION_ID AS lkp_INBOUND_REGION_ID,
  DETAIL.OUTBOUND_REGION_ID AS lkp_OUTBOUND_REGION_ID,
  DETAIL.SHIPMENT_WIN_ADJ_FLAG AS lkp_SHIPMENT_WIN_ADJ_FLAG,
  DETAIL.CREATED_SOURCE_TYPE AS lkp_CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS lkp_CREATED_SOURCE,
  DETAIL.CREATED_TSTMP AS lkp_CREATED_TSTMP,
  DETAIL.LAST_UPDATED_SOURCE_TYPE AS lkp_LAST_UPDATED_SOURCE_TYPE,
  DETAIL.LAST_UPDATED_SOURCE AS lkp_LAST_UPDATED_SOURCE,
  DETAIL.LAST_UPDATED_TSTMP AS lkp_LAST_UPDATED_TSTMP,
  DETAIL.TOTAL_COST AS lkp_TOTAL_COST,
  DETAIL.ORDER_QTY AS lkp_ORDER_QTY,
  DETAIL.LOAD_TSTMP AS lkp_LOAD_TSTMP,
  MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  JNR_LPN_6 MASTER
  LEFT JOIN EXP_EDW_9 DETAIL ON MASTER.OMS_TC_COMPANY_ID = DETAIL.TC_COMPANY_ID
  AND MASTER.OMS_TC_SHIPMENT_ID = DETAIL.TC_SHIPMENT_ID"""

df_10 = spark.sql(query_10)

df_10.createOrReplaceTempView("JNR_OMS_SHIPMENT_10")

# COMMAND ----------
# DBTITLE 1, EXP_FLAGS_11


query_11 = f"""SELECT
  src_OMS_ORDER_ID AS src_OMS_ORDER_ID,
  src_OMS_SHIPMENT_ID AS src_OMS_SHIPMENT_ID,
  src_OMS_TC_COMPANY_ID AS src_OMS_TC_COMPANY_ID,
  src_OMS_TC_SHIPMENT_ID AS src_OMS_TC_SHIPMENT_ID,
  src_OMS_SHIPMENT_TYPE_CD AS src_OMS_SHIPMENT_TYPE_CD,
  src_OMS_SHIPMENT_STATUS_ID AS src_OMS_SHIPMENT_STATUS_ID,
  src_SHIPMENT_CLOSED_IND AS src_SHIPMENT_CLOSED_IND,
  src_OMS_STATUS_CHANGE_TSTMP AS src_OMS_STATUS_CHANGE_TSTMP,
  src_OMS_CREATION_TYPE_ID AS src_OMS_CREATION_TYPE_ID,
  src_CANCELLED_FLAG AS src_CANCELLED_FLAG,
  src_AUTO_DELIVERED_FLAG AS src_AUTO_DELIVERED_FLAG,
  src_SHIPMENT_RECONCILED_FLAG AS src_SHIPMENT_RECONCILED_FLAG,
  src_OMS_SHIPMENT_LEG_TYPE_ID AS src_OMS_SHIPMENT_LEG_TYPE_ID,
  src_DELIVERY_REQ AS src_DELIVERY_REQ,
  src_OMS_AVAILABLE_TSTMP AS src_OMS_AVAILABLE_TSTMP,
  src_OMS_REGION_ID AS src_OMS_REGION_ID,
  src_OMS_INBOUND_REGION_ID AS src_OMS_INBOUND_REGION_ID,
  src_OMS_OUTBOUND_REGION_ID AS src_OMS_OUTBOUND_REGION_ID,
  src_OMS_O_FACILITY_NBR AS src_OMS_O_FACILITY_NBR,
  src_OMS_O_FACILITY_ID AS src_OMS_O_FACILITY_ID,
  src_O_STOP_LOCATION_NAME AS src_O_STOP_LOCATION_NAME,
  src_D_STOP_LOCATION_NAME AS src_D_STOP_LOCATION_NAME,
  src_O_ADDR AS src_O_ADDR,
  src_O_CITY AS src_O_CITY,
  src_O_STATE_PROV AS src_O_STATE_PROV,
  src_O_POSTAL_CD AS src_O_POSTAL_CD,
  src_O_COUNTRY_CD AS src_O_COUNTRY_CD,
  src_D_ADDR AS src_D_ADDR,
  src_D_CITY AS src_D_CITY,
  src_D_STATE_PROV AS src_D_STATE_PROV,
  src_D_POSTAL_CD AS src_D_POSTAL_CD,
  src_D_COUNTRY_CD AS src_D_COUNTRY_CD,
  src_PERISHABLE_FLAG AS src_PERISHABLE_FLAG,
  src_HAS_NOTES_FLAG AS src_HAS_NOTES_FLAG,
  src_HAS_ALERTS_FLAG AS src_HAS_ALERTS_FLAG,
  src_HAS_EM_NOTIFY_FLAG AS src_HAS_EM_NOTIFY_FLAG,
  src_SHIPMENT_WIN_ADJ_FLAG AS src_SHIPMENT_WIN_ADJ_FLAG,
  src_HAS_IMPORT_ERROR_FLAG AS src_HAS_IMPORT_ERROR_FLAG,
  src_HAS_SOFT_CHECK_ERROR_FLAG AS src_HAS_SOFT_CHECK_ERROR_FLAG,
  src_HAS_TRACKING_MSG_FLAG AS src_HAS_TRACKING_MSG_FLAG,
  src_TRACKING_MSG_PROBLEM_FLAG AS src_TRACKING_MSG_PROBLEM_FLAG,
  src_USE_BROKER_AS_CARRIER_FLAG AS src_USE_BROKER_AS_CARRIER_FLAG,
  src_UPDATE_SENT_FLAG AS src_UPDATE_SENT_FLAG,
  src_MANUAL_ASSIGN_FLAG AS src_MANUAL_ASSIGN_FLAG,
  src_OMS_PRIORITY_TYPE_ID AS src_OMS_PRIORITY_TYPE_ID,
  src_RETAIN_CONSOLIDATOR_TIMES_FLAG AS src_RETAIN_CONSOLIDATOR_TIMES_FLAG,
  src_OMS_EVENT_IND_TYPE_ID AS src_OMS_EVENT_IND_TYPE_ID,
  src_OMS_DELAY_TYPE_ID AS src_OMS_DELAY_TYPE_ID,
  src_OMS_ASSIGNED_CARRIER_ID AS src_OMS_ASSIGNED_CARRIER_ID,
  src_OMS_ASSIGNED_CARRIER_CD AS src_OMS_ASSIGNED_CARRIER_CD,
  src_OMS_BILLING_METHOD_ID AS src_OMS_BILLING_METHOD_ID,
  src_OMS_TRANS_RESP_CD AS src_OMS_TRANS_RESP_CD,
  src_OMS_PICK_START_TSTMP AS src_OMS_PICK_START_TSTMP,
  src_OMS_PICKUP_START_TSTMP AS src_OMS_PICKUP_START_TSTMP,
  src_OMS_PICKUP_END_TSTMP AS src_OMS_PICKUP_END_TSTMP,
  src_OMS_PICKUP_TZ_ID AS src_OMS_PICKUP_TZ_ID,
  src_OMS_DELIVERY_START_TSTMP AS src_OMS_DELIVERY_START_TSTMP,
  src_OMS_DELIVERY_END_TSTMP AS src_OMS_DELIVERY_END_TSTMP,
  src_OMS_DELIVERY_TZ_ID AS src_OMS_DELIVERY_TZ_ID,
  src_NUM_CHARGE_LAYOVERS AS src_NUM_CHARGE_LAYOVERS,
  src_NUM_STOPS AS src_NUM_STOPS,
  src_NUM_DOCKS AS src_NUM_DOCKS,
  src_TOTAL_TIME AS src_TOTAL_TIME,
  src_ORDER_QTY AS src_ORDER_QTY,
  src_REPORTED_COST AS src_REPORTED_COST,
  src_WAYPOINT_TOTAL_COST AS src_WAYPOINT_TOTAL_COST,
  src_WAYPOINT_HANDLING_COST AS src_WAYPOINT_HANDLING_COST,
  src_TOTAL_COST AS src_TOTAL_COST,
  src_CURRENCY_CD AS src_CURRENCY_CD,
  src_MV_CURRENCY_CD AS src_MV_CURRENCY_CD,
  src_OMS_CREATED_SOURCE_TYPE_ID AS src_OMS_CREATED_SOURCE_TYPE_ID,
  src_OMS_CREATED_SOURCE AS src_OMS_CREATED_SOURCE,
  src_OMS_CREATED_TSTMP AS src_OMS_CREATED_TSTMP,
  src_OMS_LAST_UPDATED_SOURCE_TYPE_ID AS src_OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  src_OMS_LAST_UPDATED_SOURCE AS src_OMS_LAST_UPDATED_SOURCE,
  src_OMS_LAST_UPDATED_TSTMP AS src_OMS_LAST_UPDATED_TSTMP,
  src_LOAD_TSTMP AS src_LOAD_TSTMP,
  lkp_SHIPMENT_ID AS lkp_SHIPMENT_ID,
  lkp_OMS_DIST_ORDER_ID AS lkp_OMS_DIST_ORDER_ID,
  lkp_TC_COMPANY_ID AS lkp_TC_COMPANY_ID,
  lkp_TC_SHIPMENT_ID AS lkp_TC_SHIPMENT_ID,
  lkp_SHIPMENT_STATUS AS lkp_SHIPMENT_STATUS,
  lkp_UPDATE_SENT AS lkp_UPDATE_SENT,
  lkp_CREATION_TYPE AS lkp_CREATION_TYPE,
  lkp_IS_CANCELLED AS lkp_IS_CANCELLED,
  lkp_AVAILABLE_DT AS lkp_AVAILABLE_DT,
  lkp_O_FACILITY_NBR AS lkp_O_FACILITY_NBR,
  lkp_O_FACILITY_ID AS lkp_O_FACILITY_ID,
  lkp_O_ADDRESS AS lkp_O_ADDRESS,
  lkp_O_CITY AS lkp_O_CITY,
  lkp_O_STATE_PROV AS lkp_O_STATE_PROV,
  lkp_O_POSTAL_CD AS lkp_O_POSTAL_CD,
  lkp_O_COUNTRY_CD AS lkp_O_COUNTRY_CD,
  lkp_D_ADDRESS AS lkp_D_ADDRESS,
  lkp_D_CITY AS lkp_D_CITY,
  lkp_D_STATE_PROV AS lkp_D_STATE_PROV,
  lkp_D_POSTAL_CD AS lkp_D_POSTAL_CD,
  lkp_D_COUNTRY_CD AS lkp_D_COUNTRY_CD,
  lkp_IS_PERISHABLE AS lkp_IS_PERISHABLE,
  lkp_BILLING_METHOD AS lkp_BILLING_METHOD,
  lkp_ASSIGNED_CARRIER_CD AS lkp_ASSIGNED_CARRIER_CD,
  lkp_TRANS_RESP_CD AS lkp_TRANS_RESP_CD,
  lkp_CURRENCY_CD AS lkp_CURRENCY_CD,
  lkp_PICKUP_START_DT AS lkp_PICKUP_START_DT,
  lkp_PICKUP_END_DT AS lkp_PICKUP_END_DT,
  lkp_DELIVERY_START_DT AS lkp_DELIVERY_START_DT,
  lkp_DELIVERY_END_DT AS lkp_DELIVERY_END_DT,
  lkp_NUM_STOPS AS lkp_NUM_STOPS,
  lkp_NUM_DOCKS AS lkp_NUM_DOCKS,
  lkp_HAS_NOTES AS lkp_HAS_NOTES,
  lkp_HAS_ALERTS AS lkp_HAS_ALERTS,
  lkp_HAS_IMPORT_ERROR AS lkp_HAS_IMPORT_ERROR,
  lkp_HAS_SOFT_CHECK_ERROR AS lkp_HAS_SOFT_CHECK_ERROR,
  lkp_HAS_TRACKING_MSG AS lkp_HAS_TRACKING_MSG,
  lkp_TRACKING_MSG_PROBLEM AS lkp_TRACKING_MSG_PROBLEM,
  lkp_DELIVERY_TZ AS lkp_DELIVERY_TZ,
  lkp_O_STOP_LOCATION_NAME AS lkp_O_STOP_LOCATION_NAME,
  lkp_D_STOP_LOCATION_NAME AS lkp_D_STOP_LOCATION_NAME,
  lkp_USE_BROKER_AS_CARRIER AS lkp_USE_BROKER_AS_CARRIER,
  lkp_STATUS_CHANGE_DT AS lkp_STATUS_CHANGE_DT,
  lkp_REPORTED_COST AS lkp_REPORTED_COST,
  lkp_IS_AUTO_DELIVERED AS lkp_IS_AUTO_DELIVERED,
  lkp_SHIPMENT_TYPE AS lkp_SHIPMENT_TYPE,
  lkp_IS_SHIPMENT_RECONCILED AS lkp_IS_SHIPMENT_RECONCILED,
  lkp_DELIVERY_REQ AS lkp_DELIVERY_REQ,
  lkp_WAYPOINT_TOTAL_COST AS lkp_WAYPOINT_TOTAL_COST,
  lkp_WAYPOINT_HANDLING_COST AS lkp_WAYPOINT_HANDLING_COST,
  lkp_IS_MANUAL_ASSIGN AS lkp_IS_MANUAL_ASSIGN,
  lkp_PRIORITY_TYPE AS lkp_PRIORITY_TYPE,
  lkp_MV_CURRENCY_CD AS lkp_MV_CURRENCY_CD,
  lkp_SHIPMENT_LEG_TYPE AS lkp_SHIPMENT_LEG_TYPE,
  lkp_SHIPMENT_CLOSED_INDICATOR AS lkp_SHIPMENT_CLOSED_INDICATOR,
  lkp_BK_PICKUP_TZ AS lkp_BK_PICKUP_TZ,
  lkp_NUM_CHARGE_LAYOVERS AS lkp_NUM_CHARGE_LAYOVERS,
  lkp_PICK_START_DT AS lkp_PICK_START_DT,
  lkp_TOTAL_TIME AS lkp_TOTAL_TIME,
  lkp_RETAIN_CONSOLIDATOR_TIMES AS lkp_RETAIN_CONSOLIDATOR_TIMES,
  lkp_EVENT_IND_TYPEID AS lkp_EVENT_IND_TYPEID,
  lkp_DELAY_TYPE AS lkp_DELAY_TYPE,
  lkp_ASSIGNED_CARRIER_ID AS lkp_ASSIGNED_CARRIER_ID,
  lkp_HAS_EM_NOTIFY_FLAG AS lkp_HAS_EM_NOTIFY_FLAG,
  lkp_REGION_ID AS lkp_REGION_ID,
  lkp_INBOUND_REGION_ID AS lkp_INBOUND_REGION_ID,
  lkp_OUTBOUND_REGION_ID AS lkp_OUTBOUND_REGION_ID,
  lkp_SHIPMENT_WIN_ADJ_FLAG AS lkp_SHIPMENT_WIN_ADJ_FLAG,
  lkp_CREATED_SOURCE_TYPE AS lkp_CREATED_SOURCE_TYPE,
  lkp_CREATED_SOURCE AS lkp_CREATED_SOURCE,
  lkp_CREATED_TSTMP AS lkp_CREATED_TSTMP,
  lkp_LAST_UPDATED_SOURCE_TYPE AS lkp_LAST_UPDATED_SOURCE_TYPE,
  lkp_LAST_UPDATED_SOURCE AS lkp_LAST_UPDATED_SOURCE,
  lkp_LAST_UPDATED_TSTMP AS lkp_LAST_UPDATED_TSTMP,
  lkp_TOTAL_COST AS lkp_TOTAL_COST,
  lkp_ORDER_QTY AS lkp_ORDER_QTY,
  now() AS UPDATE_TSTMP,
  IFF(ISNULL(lkp_LOAD_TSTMP), now(), lkp_LOAD_TSTMP) AS LOAD_TSTMP_exp,
  IFF(
    (
      ISNULL(lkp_TC_SHIPMENT_ID)
      AND ISNULL(lkp_TC_COMPANY_ID)
    ),
    'INSERT',
    IFF(
      (
        (
          NOT ISNULL(lkp_TC_SHIPMENT_ID)
          AND NOT ISNULL(lkp_TC_COMPANY_ID)
        )
        AND (
          IFF(
            ISNULL(src_OMS_SHIPMENT_ID),
            0,
            src_OMS_SHIPMENT_ID
          ) <> IFF(ISNULL(lkp_SHIPMENT_ID), 0, lkp_SHIPMENT_ID)
          OR IFF(ISNULL(src_OMS_ORDER_ID), 0, src_OMS_ORDER_ID) <> IFF(
            ISNULL(lkp_OMS_DIST_ORDER_ID),
            0,
            lkp_OMS_DIST_ORDER_ID
          )
          OR IFF(
            ISNULL(src_OMS_SHIPMENT_STATUS_ID),
            0,
            src_OMS_SHIPMENT_STATUS_ID
          ) <> IFF(
            ISNULL(lkp_SHIPMENT_STATUS),
            0,
            lkp_SHIPMENT_STATUS
          )
          OR IFF(
            ISNULL(src_UPDATE_SENT_FLAG),
            0,
            src_UPDATE_SENT_FLAG
          ) <> IFF(ISNULL(lkp_UPDATE_SENT), 0, lkp_UPDATE_SENT)
          OR IFF(
            ISNULL(src_OMS_CREATION_TYPE_ID),
            0,
            src_OMS_CREATION_TYPE_ID
          ) <> IFF(ISNULL(lkp_CREATION_TYPE), 0, lkp_CREATION_TYPE)
          OR IFF(ISNULL(src_CANCELLED_FLAG), 0, src_CANCELLED_FLAG) <> IFF(ISNULL(lkp_IS_CANCELLED), 0, lkp_IS_CANCELLED)
          OR IFF(
            ISNULL(src_OMS_AVAILABLE_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_AVAILABLE_TSTMP
          ) <> IFF(
            ISNULL(lkp_AVAILABLE_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_AVAILABLE_DT
          )
          OR IFF(
            ISNULL(src_OMS_O_FACILITY_NBR),
            0,
            src_OMS_O_FACILITY_NBR
          ) <> IFF(ISNULL(lkp_O_FACILITY_NBR), 0, lkp_O_FACILITY_NBR)
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_O_FACILITY_ID))),
            ' ',
            LTRIM(RTRIM(src_OMS_O_FACILITY_ID))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_FACILITY_ID))),
            ' ',
            LTRIM(RTRIM(lkp_O_FACILITY_ID))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_ADDR))),
            ' ',
            LTRIM(RTRIM(src_O_ADDR))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_ADDRESS))),
            ' ',
            LTRIM(RTRIM(lkp_O_ADDRESS))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_CITY))),
            ' ',
            LTRIM(RTRIM(src_O_CITY))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_CITY))),
            ' ',
            LTRIM(RTRIM(lkp_O_CITY))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_STATE_PROV))),
            ' ',
            LTRIM(RTRIM(src_O_STATE_PROV))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_STATE_PROV))),
            ' ',
            LTRIM(RTRIM(lkp_O_STATE_PROV))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_POSTAL_CD))),
            ' ',
            LTRIM(RTRIM(src_O_POSTAL_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_POSTAL_CD))),
            ' ',
            LTRIM(RTRIM(lkp_O_POSTAL_CD))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_COUNTRY_CD))),
            ' ',
            LTRIM(RTRIM(src_O_COUNTRY_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_COUNTRY_CD))),
            ' ',
            LTRIM(RTRIM(lkp_O_COUNTRY_CD))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_ADDR))),
            ' ',
            LTRIM(RTRIM(src_D_ADDR))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_ADDRESS))),
            ' ',
            LTRIM(RTRIM(lkp_D_ADDRESS))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_CITY))),
            ' ',
            LTRIM(RTRIM(src_D_CITY))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_CITY))),
            ' ',
            LTRIM(RTRIM(lkp_D_CITY))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_STATE_PROV))),
            ' ',
            LTRIM(RTRIM(src_D_STATE_PROV))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_STATE_PROV))),
            ' ',
            LTRIM(RTRIM(lkp_D_STATE_PROV))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_POSTAL_CD))),
            ' ',
            LTRIM(RTRIM(src_D_POSTAL_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_POSTAL_CD))),
            ' ',
            LTRIM(RTRIM(lkp_D_POSTAL_CD))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_COUNTRY_CD))),
            ' ',
            LTRIM(RTRIM(src_D_COUNTRY_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_COUNTRY_CD))),
            ' ',
            LTRIM(RTRIM(lkp_D_COUNTRY_CD))
          )
          OR IFF(
            ISNULL(src_PERISHABLE_FLAG),
            0,
            src_PERISHABLE_FLAG
          ) <> IFF(ISNULL(lkp_IS_PERISHABLE), 0, lkp_IS_PERISHABLE)
          OR IFF(
            ISNULL(src_OMS_BILLING_METHOD_ID),
            0,
            src_OMS_BILLING_METHOD_ID
          ) <> IFF(ISNULL(lkp_BILLING_METHOD), 0, lkp_BILLING_METHOD)
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_ASSIGNED_CARRIER_CD))),
            ' ',
            LTRIM(RTRIM(src_OMS_ASSIGNED_CARRIER_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_ASSIGNED_CARRIER_CD))),
            ' ',
            LTRIM(RTRIM(lkp_ASSIGNED_CARRIER_CD))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_TRANS_RESP_CD))),
            ' ',
            LTRIM(RTRIM(src_OMS_TRANS_RESP_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_TRANS_RESP_CD))),
            ' ',
            LTRIM(RTRIM(lkp_TRANS_RESP_CD))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_CURRENCY_CD))),
            ' ',
            LTRIM(RTRIM(src_CURRENCY_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_CURRENCY_CD))),
            ' ',
            LTRIM(RTRIM(lkp_CURRENCY_CD))
          )
          OR IFF(
            ISNULL(src_OMS_PICKUP_START_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_PICKUP_START_TSTMP
          ) <> IFF(
            ISNULL(lkp_PICKUP_START_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_PICKUP_START_DT
          )
          OR IFF(
            ISNULL(src_OMS_PICKUP_END_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_PICKUP_END_TSTMP
          ) <> IFF(
            ISNULL(lkp_PICKUP_END_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_PICKUP_END_DT
          )
          OR IFF(
            ISNULL(src_OMS_DELIVERY_START_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_DELIVERY_START_TSTMP
          ) <> IFF(
            ISNULL(lkp_DELIVERY_START_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_DELIVERY_START_DT
          )
          OR IFF(
            ISNULL(src_OMS_DELIVERY_END_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_DELIVERY_END_TSTMP
          ) <> IFF(
            ISNULL(lkp_DELIVERY_END_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_DELIVERY_END_DT
          )
          OR IFF(ISNULL(src_NUM_STOPS), 0, src_NUM_STOPS) <> IFF(ISNULL(lkp_NUM_STOPS), 0, lkp_NUM_STOPS)
          OR IFF(ISNULL(src_NUM_DOCKS), 0, src_NUM_DOCKS) <> IFF(ISNULL(lkp_NUM_DOCKS), 0, lkp_NUM_DOCKS)
          OR IFF(ISNULL(src_HAS_NOTES_FLAG), 0, src_HAS_NOTES_FLAG) <> IFF(ISNULL(lkp_HAS_NOTES), 0, lkp_HAS_NOTES)
          OR IFF(
            ISNULL(src_HAS_ALERTS_FLAG),
            0,
            src_HAS_ALERTS_FLAG
          ) <> IFF(ISNULL(lkp_HAS_ALERTS), 0, lkp_HAS_ALERTS)
          OR IFF(
            ISNULL(src_HAS_IMPORT_ERROR_FLAG),
            0,
            src_HAS_IMPORT_ERROR_FLAG
          ) <> IFF(
            ISNULL(lkp_HAS_IMPORT_ERROR),
            0,
            lkp_HAS_IMPORT_ERROR
          )
          OR IFF(
            ISNULL(src_HAS_SOFT_CHECK_ERROR_FLAG),
            0,
            src_HAS_SOFT_CHECK_ERROR_FLAG
          ) <> IFF(
            ISNULL(lkp_HAS_SOFT_CHECK_ERROR),
            0,
            lkp_HAS_SOFT_CHECK_ERROR
          )
          OR IFF(
            ISNULL(src_HAS_TRACKING_MSG_FLAG),
            0,
            src_HAS_TRACKING_MSG_FLAG
          ) <> IFF(
            ISNULL(lkp_HAS_TRACKING_MSG),
            0,
            lkp_HAS_TRACKING_MSG
          )
          OR IFF(
            ISNULL(src_TRACKING_MSG_PROBLEM_FLAG),
            0,
            src_TRACKING_MSG_PROBLEM_FLAG
          ) <> IFF(
            ISNULL(lkp_TRACKING_MSG_PROBLEM),
            0,
            lkp_TRACKING_MSG_PROBLEM
          )
          OR IFF(
            ISNULL(src_OMS_DELIVERY_TZ_ID),
            0,
            src_OMS_DELIVERY_TZ_ID
          ) <> IFF(ISNULL(lkp_DELIVERY_TZ), 0, lkp_DELIVERY_TZ)
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_O_STOP_LOCATION_NAME))),
            ' ',
            LTRIM(RTRIM(src_O_STOP_LOCATION_NAME))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_O_STOP_LOCATION_NAME))),
            ' ',
            LTRIM(RTRIM(lkp_O_STOP_LOCATION_NAME))
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_D_STOP_LOCATION_NAME))),
            ' ',
            LTRIM(RTRIM(src_D_STOP_LOCATION_NAME))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_D_STOP_LOCATION_NAME))),
            ' ',
            LTRIM(RTRIM(lkp_D_STOP_LOCATION_NAME))
          )
          OR IFF(
            ISNULL(src_USE_BROKER_AS_CARRIER_FLAG),
            0,
            src_USE_BROKER_AS_CARRIER_FLAG
          ) <> IFF(
            ISNULL(lkp_USE_BROKER_AS_CARRIER),
            0,
            lkp_USE_BROKER_AS_CARRIER
          )
          OR IFF(
            ISNULL(src_OMS_STATUS_CHANGE_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_STATUS_CHANGE_TSTMP
          ) <> IFF(
            ISNULL(lkp_STATUS_CHANGE_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_STATUS_CHANGE_DT
          )
          OR IFF(ISNULL(src_REPORTED_COST), 0, src_REPORTED_COST) <> IFF(ISNULL(lkp_REPORTED_COST), 0, lkp_REPORTED_COST)
          OR IFF(
            ISNULL(src_AUTO_DELIVERED_FLAG),
            0,
            src_AUTO_DELIVERED_FLAG
          ) <> IFF(
            ISNULL(lkp_IS_AUTO_DELIVERED),
            0,
            lkp_IS_AUTO_DELIVERED
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_SHIPMENT_TYPE_CD))),
            ' ',
            LTRIM(RTRIM(src_OMS_SHIPMENT_TYPE_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_SHIPMENT_TYPE))),
            ' ',
            LTRIM(RTRIM(lkp_SHIPMENT_TYPE))
          )
          OR IFF(
            ISNULL(src_SHIPMENT_RECONCILED_FLAG),
            0,
            src_SHIPMENT_RECONCILED_FLAG
          ) <> IFF(
            ISNULL(lkp_IS_SHIPMENT_RECONCILED),
            0,
            lkp_IS_SHIPMENT_RECONCILED
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_DELIVERY_REQ))),
            ' ',
            LTRIM(RTRIM(src_DELIVERY_REQ))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_DELIVERY_REQ))),
            ' ',
            LTRIM(RTRIM(lkp_DELIVERY_REQ))
          )
          OR IFF(
            ISNULL(src_WAYPOINT_TOTAL_COST),
            0,
            src_WAYPOINT_TOTAL_COST
          ) <> IFF(
            ISNULL(lkp_WAYPOINT_TOTAL_COST),
            0,
            lkp_WAYPOINT_TOTAL_COST
          )
          OR IFF(
            ISNULL(src_WAYPOINT_HANDLING_COST),
            0,
            src_WAYPOINT_HANDLING_COST
          ) <> IFF(
            ISNULL(lkp_WAYPOINT_HANDLING_COST),
            0,
            lkp_WAYPOINT_HANDLING_COST
          )
          OR IFF(
            ISNULL(src_MANUAL_ASSIGN_FLAG),
            0,
            src_MANUAL_ASSIGN_FLAG
          ) <> IFF(
            ISNULL(lkp_IS_MANUAL_ASSIGN),
            0,
            lkp_IS_MANUAL_ASSIGN
          )
          OR IFF(
            ISNULL(src_OMS_PRIORITY_TYPE_ID),
            0,
            src_OMS_PRIORITY_TYPE_ID
          ) <> IFF(ISNULL(lkp_PRIORITY_TYPE), 0, lkp_PRIORITY_TYPE)
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_MV_CURRENCY_CD))),
            ' ',
            LTRIM(RTRIM(src_MV_CURRENCY_CD))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_MV_CURRENCY_CD))),
            ' ',
            LTRIM(RTRIM(lkp_MV_CURRENCY_CD))
          )
          OR IFF(
            ISNULL(src_OMS_SHIPMENT_LEG_TYPE_ID),
            0,
            src_OMS_SHIPMENT_LEG_TYPE_ID
          ) <> IFF(
            ISNULL(lkp_SHIPMENT_LEG_TYPE),
            0,
            lkp_SHIPMENT_LEG_TYPE
          )
          OR IFF(
            ISNULL(src_SHIPMENT_CLOSED_IND),
            0,
            src_SHIPMENT_CLOSED_IND
          ) <> IFF(
            ISNULL(lkp_SHIPMENT_CLOSED_INDICATOR),
            0,
            lkp_SHIPMENT_CLOSED_INDICATOR
          )
          OR IFF(
            ISNULL(src_OMS_PICKUP_TZ_ID),
            0,
            src_OMS_PICKUP_TZ_ID
          ) <> IFF(ISNULL(lkp_BK_PICKUP_TZ), 0, lkp_BK_PICKUP_TZ)
          OR IFF(
            ISNULL(src_NUM_CHARGE_LAYOVERS),
            0,
            src_NUM_CHARGE_LAYOVERS
          ) <> IFF(
            ISNULL(lkp_NUM_CHARGE_LAYOVERS),
            0,
            lkp_NUM_CHARGE_LAYOVERS
          )
          OR IFF(
            ISNULL(src_OMS_PICK_START_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_PICK_START_TSTMP
          ) <> IFF(
            ISNULL(lkp_PICK_START_DT),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_PICK_START_DT
          )
          OR IFF(ISNULL(src_TOTAL_TIME), 0, src_TOTAL_TIME) <> IFF(ISNULL(lkp_TOTAL_TIME), 0, lkp_TOTAL_TIME)
          OR IFF(
            ISNULL(src_RETAIN_CONSOLIDATOR_TIMES_FLAG),
            0,
            src_RETAIN_CONSOLIDATOR_TIMES_FLAG
          ) <> IFF(
            ISNULL(lkp_RETAIN_CONSOLIDATOR_TIMES),
            0,
            lkp_RETAIN_CONSOLIDATOR_TIMES
          )
          OR IFF(
            ISNULL(src_OMS_EVENT_IND_TYPE_ID),
            0,
            src_OMS_EVENT_IND_TYPE_ID
          ) <> IFF(
            ISNULL(lkp_EVENT_IND_TYPEID),
            0,
            lkp_EVENT_IND_TYPEID
          )
          OR IFF(
            ISNULL(src_OMS_DELAY_TYPE_ID),
            0,
            src_OMS_DELAY_TYPE_ID
          ) <> IFF(ISNULL(lkp_DELAY_TYPE), 0, lkp_DELAY_TYPE)
          OR IFF(
            ISNULL(src_OMS_ASSIGNED_CARRIER_ID),
            0,
            src_OMS_ASSIGNED_CARRIER_ID
          ) <> IFF(
            ISNULL(lkp_ASSIGNED_CARRIER_ID),
            0,
            lkp_ASSIGNED_CARRIER_ID
          )
          OR IFF(
            ISNULL(src_HAS_EM_NOTIFY_FLAG),
            0,
            src_HAS_EM_NOTIFY_FLAG
          ) <> IFF(
            ISNULL(lkp_HAS_EM_NOTIFY_FLAG),
            0,
            lkp_HAS_EM_NOTIFY_FLAG
          )
          OR IFF(ISNULL(src_OMS_REGION_ID), 0, src_OMS_REGION_ID) <> IFF(ISNULL(lkp_REGION_ID), 0, lkp_REGION_ID)
          OR IFF(
            ISNULL(src_OMS_INBOUND_REGION_ID),
            0,
            src_OMS_INBOUND_REGION_ID
          ) <> IFF(
            ISNULL(lkp_INBOUND_REGION_ID),
            0,
            lkp_INBOUND_REGION_ID
          )
          OR IFF(
            ISNULL(src_OMS_OUTBOUND_REGION_ID),
            0,
            src_OMS_OUTBOUND_REGION_ID
          ) <> IFF(
            ISNULL(lkp_OUTBOUND_REGION_ID),
            0,
            lkp_OUTBOUND_REGION_ID
          )
          OR IFF(
            ISNULL(src_SHIPMENT_WIN_ADJ_FLAG),
            0,
            src_SHIPMENT_WIN_ADJ_FLAG
          ) <> IFF(
            ISNULL(lkp_SHIPMENT_WIN_ADJ_FLAG),
            0,
            lkp_SHIPMENT_WIN_ADJ_FLAG
          )
          OR IFF(
            ISNULL(src_OMS_CREATED_SOURCE_TYPE_ID),
            0,
            src_OMS_CREATED_SOURCE_TYPE_ID
          ) <> IFF(
            ISNULL(lkp_CREATED_SOURCE_TYPE),
            0,
            lkp_CREATED_SOURCE_TYPE
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_CREATED_SOURCE))),
            ' ',
            LTRIM(RTRIM(src_OMS_CREATED_SOURCE))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_CREATED_SOURCE))),
            ' ',
            LTRIM(RTRIM(lkp_CREATED_SOURCE))
          )
          OR IFF(
            ISNULL(src_OMS_CREATED_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_CREATED_TSTMP
          ) <> IFF(
            ISNULL(lkp_CREATED_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_CREATED_TSTMP
          )
          OR IFF(
            ISNULL(src_OMS_LAST_UPDATED_SOURCE_TYPE_ID),
            0,
            src_OMS_LAST_UPDATED_SOURCE_TYPE_ID
          ) <> IFF(
            ISNULL(lkp_LAST_UPDATED_SOURCE_TYPE),
            0,
            lkp_LAST_UPDATED_SOURCE_TYPE
          )
          OR IFF(
            ISNULL(LTRIM(RTRIM(src_OMS_LAST_UPDATED_SOURCE))),
            ' ',
            LTRIM(RTRIM(src_OMS_LAST_UPDATED_SOURCE))
          ) <> IFF(
            ISNULL(LTRIM(RTRIM(lkp_LAST_UPDATED_SOURCE))),
            ' ',
            LTRIM(RTRIM(lkp_LAST_UPDATED_SOURCE))
          )
          OR IFF(
            ISNULL(src_OMS_LAST_UPDATED_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            src_OMS_LAST_UPDATED_TSTMP
          ) <> IFF(
            ISNULL(lkp_LAST_UPDATED_TSTMP),
            To_DATE('12-31-9999', 'MM-DD-YYYY'),
            lkp_LAST_UPDATED_TSTMP
          )
          OR IFF(ISNULL(src_ORDER_QTY), 0, src_ORDER_QTY) <> IFF(ISNULL(lkp_ORDER_QTY), 0, lkp_ORDER_QTY)
          OR IFF(ISNULL(src_TOTAL_COST), 0, src_TOTAL_COST) <> IFF(ISNULL(lkp_TOTAL_COST), 0, lkp_TOTAL_COST)
        )
      ),
      'UPDATE',
      'REJECT'
    )
  ) AS o_LOAD_FLAG,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  JNR_OMS_SHIPMENT_10"""

df_11 = spark.sql(query_11)

df_11.createOrReplaceTempView("EXP_FLAGS_11")

# COMMAND ----------
# DBTITLE 1, FIL_UNCHANGED_REC_12


query_12 = f"""SELECT
  src_OMS_ORDER_ID AS src_OMS_ORDER_ID,
  src_OMS_SHIPMENT_ID AS src_OMS_SHIPMENT_ID,
  src_OMS_TC_COMPANY_ID AS src_OMS_TC_COMPANY_ID,
  src_OMS_TC_SHIPMENT_ID AS src_OMS_TC_SHIPMENT_ID,
  src_OMS_SHIPMENT_TYPE_CD AS src_OMS_SHIPMENT_TYPE_CD,
  src_OMS_SHIPMENT_STATUS_ID AS src_OMS_SHIPMENT_STATUS_ID,
  src_SHIPMENT_CLOSED_IND AS src_SHIPMENT_CLOSED_IND,
  src_OMS_STATUS_CHANGE_TSTMP AS src_OMS_STATUS_CHANGE_TSTMP,
  src_OMS_CREATION_TYPE_ID AS src_OMS_CREATION_TYPE_ID,
  src_CANCELLED_FLAG AS src_CANCELLED_FLAG,
  src_AUTO_DELIVERED_FLAG AS src_AUTO_DELIVERED_FLAG,
  src_SHIPMENT_RECONCILED_FLAG AS src_SHIPMENT_RECONCILED_FLAG,
  src_OMS_SHIPMENT_LEG_TYPE_ID AS src_OMS_SHIPMENT_LEG_TYPE_ID,
  src_DELIVERY_REQ AS src_DELIVERY_REQ,
  src_OMS_AVAILABLE_TSTMP AS src_OMS_AVAILABLE_TSTMP,
  src_OMS_REGION_ID AS src_OMS_REGION_ID,
  src_OMS_INBOUND_REGION_ID AS src_OMS_INBOUND_REGION_ID,
  src_OMS_OUTBOUND_REGION_ID AS src_OMS_OUTBOUND_REGION_ID,
  src_OMS_O_FACILITY_NBR AS src_OMS_O_FACILITY_NBR,
  src_OMS_O_FACILITY_ID AS src_OMS_O_FACILITY_ID,
  src_O_STOP_LOCATION_NAME AS src_O_STOP_LOCATION_NAME,
  src_D_STOP_LOCATION_NAME AS src_D_STOP_LOCATION_NAME,
  src_O_ADDR AS src_O_ADDR,
  src_O_CITY AS src_O_CITY,
  src_O_STATE_PROV AS src_O_STATE_PROV,
  src_O_POSTAL_CD AS src_O_POSTAL_CD,
  src_O_COUNTRY_CD AS src_O_COUNTRY_CD,
  src_D_ADDR AS src_D_ADDR,
  src_D_CITY AS src_D_CITY,
  src_D_STATE_PROV AS src_D_STATE_PROV,
  src_D_POSTAL_CD AS src_D_POSTAL_CD,
  src_D_COUNTRY_CD AS src_D_COUNTRY_CD,
  src_PERISHABLE_FLAG AS src_PERISHABLE_FLAG,
  src_HAS_NOTES_FLAG AS src_HAS_NOTES_FLAG,
  src_HAS_ALERTS_FLAG AS src_HAS_ALERTS_FLAG,
  src_HAS_EM_NOTIFY_FLAG AS src_HAS_EM_NOTIFY_FLAG,
  src_SHIPMENT_WIN_ADJ_FLAG AS src_SHIPMENT_WIN_ADJ_FLAG,
  src_HAS_IMPORT_ERROR_FLAG AS src_HAS_IMPORT_ERROR_FLAG,
  src_HAS_SOFT_CHECK_ERROR_FLAG AS src_HAS_SOFT_CHECK_ERROR_FLAG,
  src_HAS_TRACKING_MSG_FLAG AS src_HAS_TRACKING_MSG_FLAG,
  src_TRACKING_MSG_PROBLEM_FLAG AS src_TRACKING_MSG_PROBLEM_FLAG,
  src_USE_BROKER_AS_CARRIER_FLAG AS src_USE_BROKER_AS_CARRIER_FLAG,
  src_UPDATE_SENT_FLAG AS src_UPDATE_SENT_FLAG,
  src_MANUAL_ASSIGN_FLAG AS src_MANUAL_ASSIGN_FLAG,
  src_OMS_PRIORITY_TYPE_ID AS src_OMS_PRIORITY_TYPE_ID,
  src_RETAIN_CONSOLIDATOR_TIMES_FLAG AS src_RETAIN_CONSOLIDATOR_TIMES_FLAG,
  src_OMS_EVENT_IND_TYPE_ID AS src_OMS_EVENT_IND_TYPE_ID,
  src_OMS_DELAY_TYPE_ID AS src_OMS_DELAY_TYPE_ID,
  src_OMS_ASSIGNED_CARRIER_ID AS src_OMS_ASSIGNED_CARRIER_ID,
  src_OMS_ASSIGNED_CARRIER_CD AS src_OMS_ASSIGNED_CARRIER_CD,
  src_OMS_BILLING_METHOD_ID AS src_OMS_BILLING_METHOD_ID,
  src_OMS_TRANS_RESP_CD AS src_OMS_TRANS_RESP_CD,
  src_OMS_PICK_START_TSTMP AS src_OMS_PICK_START_TSTMP,
  src_OMS_PICKUP_START_TSTMP AS src_OMS_PICKUP_START_TSTMP,
  src_OMS_PICKUP_END_TSTMP AS src_OMS_PICKUP_END_TSTMP,
  src_OMS_PICKUP_TZ_ID AS src_OMS_PICKUP_TZ_ID,
  src_OMS_DELIVERY_START_TSTMP AS src_OMS_DELIVERY_START_TSTMP,
  src_OMS_DELIVERY_END_TSTMP AS src_OMS_DELIVERY_END_TSTMP,
  src_OMS_DELIVERY_TZ_ID AS src_OMS_DELIVERY_TZ_ID,
  src_NUM_CHARGE_LAYOVERS AS src_NUM_CHARGE_LAYOVERS,
  src_NUM_STOPS AS src_NUM_STOPS,
  src_NUM_DOCKS AS src_NUM_DOCKS,
  src_TOTAL_TIME AS src_TOTAL_TIME,
  src_ORDER_QTY AS src_ORDER_QTY,
  src_REPORTED_COST AS src_REPORTED_COST,
  src_WAYPOINT_TOTAL_COST AS src_WAYPOINT_TOTAL_COST,
  src_WAYPOINT_HANDLING_COST AS src_WAYPOINT_HANDLING_COST,
  src_TOTAL_COST AS src_TOTAL_COST,
  src_CURRENCY_CD AS src_CURRENCY_CD,
  src_MV_CURRENCY_CD AS src_MV_CURRENCY_CD,
  src_OMS_CREATED_SOURCE_TYPE_ID AS src_OMS_CREATED_SOURCE_TYPE_ID,
  src_OMS_CREATED_SOURCE AS src_OMS_CREATED_SOURCE,
  src_OMS_CREATED_TSTMP AS src_OMS_CREATED_TSTMP,
  src_OMS_LAST_UPDATED_SOURCE_TYPE_ID AS src_OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  src_OMS_LAST_UPDATED_SOURCE AS src_OMS_LAST_UPDATED_SOURCE,
  src_OMS_LAST_UPDATED_TSTMP AS src_OMS_LAST_UPDATED_TSTMP,
  lkp_SHIPMENT_ID AS lkp_SHIPMENT_ID,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP_exp AS LOAD_TSTMP_exp,
  o_LOAD_FLAG AS o_LOAD_FLAG,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  EXP_FLAGS_11
WHERE
  IN(o_LOAD_FLAG, 'INSERT', 'UPDATE')"""

df_12 = spark.sql(query_12)

df_12.createOrReplaceTempView("FIL_UNCHANGED_REC_12")

# COMMAND ----------
# DBTITLE 1, UPD_INS_UPD_13


query_13 = f"""SELECT
  src_OMS_ORDER_ID AS src_OMS_ORDER_ID,
  src_OMS_SHIPMENT_ID AS src_OMS_SHIPMENT_ID,
  src_OMS_TC_COMPANY_ID AS src_OMS_TC_COMPANY_ID,
  src_OMS_TC_SHIPMENT_ID AS src_OMS_TC_SHIPMENT_ID,
  src_OMS_SHIPMENT_TYPE_CD AS src_OMS_SHIPMENT_TYPE_CD,
  src_OMS_SHIPMENT_STATUS_ID AS src_OMS_SHIPMENT_STATUS_ID,
  src_SHIPMENT_CLOSED_IND AS src_SHIPMENT_CLOSED_IND,
  src_OMS_STATUS_CHANGE_TSTMP AS src_OMS_STATUS_CHANGE_TSTMP,
  src_OMS_CREATION_TYPE_ID AS src_OMS_CREATION_TYPE_ID,
  src_CANCELLED_FLAG AS src_CANCELLED_FLAG,
  src_AUTO_DELIVERED_FLAG AS src_AUTO_DELIVERED_FLAG,
  src_SHIPMENT_RECONCILED_FLAG AS src_SHIPMENT_RECONCILED_FLAG,
  src_OMS_SHIPMENT_LEG_TYPE_ID AS src_OMS_SHIPMENT_LEG_TYPE_ID,
  src_DELIVERY_REQ AS src_DELIVERY_REQ,
  src_OMS_AVAILABLE_TSTMP AS src_OMS_AVAILABLE_TSTMP,
  src_OMS_REGION_ID AS src_OMS_REGION_ID,
  src_OMS_INBOUND_REGION_ID AS src_OMS_INBOUND_REGION_ID,
  src_OMS_OUTBOUND_REGION_ID AS src_OMS_OUTBOUND_REGION_ID,
  src_OMS_O_FACILITY_NBR AS src_OMS_O_FACILITY_NBR,
  src_OMS_O_FACILITY_ID AS src_OMS_O_FACILITY_ID,
  src_O_STOP_LOCATION_NAME AS src_O_STOP_LOCATION_NAME,
  src_D_STOP_LOCATION_NAME AS src_D_STOP_LOCATION_NAME,
  src_O_ADDR AS src_O_ADDR,
  src_O_CITY AS src_O_CITY,
  src_O_STATE_PROV AS src_O_STATE_PROV,
  src_O_POSTAL_CD AS src_O_POSTAL_CD,
  src_O_COUNTRY_CD AS src_O_COUNTRY_CD,
  src_D_ADDR AS src_D_ADDR,
  src_D_CITY AS src_D_CITY,
  src_D_STATE_PROV AS src_D_STATE_PROV,
  src_D_POSTAL_CD AS src_D_POSTAL_CD,
  src_D_COUNTRY_CD AS src_D_COUNTRY_CD,
  src_PERISHABLE_FLAG AS src_PERISHABLE_FLAG,
  src_HAS_NOTES_FLAG AS src_HAS_NOTES_FLAG,
  src_HAS_ALERTS_FLAG AS src_HAS_ALERTS_FLAG,
  src_HAS_EM_NOTIFY_FLAG AS src_HAS_EM_NOTIFY_FLAG,
  src_SHIPMENT_WIN_ADJ_FLAG AS src_SHIPMENT_WIN_ADJ_FLAG,
  src_HAS_IMPORT_ERROR_FLAG AS src_HAS_IMPORT_ERROR_FLAG,
  src_HAS_SOFT_CHECK_ERROR_FLAG AS src_HAS_SOFT_CHECK_ERROR_FLAG,
  src_HAS_TRACKING_MSG_FLAG AS src_HAS_TRACKING_MSG_FLAG,
  src_TRACKING_MSG_PROBLEM_FLAG AS src_TRACKING_MSG_PROBLEM_FLAG,
  src_USE_BROKER_AS_CARRIER_FLAG AS src_USE_BROKER_AS_CARRIER_FLAG,
  src_UPDATE_SENT_FLAG AS src_UPDATE_SENT_FLAG,
  src_MANUAL_ASSIGN_FLAG AS src_MANUAL_ASSIGN_FLAG,
  src_OMS_PRIORITY_TYPE_ID AS src_OMS_PRIORITY_TYPE_ID,
  src_RETAIN_CONSOLIDATOR_TIMES_FLAG AS src_RETAIN_CONSOLIDATOR_TIMES_FLAG,
  src_OMS_EVENT_IND_TYPE_ID AS src_OMS_EVENT_IND_TYPE_ID,
  src_OMS_DELAY_TYPE_ID AS src_OMS_DELAY_TYPE_ID,
  src_OMS_ASSIGNED_CARRIER_ID AS src_OMS_ASSIGNED_CARRIER_ID,
  src_OMS_ASSIGNED_CARRIER_CD AS src_OMS_ASSIGNED_CARRIER_CD,
  src_OMS_BILLING_METHOD_ID AS src_OMS_BILLING_METHOD_ID,
  src_OMS_TRANS_RESP_CD AS src_OMS_TRANS_RESP_CD,
  src_OMS_PICK_START_TSTMP AS src_OMS_PICK_START_TSTMP,
  src_OMS_PICKUP_START_TSTMP AS src_OMS_PICKUP_START_TSTMP,
  src_OMS_PICKUP_END_TSTMP AS src_OMS_PICKUP_END_TSTMP,
  src_OMS_PICKUP_TZ_ID AS src_OMS_PICKUP_TZ_ID,
  src_OMS_DELIVERY_START_TSTMP AS src_OMS_DELIVERY_START_TSTMP,
  src_OMS_DELIVERY_END_TSTMP AS src_OMS_DELIVERY_END_TSTMP,
  src_OMS_DELIVERY_TZ_ID AS src_OMS_DELIVERY_TZ_ID,
  src_NUM_CHARGE_LAYOVERS AS src_NUM_CHARGE_LAYOVERS,
  src_NUM_STOPS AS src_NUM_STOPS,
  src_NUM_DOCKS AS src_NUM_DOCKS,
  src_TOTAL_TIME AS src_TOTAL_TIME,
  src_ORDER_QTY AS src_ORDER_QTY,
  src_REPORTED_COST AS src_REPORTED_COST,
  src_WAYPOINT_TOTAL_COST AS src_WAYPOINT_TOTAL_COST,
  src_WAYPOINT_HANDLING_COST AS src_WAYPOINT_HANDLING_COST,
  src_TOTAL_COST AS src_TOTAL_COST,
  src_CURRENCY_CD AS src_CURRENCY_CD,
  src_MV_CURRENCY_CD AS src_MV_CURRENCY_CD,
  src_OMS_CREATED_SOURCE_TYPE_ID AS src_OMS_CREATED_SOURCE_TYPE_ID,
  src_OMS_CREATED_SOURCE AS src_OMS_CREATED_SOURCE,
  src_OMS_CREATED_TSTMP AS src_OMS_CREATED_TSTMP,
  src_OMS_LAST_UPDATED_SOURCE_TYPE_ID AS src_OMS_LAST_UPDATED_SOURCE_TYPE_ID,
  src_OMS_LAST_UPDATED_SOURCE AS src_OMS_LAST_UPDATED_SOURCE,
  src_OMS_LAST_UPDATED_TSTMP AS src_OMS_LAST_UPDATED_TSTMP,
  lkp_SHIPMENT_ID AS lkp_SHIPMENT_ID,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP_exp AS LOAD_TSTMP_exp,
  o_LOAD_FLAG AS o_LOAD_FLAG,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id,
  DECODE(
    o_LOAD_FLAG,
    'INSERT',
    'DD_INSERT',
    'UPDATE',
    'DD_UPDATE',
    'DD_REJECT'
  ) AS UPDATE_STRATEGY_FLAG
FROM
  FIL_UNCHANGED_REC_12"""

df_13 = spark.sql(query_13)

df_13.createOrReplaceTempView("UPD_INS_UPD_13")

# COMMAND ----------
# DBTITLE 1, EXP_TGT_14


query_14 = f"""SELECT
  src_OMS_SHIPMENT_ID AS SHIPMENT_ID,
  src_OMS_ORDER_ID AS OMS_DIST_ORDER_ID,
  src_OMS_TC_COMPANY_ID AS TC_COMPANY_ID,
  src_OMS_TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  src_OMS_SHIPMENT_STATUS_ID AS SHIPMENT_STATUS,
  src_UPDATE_SENT_FLAG AS UPDATE_SENT,
  src_OMS_CREATION_TYPE_ID AS CREATION_TYPE,
  src_CANCELLED_FLAG AS IS_CANCELLED,
  src_OMS_AVAILABLE_TSTMP AS AVAILABLE_DT,
  src_OMS_O_FACILITY_NBR AS O_FACILITY_NBR,
  src_OMS_O_FACILITY_ID AS O_FACILITY_ID,
  src_O_ADDR AS O_ADDRESS,
  src_O_CITY AS O_CITY,
  src_O_STATE_PROV AS O_STATE_PROV,
  src_O_POSTAL_CD AS O_POSTAL_CD,
  src_O_COUNTRY_CD AS O_COUNTRY_CD,
  src_D_ADDR AS D_ADDRESS,
  src_D_CITY AS D_CITY,
  src_D_STATE_PROV AS D_STATE_PROV,
  src_D_POSTAL_CD AS D_POSTAL_CD,
  src_D_COUNTRY_CD AS D_COUNTRY_CD,
  src_PERISHABLE_FLAG AS IS_PERISHABLE,
  src_OMS_BILLING_METHOD_ID AS BILLING_METHOD,
  src_OMS_ASSIGNED_CARRIER_CD AS ASSIGNED_CARRIER_CD,
  src_OMS_TRANS_RESP_CD AS TRANS_RESP_CD,
  src_CURRENCY_CD AS CURRENCY_CD,
  src_OMS_PICKUP_START_TSTMP AS PICKUP_START_DT,
  src_OMS_PICKUP_END_TSTMP AS PICKUP_END_DT,
  src_OMS_DELIVERY_START_TSTMP AS DELIVERY_START_DT,
  src_OMS_DELIVERY_END_TSTMP AS DELIVERY_END_DT,
  src_NUM_STOPS AS NUM_STOPS,
  src_NUM_DOCKS AS NUM_DOCKS,
  src_HAS_NOTES_FLAG AS HAS_NOTES,
  src_HAS_ALERTS_FLAG AS HAS_ALERTS,
  src_HAS_IMPORT_ERROR_FLAG AS HAS_IMPORT_ERROR,
  src_HAS_SOFT_CHECK_ERROR_FLAG AS HAS_SOFT_CHECK_ERROR,
  src_HAS_TRACKING_MSG_FLAG AS HAS_TRACKING_MSG,
  src_TRACKING_MSG_PROBLEM_FLAG AS TRACKING_MSG_PROBLEM,
  src_OMS_DELIVERY_TZ_ID AS DELIVERY_TZ,
  src_O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  src_D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  src_USE_BROKER_AS_CARRIER_FLAG AS USE_BROKER_AS_CARRIER,
  src_OMS_STATUS_CHANGE_TSTMP AS STATUS_CHANGE_DT,
  src_REPORTED_COST AS REPORTED_COST,
  src_AUTO_DELIVERED_FLAG AS IS_AUTO_DELIVERED,
  src_OMS_SHIPMENT_TYPE_CD AS SHIPMENT_TYPE,
  src_SHIPMENT_RECONCILED_FLAG AS IS_SHIPMENT_RECONCILED,
  src_DELIVERY_REQ AS DELIVERY_REQ,
  src_WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  src_WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  src_MANUAL_ASSIGN_FLAG AS IS_MANUAL_ASSIGN,
  src_OMS_PRIORITY_TYPE_ID AS PRIORITY_TYPE,
  src_MV_CURRENCY_CD AS MV_CURRENCY_CD,
  src_OMS_SHIPMENT_LEG_TYPE_ID AS SHIPMENT_LEG_TYPE,
  src_SHIPMENT_CLOSED_IND AS SHIPMENT_CLOSED_INDICATOR,
  src_OMS_PICKUP_TZ_ID AS BK_PICKUP_TZ,
  src_NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  src_OMS_PICK_START_TSTMP AS PICK_START_DT,
  src_TOTAL_TIME AS TOTAL_TIME,
  src_RETAIN_CONSOLIDATOR_TIMES_FLAG AS RETAIN_CONSOLIDATOR_TIMES,
  src_OMS_EVENT_IND_TYPE_ID AS EVENT_IND_TYPEID,
  src_OMS_DELAY_TYPE_ID AS DELAY_TYPE,
  src_OMS_ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  src_HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  src_OMS_REGION_ID AS REGION_ID,
  src_OMS_INBOUND_REGION_ID AS INBOUND_REGION_ID,
  src_OMS_OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  src_SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  src_OMS_CREATED_SOURCE_TYPE_ID AS CREATED_SOURCE_TYPE,
  src_OMS_CREATED_SOURCE AS CREATED_SOURCE,
  src_OMS_CREATED_TSTMP AS CREATED_TSTMP,
  src_OMS_LAST_UPDATED_SOURCE_TYPE_ID AS LAST_UPDATED_SOURCE_TYPE,
  src_OMS_LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  src_OMS_LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  src_TOTAL_COST AS TOTAL_COST,
  src_ORDER_QTY AS ORDER_QTY,
  LOAD_TSTMP_exp AS LOAD_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  UPD_INS_UPD_13"""

df_14 = spark.sql(query_14)

df_14.createOrReplaceTempView("EXP_TGT_14")

# COMMAND ----------
# DBTITLE 1, OMS_SHIPMENT


spark.sql("""INSERT INTO
  OMS_SHIPMENT
SELECT
  SHIPMENT_ID AS SHIPMENT_ID,
  OMS_DIST_ORDER_ID AS OMS_DIST_ORDER_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  NULL AS RS_AREA_ID,
  TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  NULL AS PP_SHIPMENT_ID,
  SHIPMENT_STATUS AS SHIPMENT_STATUS,
  UPDATE_SENT AS UPDATE_SENT,
  NULL AS BUSINESS_PROCESS,
  CREATION_TYPE AS CREATION_TYPE,
  NULL AS CONS_RUN_ID,
  IS_CANCELLED AS IS_CANCELLED,
  NULL AS RS_TYPE,
  NULL AS RS_CONFIG_ID,
  NULL AS RS_CONFIG_CYCLE_ID,
  NULL AS CONFIG_CYCLE_SEQ,
  NULL AS CYCLE_DEADLINE_DT,
  NULL AS CYCLE_EXECUTION_DT,
  NULL AS LAST_RS_NOTIFICATION_DT,
  NULL AS CFMF_STATUS,
  AVAILABLE_DT AS AVAILABLE_DT,
  NULL AS CMID,
  NULL AS CM_DISCOUNT,
  O_FACILITY_NBR AS O_FACILITY_NBR,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_ADDRESS AS O_ADDRESS,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CD AS O_POSTAL_CD,
  NULL AS O_COUNTY,
  O_COUNTRY_CD AS O_COUNTRY_CD,
  NULL AS D_FACILITY_NBR,
  NULL AS D_FACILITY_ID,
  D_ADDRESS AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  NULL AS D_COUNTY,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  NULL AS DISTANCE,
  NULL AS DIRECT_DISTANCE,
  NULL AS OUT_OF_ROUTE_DISTANCE,
  NULL AS DISTANCE_UOM,
  NULL AS BUSINESS_PARTNER_ID,
  NULL AS COMMODITY_CLASS,
  NULL AS IS_HAZMAT,
  IS_PERISHABLE AS IS_PERISHABLE,
  BILLING_METHOD AS BILLING_METHOD,
  NULL AS DSG_CARRIER_CD,
  NULL AS REC_CMID,
  NULL AS REC_CM_SHIPMENT_ID,
  ASSIGNED_CARRIER_CD AS ASSIGNED_CARRIER_CD,
  NULL AS SHIPMENT_REF_ID,
  NULL AS BILL_TO_CD,
  NULL AS BILL_TO_TITLE,
  NULL AS BILL_TO_NAME,
  NULL AS BILL_TO_ADDRESS,
  NULL AS BILL_TO_CITY,
  NULL AS BILL_TO_STATE_PROV,
  NULL AS BILL_TO_POSTAL_CD,
  NULL AS BILL_TO_COUNTRY_CD,
  NULL AS BILL_TO_PHONE_NBR,
  NULL AS PURCHASE_ORDER,
  NULL AS PRO_NBR,
  TRANS_RESP_CD AS TRANS_RESP_CD,
  NULL AS BASELINE_COST,
  NULL AS ESTIMATED_COST,
  NULL AS LINEHAUL_COST,
  NULL AS ACCESSORIAL_COST,
  NULL AS STOP_COST,
  NULL AS ESTIMATED_SAVINGS,
  NULL AS SPOT_CHARGE,
  CURRENCY_CD AS CURRENCY_CD,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  NUM_STOPS AS NUM_STOPS,
  NUM_DOCKS AS NUM_DOCKS,
  NULL AS ON_TIME_INDICATOR,
  HAS_NOTES AS HAS_NOTES,
  HAS_ALERTS AS HAS_ALERTS,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_SOFT_CHECK_ERROR AS HAS_SOFT_CHECK_ERROR,
  HAS_TRACKING_MSG AS HAS_TRACKING_MSG,
  TRACKING_MSG_PROBLEM AS TRACKING_MSG_PROBLEM,
  NULL AS REC_LINEHAUL_COST,
  NULL AS REC_ACCESSORIAL_COST,
  NULL AS REC_TOTAL_COST,
  NULL AS CYCLE_RESP_DEADLINE_TZ,
  NULL AS TENDER_RESP_DEADLINE_TZ,
  NULL AS PICKUP_TZ,
  DELIVERY_TZ AS DELIVERY_TZ,
  NULL AS ASSIGNED_LANE_ID,
  NULL AS ASSIGNED_LANE_DETAIL_ID,
  NULL AS REC_SPOT_CHARGE,
  NULL AS REC_LANE_ID,
  NULL AS REC_LANE_DETAIL_ID,
  NULL AS TENDER_DT,
  O_STOP_LOCATION_NAME AS O_STOP_LOCATION_NAME,
  D_STOP_LOCATION_NAME AS D_STOP_LOCATION_NAME,
  NULL AS ASSIGNED_CM_SHIPMENT_ID,
  NULL AS REC_CM_DISCOUNT,
  NULL AS REC_STOP_COST,
  NULL AS LAST_SELECTOR_RUN_DT,
  NULL AS LAST_CM_OPTION_GEN_DT,
  NULL AS IS_CM_OPTION_GEN_ACTIVE,
  NULL AS RS_CYCLE_REMAINING,
  NULL AS IS_TIME_FEAS_D,
  NULL AS EXT_SYS_SHIPMENT_ID,
  NULL AS EXTRACTION_DT,
  NULL AS ASSIGNED_BROKER_CARRIER_CD,
  USE_BROKER_AS_CARRIER AS USE_BROKER_AS_CARRIER,
  NULL AS BROKER_REF,
  NULL AS RATING_QUALIFIER,
  STATUS_CHANGE_DT AS STATUS_CHANGE_DT,
  NULL AS BUDG_TOTAL_COST,
  NULL AS NORMALIZED_MARGIN,
  NULL AS NORMALIZED_TOTAL_COST,
  NULL AS BUDG_NORMALIZED_TOTAL_COST,
  NULL AS REC_BUDG_LINEHAUL_COST,
  NULL AS REC_BUDG_STOP_COST,
  NULL AS REC_BUDG_CM_DISCOUNT,
  NULL AS REC_BUDG_ACCESSORIAL_COST,
  NULL AS REC_BUDG_TOTAL_COST,
  NULL AS REC_MARGIN,
  NULL AS REC_NORMALIZED_MARGIN,
  NULL AS REC_NORMALIZED_TOTAL_COST,
  NULL AS REC_BUDG_NORMALIZED_TOTAL_COST,
  NULL AS BUDG_CURRENCY_CD,
  NULL AS SPOT_CHARGE_CURRENCY_CD,
  NULL AS REC_CURRENCY_CD,
  NULL AS REC_BUDG_CURRENCY_CD,
  NULL AS REC_SPOT_CHARGE_CURRENCY_CD,
  NULL AS RATING_LANE_ID,
  NULL AS FRT_REV_RATING_LANE_ID,
  NULL AS REC_RATING_LANE_ID,
  NULL AS REC_BUDG_RATING_LANE_ID,
  NULL AS RATING_LANE_DETAIL_ID,
  NULL AS FRT_REV_RATING_LANE_DETAIL_ID,
  NULL AS REC_RATING_LANE_DETAIL_ID,
  NULL AS REC_BUDG_RATING_LANE_DETAIL_ID,
  NULL AS BUDG_CM_DISCOUNT,
  NULL AS NORMALIZED_BASELINE_COST,
  NULL AS BASELINE_COST_CURRENCY_CD,
  REPORTED_COST AS REPORTED_COST,
  NULL AS TRACTOR_NBR,
  IS_AUTO_DELIVERED AS IS_AUTO_DELIVERED,
  SHIPMENT_TYPE AS SHIPMENT_TYPE,
  NULL AS ORIG_BUDG_TOTAL_COST,
  NULL AS ACCESSORIAL_COST_TO_CARRIER,
  NULL AS CARRIER_CHARGE,
  NULL AS ACTUAL_COST,
  NULL AS EARNED_INCOME,
  NULL AS SENT_TO_PKMS,
  IS_SHIPMENT_RECONCILED AS IS_SHIPMENT_RECONCILED,
  DELIVERY_REQ AS DELIVERY_REQ,
  NULL AS DROPOFF_PICKUP,
  NULL AS PACKAGING,
  NULL AS SENT_TO_PKMS_DT,
  NULL AS WMS_STATUS_CD,
  NULL AS SPOT_CHARGE_AND_PAYEE_ACC,
  NULL AS SPOT_CHARGE_AND_PAYEE_ACC_CC,
  NULL AS NORM_SPOT_CHARGE_AND_PAYEE_ACC,
  NULL AS FACILITY_SCHEDULE_ID,
  NULL AS EARNED_INCOME_CURRENCY_CD,
  NULL AS ACTUAL_COST_CURRENCY_CD,
  NULL AS SHIPMENT_RECON_DT,
  NULL AS PLN_RATING_LANE_ID,
  NULL AS PLN_RATING_LANE_DETAIL_ID,
  NULL AS PLN_TOTAL_COST,
  NULL AS PLN_LINEHAUL_COST,
  NULL AS PLN_TOTAL_ACCESSORIAL_COST,
  NULL AS PLN_STOP_OFF_COST,
  NULL AS PLN_NORMALIZED_TOTAL_COST,
  NULL AS PLN_CURRENCY_CD,
  NULL AS PLN_ACCESSORL_COST_TO_CARRIER,
  NULL AS PLN_CARRIER_CHARGE,
  WAYPOINT_TOTAL_COST AS WAYPOINT_TOTAL_COST,
  WAYPOINT_HANDLING_COST AS WAYPOINT_HANDLING_COST,
  NULL AS GRS_OPERATION,
  NULL AS IS_GRS_OPT_CYCLE_RUNNING,
  IS_MANUAL_ASSIGN AS IS_MANUAL_ASSIGN,
  NULL AS LAST_RUN_GRS_DT,
  NULL AS GRS_MAX_SHIPMENT_STATUS,
  PRIORITY_TYPE AS PRIORITY_TYPE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  NULL AS PROD_SCHED_REF_NBR,
  NULL AS COMMODITY_CODE_ID,
  NULL AS UN_NUMERIC_ID,
  NULL AS CONTRACT_NBR,
  NULL AS BOOKING_REF_SHIPPER,
  NULL AS BOOKING_REF_CARRIER,
  NULL AS BK_RESOURCE_REF_EXTERNAL,
  NULL AS BK_RESOURCE_NAME_EXTERNAL,
  NULL AS BK_O_FACILITY_ID,
  NULL AS BK_D_FACILITY_ID,
  NULL AS BK_MASTER_AIRWAY_BILL,
  NULL AS BK_FORWARDER_AIRWAY_BILL,
  NULL AS ASSIGNED_SCNDR_CARRIER_CD,
  NULL AS CUSTOMER_CREDIT_LIMIT_ID,
  SHIPMENT_LEG_TYPE AS SHIPMENT_LEG_TYPE,
  SHIPMENT_CLOSED_INDICATOR AS SHIPMENT_CLOSED_INDICATOR,
  NULL AS OCEAN_ROUTING_STAGE,
  NULL AS BK_DEPARTURE_DT,
  NULL AS BK_DEPARTURE_TZ,
  NULL AS BK_ARRIVAL_DT,
  NULL AS BK_ARRIVAL_TZ,
  NULL AS BK_PICKUP_DT,
  BK_PICKUP_TZ AS BK_PICKUP_TZ,
  NULL AS BK_CUTOFF_DT,
  NULL AS BK_CUTOFF_TZ,
  NUM_CHARGE_LAYOVERS AS NUM_CHARGE_LAYOVERS,
  NULL AS RATE_TYPE,
  NULL AS RATE_UOM,
  PICK_START_DT AS PICK_START_DT,
  NULL AS PAPERWORK_START_DT,
  NULL AS VEHICLE_CHECK_START_DT,
  NULL AS SHIPMENT_START_DT,
  NULL AS SHIPMENT_END_DT,
  NULL AS FEASIBLE_DRIVER_TYPE,
  NULL AS WAVE_ID,
  NULL AS ESTIMATED_DISPATCH_DT,
  TOTAL_TIME AS TOTAL_TIME,
  NULL AS LOC_REFERENCE,
  NULL AS BK_O_FACILITY_ALIAS_ID,
  NULL AS BK_D_FACILITY_ALIAS_ID,
  NULL AS EQUIP_UTIL_PER,
  NULL AS MOVE_TYPE,
  NULL AS DRIVER_TYPE_ID,
  NULL AS EQUIPMENT_TYPE,
  NULL AS RADIAL_DISTANCE,
  NULL AS RADIAL_DISTANCE_UOM,
  NULL AS DESIGNATED_TRACTOR_CD,
  NULL AS DESIGNATED_DRIVER_TYPE,
  NULL AS IS_WAVE_MAN_CHANGED,
  RETAIN_CONSOLIDATOR_TIMES AS RETAIN_CONSOLIDATOR_TIMES,
  NULL AS TARIFF,
  NULL AS MIN_RATE,
  NULL AS FIRST_UPDATE_SENT_TO_PKMS,
  EVENT_IND_TYPEID AS EVENT_IND_TYPEID,
  NULL AS TANDEM_PATH_ID,
  NULL AS O_TANDEM_FACILITY,
  NULL AS D_TANDEM_FACILITY,
  NULL AS O_TANDEM_FACILITY_ALIAS,
  NULL AS D_TANDEM_FACILITY_ALIAS,
  DELAY_TYPE AS DELAY_TYPE,
  ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  NULL AS DSG_CARRIER_ID,
  NULL AS REC_CARRIER_ID,
  NULL AS FEASIBLE_CARRIER_ID,
  NULL AS PAYEE_CARRIER_ID,
  NULL AS SCNDR_CARRIER_ID,
  NULL AS BROKER_CARRIER_ID,
  NULL AS ASSIGNED_SCNDR_CARRIER_ID,
  NULL AS DSG_SCNDR_CARRIER_ID,
  NULL AS ASSIGNED_BROKER_CARRIER_ID,
  NULL AS LH_PAYEE_CARRIER_ID,
  NULL AS REC_BROKER_CARRIER_ID,
  NULL AS ASSIGNED_EQUIPMENT_ID,
  NULL AS DSG_EQUIPMENT_ID,
  NULL AS FEASIBLE_EQUIPMENT_ID,
  NULL AS FEASIBLE_EQUIPMENT2_ID,
  NULL AS REC_EQUIPMENT_ID,
  NULL AS ASSIGNED_MOT_ID,
  NULL AS DSG_MOT_ID,
  NULL AS FEASIBLE_MOT_ID,
  NULL AS REC_MOT_ID,
  NULL AS PRODUCT_CLASS_ID,
  NULL AS PROTECTION_LEVEL_ID,
  NULL AS ASSIGNED_SERVICE_LEVEL_ID,
  NULL AS DSG_SERVICE_LEVEL_ID,
  NULL AS FEASIBLE_SERVICE_LEVEL_ID,
  NULL AS REC_SERVICE_LEVEL_ID,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  REGION_ID AS REGION_ID,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  NULL AS FINANCIAL_WT,
  NULL AS IS_BOOKING_REQUIRED,
  NULL AS TOTAL_COST_EXCL_TAX,
  NULL AS TOTAL_TAX_AMOUNT,
  NULL AS IS_ASSOCIATED_TO_OUTBOUND,
  NULL AS RECEIVED_DT,
  NULL AS BOOKING_ID,
  NULL AS IS_MISROUTED,
  NULL AS FEASIBLE_CARRIER_CD,
  SHIPMENT_WIN_ADJ_FLAG AS SHIPMENT_WIN_ADJ_FLAG,
  NULL AS DT_PARAM_SET_ID,
  NULL AS MERCHANDIZING_DEPARTMENT_ID,
  NULL AS STATIC_ROUTE_ID,
  NULL AS IS_FILO,
  NULL AS IS_COOLER_AT_NOSE,
  NULL AS AUTH_NBR,
  NULL AS CONS_LOCN_ID,
  NULL AS RTE_TYPE,
  NULL AS TRLR_TYPE,
  NULL AS TRLR_SIZE,
  NULL AS CONS_ADDR_CD,
  NULL AS HUB_ID,
  NULL AS TRLR_GEN_CD,
  NULL AS MAX_NBR_OF_CTNS,
  NULL AS APPT_DOOR_SCHED_TYPE,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  NULL AS DSG_SCNDR_CARRIER_CD,
  NULL AS LH_PAYEE_CARRIER_CD,
  NULL AS REC_BROKER_CARRIER_CD,
  NULL AS REC_CARRIER_CD,
  NULL AS LPN_ASSIGNMENT_STOPPED,
  NULL AS SEAL_NBR,
  NULL AS HIBERNATE_VERSION,
  NULL AS SHIP_GROUP_ID,
  NULL AS RATE,
  NULL AS MONETARY_VALUE,
  NULL AS DOOR,
  NULL AS RTE_TYPE_1,
  NULL AS RTE_TYPE_2,
  NULL AS SCHEDULED_PICKUP_DT,
  NULL AS MANIFEST_ID,
  NULL AS DAYS_TO_DELIVER,
  NULL AS SED_GENERATED_FLAG,
  NULL AS SERV_AREA_CD,
  NULL AS TENDER_RESP_DEADLINE_TSTMP,
  NULL AS PRINT_CONS_BOL,
  NULL AS LEFT_WT,
  NULL AS RIGHT_WT,
  NULL AS LANE_NAME,
  NULL AS DECLARED_VALUE,
  NULL AS DV_CURRENCY_CD,
  NULL AS COD_AMOUNT,
  NULL AS CUSTOMER_ID,
  NULL AS CUST_FRGT_CHARGE,
  NULL AS COD_CURRENCY_CD,
  NULL AS PLANNED_WEIGHT,
  NULL AS WEIGHT_UOM_ID_BASE,
  NULL AS PLANNED_VOLUME,
  NULL AS VOLUME_UOM_ID_BASE,
  NULL AS SIZE1_VALUE,
  NULL AS SIZE1_UOM_ID,
  NULL AS SIZE2_VALUE,
  NULL AS SIZE2_UOM_ID,
  NULL AS ASSIGNED_SHIP_VIA,
  NULL AS INSURANCE_STATUS,
  NULL AS RTE_SWC_NBR,
  NULL AS RTE_TO,
  NULL AS BILL_OF_LADING_NBR,
  NULL AS TRAILER_NBR,
  NULL AS TRANS_PLAN_OWNER,
  NULL AS TOTAL_REVENUE_CURRENCY_CD,
  NULL AS TOTAL_REVENUE,
  NULL AS FRT_REV_SPOT_CHARGE_CURR_CD,
  NULL AS NORMALIZED_TOTAL_REVENUE,
  NULL AS FRT_REV_SPOT_CHARGE,
  NULL AS DSG_VOYAGE_FLIGHT,
  NULL AS FEASIBLE_VOYAGE_FLIGHT,
  NULL AS CURRENCY_TSTMP,
  NULL AS FRT_REV_LINEHAUL_CHARGE,
  NULL AS FRT_REV_STOP_CHARGE,
  NULL AS FRT_REV_ACCESSORIAL_CHARGE,
  NULL AS MARGIN,
  TOTAL_COST AS TOTAL_COST,
  NULL AS INCOTERM_ID,
  ORDER_QTY AS ORDER_QTY,
  NULL AS QTY_UOM_ID,
  NULL AS REF_SHIPMENT_NBR,
  NULL AS STAGING_LOCN_ID,
  NULL AS LOADING_SEQ_ORD,
  NULL AS HAZMAT_CERT_CONTACT,
  NULL AS HAZMAT_CERT_DECLARATION,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  EXP_TGT_14""")

# COMMAND ----------
#Post session variable updation
updateVariable(postVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Shipment")

# COMMAND ----------
#Update Mapping Variables in database.
persistVariables(variablesTableName, "m_OMS_Shipment", mainWorkflowId, parentName)
