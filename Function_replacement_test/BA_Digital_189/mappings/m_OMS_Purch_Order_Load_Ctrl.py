# Databricks notebook source
# MAGIC %run "./udf_informatica"

# COMMAND ----------


from pyspark.sql.types import *

spark.sql("use DELTA_TRAINING")
spark.sql("set spark.sql.legacy.timeParserPolicy = LEGACY")

# COMMAND ----------
%run ../WorkflowUtility

# COMMAND ----------
mainWorkflowId = dbutils.widgets.get("mainWorkflowId")
mainWorkflowRunId = dbutils.widgets.get("mainWorkflowRunId")
parentName = dbutils.widgets.get("parentName")
preVariableAssignment = dbutils.widgets.get("preVariableAssignment")
postVariableAssignment = dbutils.widgets.get("postVariableAssignment")
truncTargetTableOptions = dbutils.widgets.get("truncTargetTableOptions")
variablesTableName = dbutils.widgets.get("variablesTableName")

# COMMAND ----------
#Truncate Target Tables
truncateTargetTables(truncTargetTableOptions)

# COMMAND ----------
#Pre presession variable updation
updateVariable(preVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Purch_Order_Load_Ctrl")

# COMMAND ----------
fetchAndCreateVariables(parentName,"m_OMS_Purch_Order_Load_Ctrl", variablesTableName, mainWorkflowId)

# COMMAND ----------
# DBTITLE 1, SP_TRUNC_PROD_TABLES


Stored Procedure Transformation not supported

# COMMAND ----------
# DBTITLE 1, SP_ANALYZE_ANY_TABLE


Stored Procedure Transformation not supported

# COMMAND ----------
# DBTITLE 1, Shortcut_to_A_INVOICE_LINE_0


query_0 = f"""SELECT
  INVOICE_LINE_ID AS INVOICE_LINE_ID,
  INVOICE_LINE_NUMBER AS INVOICE_LINE_NUMBER,
  INVOICE_ID AS INVOICE_ID,
  ENTITY_LINE_NUMBER AS ENTITY_LINE_NUMBER,
  ORDERED_ITEM_UOM_ID AS ORDERED_ITEM_UOM_ID,
  ORDERED_QTY AS ORDERED_QTY,
  INVOICED_QTY AS INVOICED_QTY,
  UNIT_PRICE AS UNIT_PRICE,
  LINE_CHARGE AS LINE_CHARGE,
  LINE_DISCOUNT AS LINE_DISCOUNT,
  LINE_TAX AS LINE_TAX,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  ORDER_LINE_ID AS ORDER_LINE_ID,
  ITEM_ID AS ITEM_ID,
  RETURN_ORDER_LINE_ID AS RETURN_ORDER_LINE_ID,
  RETURN_ORDER_LINE_NUMBER AS RETURN_ORDER_LINE_NUMBER,
  RETURN_TYPE AS RETURN_TYPE,
  IS_TAX_INCLUDED AS IS_TAX_INCLUDED,
  SHIPPED_QUANTITY AS SHIPPED_QUANTITY,
  SHIPPED_ITEM_ID AS SHIPPED_ITEM_ID,
  ORDERED_ITEM_ID AS ORDERED_ITEM_ID,
  SHIPPED_ITEM_UOM_ID AS SHIPPED_ITEM_UOM_ID
FROM
  A_INVOICE_LINE"""

df_0 = spark.sql(query_0)

df_0.createOrReplaceTempView("Shortcut_to_A_INVOICE_LINE_0")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_A_INVOICE_1


query_1 = f"""SELECT
  INVOICE_ID AS INVOICE_ID,
  INVOICE_NUMBER AS INVOICE_NUMBER,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  INVOICE_CREATION_DTTM AS INVOICE_CREATION_DTTM,
  ENTITY_TYPE AS ENTITY_TYPE,
  ENTITY_ID AS ENTITY_ID,
  INVOICE_TYPE AS INVOICE_TYPE,
  CURRENCY AS CURRENCY,
  HEADER_TAX AS HEADER_TAX,
  HEADER_CHARGE AS HEADER_CHARGE,
  HEADER_DISCOUNT AS HEADER_DISCOUNT,
  INVOICE_AMOUNT AS INVOICE_AMOUNT,
  STATUS AS STATUS,
  SHIPMENT_NUMBER AS SHIPMENT_NUMBER,
  INVOICE_AMOUNT_PROCESSED AS INVOICE_AMOUNT_PROCESSED,
  COLLECTED_EXTERNALLY AS COLLECTED_EXTERNALLY,
  ENTITY_NUMBER AS ENTITY_NUMBER,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  RETURN_ORDER_ID AS RETURN_ORDER_ID,
  RETURN_ORDER_NUMBER AS RETURN_ORDER_NUMBER,
  IS_PUBLISHED AS IS_PUBLISHED,
  C_INITIAL_IS_PUBLISHED AS C_INITIAL_IS_PUBLISHED,
  FACILITY_ID AS FACILITY_ID,
  PARTIALLY_SETTLED AS PARTIALLY_SETTLED
FROM
  A_INVOICE"""

df_1 = spark.sql(query_1)

df_1.createOrReplaceTempView("Shortcut_to_A_INVOICE_1")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_PURCHASE_ORDERS_LINE_ITEM_2


query_2 = f"""SELECT
  PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  BUSINESS_PARTNER_ID AS BUSINESS_PARTNER_ID,
  EXT_SYS_LINE_ITEM_ID AS EXT_SYS_LINE_ITEM_ID,
  DESCRIPTION AS DESCRIPTION,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  D_FACILITY_ID AS D_FACILITY_ID,
  D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  D_NAME AS D_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  D_ADDRESS_1 AS D_ADDRESS_1,
  D_ADDRESS_2 AS D_ADDRESS_2,
  D_ADDRESS_3 AS D_ADDRESS_3,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CODE AS D_POSTAL_CODE,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CODE AS D_COUNTRY_CODE,
  D_PHONE_NUMBER AS D_PHONE_NUMBER,
  D_FAX_NUMBER AS D_FAX_NUMBER,
  D_EMAIL AS D_EMAIL,
  BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  BILL_FACILITY_ID AS BILL_FACILITY_ID,
  BILL_TO_ADDRESS_1 AS BILL_TO_ADDRESS_1,
  BILL_TO_ADDRESS_2 AS BILL_TO_ADDRESS_2,
  BILL_TO_ADDRESS_3 AS BILL_TO_ADDRESS_3,
  BILL_TO_CITY AS BILL_TO_CITY,
  BILL_TO_STATE_PROV AS BILL_TO_STATE_PROV,
  BILL_TO_COUNTY AS BILL_TO_COUNTY,
  BILL_TO_POSTAL_CODE AS BILL_TO_POSTAL_CODE,
  BILL_TO_COUNTRY_CODE AS BILL_TO_COUNTRY_CODE,
  BILL_TO_PHONE_NUMBER AS BILL_TO_PHONE_NUMBER,
  BILL_TO_FAX_NUMBER AS BILL_TO_FAX_NUMBER,
  BILL_TO_EMAIL AS BILL_TO_EMAIL,
  STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  STORE_FACILITY_ID AS STORE_FACILITY_ID,
  SKU_ID AS SKU_ID,
  SKU AS SKU,
  SKU_GTIN AS SKU_GTIN,
  SKU_SUB_CODE_ID AS SKU_SUB_CODE_ID,
  SKU_SUB_CODE_VALUE AS SKU_SUB_CODE_VALUE,
  SKU_ATTR_1 AS SKU_ATTR_1,
  SKU_ATTR_2 AS SKU_ATTR_2,
  SKU_ATTR_3 AS SKU_ATTR_3,
  SKU_ATTR_4 AS SKU_ATTR_4,
  SKU_ATTR_5 AS SKU_ATTR_5,
  ORIG_BUDG_COST AS ORIG_BUDG_COST,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  UN_NUMBER_ID AS UN_NUMBER_ID,
  EPC_TRACKING_RFID_VALUE AS EPC_TRACKING_RFID_VALUE,
  PROD_SCHED_REF_NUMBER AS PROD_SCHED_REF_NUMBER,
  PICKUP_REFERENCE_NUMBER AS PICKUP_REFERENCE_NUMBER,
  DELIVERY_REFERENCE_NUMBER AS DELIVERY_REFERENCE_NUMBER,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  PACKAGE_TYPE_ID AS PACKAGE_TYPE_ID,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DSG_SERVICE_LEVEL_ID AS DSG_SERVICE_LEVEL_ID,
  TOTAL_SIZE_ON_ORDERS AS TOTAL_SIZE_ON_ORDERS,
  STD_INBD_LPN_QTY AS STD_INBD_LPN_QTY,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  PPACK_QTY AS PPACK_QTY,
  STD_PACK_QTY AS STD_PACK_QTY,
  STD_LPN_QTY AS STD_LPN_QTY,
  STD_SUB_PACK_QTY AS STD_SUB_PACK_QTY,
  STD_BUNDL_QTY AS STD_BUNDL_QTY,
  STD_PLT_QTY AS STD_PLT_QTY,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  COMM_DLVR_DTTM AS COMM_DLVR_DTTM,
  COMM_SHIP_DTTM AS COMM_SHIP_DTTM,
  PROMISED_DLVR_DTTM AS PROMISED_DLVR_DTTM,
  SHIP_BY_DATE AS SHIP_BY_DATE,
  IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  IS_HAZMAT AS IS_HAZMAT,
  IS_CANCELLED AS IS_CANCELLED,
  IS_CLOSED AS IS_CLOSED,
  IS_BONDED AS IS_BONDED,
  IS_DELETED AS IS_DELETED,
  HAS_ERRORS AS HAS_ERRORS,
  IS_FLOWTHROU AS IS_FLOWTHROU,
  IS_NEVER_OUT AS IS_NEVER_OUT,
  IS_QUANTITY_LOCKED AS IS_QUANTITY_LOCKED,
  IS_VARIABLE_WEIGHT AS IS_VARIABLE_WEIGHT,
  HAS_ROUTING_REQUEST AS HAS_ROUTING_REQUEST,
  ALLOW_SUBSTITUTION AS ALLOW_SUBSTITUTION,
  EXPIRE_DATE_REQD AS EXPIRE_DATE_REQD,
  APPLY_PROMOTIONAL AS APPLY_PROMOTIONAL,
  PRE_PACK_FLAG AS PRE_PACK_FLAG,
  PROCESS_FLAG AS PROCESS_FLAG,
  ON_HOLD AS ON_HOLD,
  IS_ASSOCIATED_TO_OUTBOUND AS IS_ASSOCIATED_TO_OUTBOUND,
  MV_SIZE_UOM_ID AS MV_SIZE_UOM_ID,
  QTY_UOM_ID_BASE AS QTY_UOM_ID_BASE,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  INVN_TYPE AS INVN_TYPE,
  PROD_STAT AS PROD_STAT,
  BATCH_NBR AS BATCH_NBR,
  CNTRY_OF_ORGN AS CNTRY_OF_ORGN,
  PPACK_GRP_CODE AS PPACK_GRP_CODE,
  ASSORT_NBR AS ASSORT_NBR,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  MERCH_TYPE AS MERCH_TYPE,
  MERCH_GRP AS MERCH_GRP,
  STORE_DEPT AS STORE_DEPT,
  SHELF_DAYS AS SHELF_DAYS,
  FRT_CLASS AS FRT_CLASS,
  GROUP_ID AS GROUP_ID,
  SUB_GROUP_ID AS SUB_GROUP_ID,
  ALLOC_TMPL_ID AS ALLOC_TMPL_ID,
  RELEASE_TMPL_ID AS RELEASE_TMPL_ID,
  WORKFLOW_ID AS WORKFLOW_ID,
  VARIANT_VALUE AS VARIANT_VALUE,
  PROCESS_TYPE AS PROCESS_TYPE,
  PRIORITY AS PRIORITY,
  STD_INBD_LPN_VOL AS STD_INBD_LPN_VOL,
  STD_INBD_LPN_WT AS STD_INBD_LPN_WT,
  OUTBD_LPN_BRK_ATTRIB AS OUTBD_LPN_BRK_ATTRIB,
  DOM_ORDER_LINE_STATUS AS DOM_ORDER_LINE_STATUS,
  EFFECTIVE_RANK AS EFFECTIVE_RANK,
  ORIG_ORD_LINE_NBR AS ORIG_ORD_LINE_NBR,
  SO_LN_FULFILL_OPTION AS SO_LN_FULFILL_OPTION,
  SUPPLY_ASN_DTL_ID AS SUPPLY_ASN_DTL_ID,
  SUPPLY_ASN_ID AS SUPPLY_ASN_ID,
  SUPPLY_PO_ID AS SUPPLY_PO_ID,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  ACTUAL_COST AS ACTUAL_COST,
  ACTUAL_CURRENCY_CODE AS ACTUAL_CURRENCY_CODE,
  BUDGETED_COST AS BUDGETED_COST,
  BUDGETED_COST_CURRENCY_CODE AS BUDGETED_COST_CURRENCY_CODE,
  DSG_MOT_ID AS DSG_MOT_ID,
  EXPIRE_DTTM AS EXPIRE_DTTM,
  IS_LOCKED AS IS_LOCKED,
  INBD_LPN_ID AS INBD_LPN_ID,
  INBD_LPNS_RCVD AS INBD_LPNS_RCVD,
  NET_NEEDS AS NET_NEEDS,
  OUTBD_LPN_EPC_TYPE AS OUTBD_LPN_EPC_TYPE,
  OUTBD_LPN_SIZE AS OUTBD_LPN_SIZE,
  OUTBD_LPN_TYPE AS OUTBD_LPN_TYPE,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DSG_CARRIER_CODE AS DSG_CARRIER_CODE,
  LPN_SIZE AS LPN_SIZE,
  ORDER_CONSOL_ATTR AS ORDER_CONSOL_ATTR,
  PROC_IMMD_NEEDS AS PROC_IMMD_NEEDS,
  MFG_PLANT AS MFG_PLANT,
  MFG_DATE AS MFG_DATE,
  PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  STACK_LENGTH_VALUE AS STACK_LENGTH_VALUE,
  STACK_LENGTH_STANDARD_UOM AS STACK_LENGTH_STANDARD_UOM,
  STACK_WIDTH_VALUE AS STACK_WIDTH_VALUE,
  STACK_WIDTH_STANDARD_UOM AS STACK_WIDTH_STANDARD_UOM,
  STACK_HEIGHT_VALUE AS STACK_HEIGHT_VALUE,
  STACK_HEIGHT_STANDARD_UOM AS STACK_HEIGHT_STANDARD_UOM,
  STACK_DIAMETER_VALUE AS STACK_DIAMETER_VALUE,
  STACK_DIAMETER_STANDARD_UOM AS STACK_DIAMETER_STANDARD_UOM,
  COMMODITY_CLASS AS COMMODITY_CLASS,
  TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DOM_SUB_SKU_ID AS DOM_SUB_SKU_ID,
  SUPPLY_CONS_PO_ID AS SUPPLY_CONS_PO_ID,
  SUPPLY_PO_LINE_ID AS SUPPLY_PO_LINE_ID,
  PARENT_PO_LINE_ITEM_ID AS PARENT_PO_LINE_ITEM_ID,
  PARENT_TC_PO_LINE_ID AS PARENT_TC_PO_LINE_ID,
  ROOT_LINE_ITEM_ID AS ROOT_LINE_ITEM_ID,
  ORDER_QTY AS ORDER_QTY,
  WF_NODE_ID AS WF_NODE_ID,
  WF_PROCESS_STATE AS WF_PROCESS_STATE,
  ALLOC_FINALIZER AS ALLOC_FINALIZER,
  QTY_UOM_ID AS QTY_UOM_ID,
  INVENTORY_SEGMENT_ID AS INVENTORY_SEGMENT_ID,
  CUST_SKU AS CUST_SKU,
  PLT_TYPE AS PLT_TYPE,
  PACKAGE_TYPE_INSTANCE AS PACKAGE_TYPE_INSTANCE,
  ACCEPTED_DTTM AS ACCEPTED_DTTM,
  IS_DO_CREATED AS IS_DO_CREATED,
  RECEIVED_WEIGHT AS RECEIVED_WEIGHT,
  PACKED_SIZE_VALUE AS PACKED_SIZE_VALUE,
  PLANNED_WEIGHT AS PLANNED_WEIGHT,
  SHIPPED_WEIGHT AS SHIPPED_WEIGHT,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  WEIGHT_UOM_ID AS WEIGHT_UOM_ID,
  PLANNED_VOLUME AS PLANNED_VOLUME,
  RECEIVED_VOLUME AS RECEIVED_VOLUME,
  SHIPPED_VOLUME AS SHIPPED_VOLUME,
  VOLUME_UOM_ID_BASE AS VOLUME_UOM_ID_BASE,
  VOLUME_UOM_ID AS VOLUME_UOM_ID,
  SIZE1_UOM_ID AS SIZE1_UOM_ID,
  SIZE1_VALUE AS SIZE1_VALUE,
  RECEIVED_SIZE1 AS RECEIVED_SIZE1,
  SHIPPED_SIZE1 AS SHIPPED_SIZE1,
  SIZE2_UOM_ID AS SIZE2_UOM_ID,
  SIZE2_VALUE AS SIZE2_VALUE,
  RECEIVED_SIZE2 AS RECEIVED_SIZE2,
  SHIPPED_SIZE2 AS SHIPPED_SIZE2,
  QTY_CONV_FACTOR AS QTY_CONV_FACTOR,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RETAIL_PRICE AS RETAIL_PRICE,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  LINE_TOTAL AS LINE_TOTAL,
  IS_GIFT AS IS_GIFT,
  ADDR_VALID AS ADDR_VALID,
  REASON_ID AS REASON_ID,
  HAS_CHILD AS HAS_CHILD,
  NEW_LINE_TYPE AS NEW_LINE_TYPE,
  REQ_CAPACITY_PER_UNIT AS REQ_CAPACITY_PER_UNIT,
  MERGE_FACILITY AS MERGE_FACILITY,
  MERGE_FACILITY_ALIAS_ID AS MERGE_FACILITY_ALIAS_ID,
  ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  REF_FIELD_1 AS REF_FIELD_1,
  REF_FIELD_2 AS REF_FIELD_2,
  REF_FIELD_3 AS REF_FIELD_3,
  IS_RETURNABLE AS IS_RETURNABLE,
  BACK_ORD_REASON AS BACK_ORD_REASON,
  FREIGHT_REVENUE_CURRENCY_CODE AS FREIGHT_REVENUE_CURRENCY_CODE,
  FREIGHT_REVENUE AS FREIGHT_REVENUE,
  PRICE_OVERRIDE AS PRICE_OVERRIDE,
  ORIGINAL_PRICE AS ORIGINAL_PRICE,
  EXT_CREATED_DTTM AS EXT_CREATED_DTTM,
  REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  OVER_SHIP_PCT AS OVER_SHIP_PCT,
  IS_EXCHANGEABLE AS IS_EXCHANGEABLE,
  ORIGINAL_PO_LINE_ITEM_ID AS ORIGINAL_PO_LINE_ITEM_ID,
  RMA_LINE_STATUS AS RMA_LINE_STATUS,
  OVER_PACK_PCT AS OVER_PACK_PCT,
  ALLOW_RESIDUAL_PACK AS ALLOW_RESIDUAL_PACK,
  HAS_COMP_ITEM AS HAS_COMP_ITEM,
  INV_DISPOSITION AS INV_DISPOSITION,
  EXT_PLAN_ID AS EXT_PLAN_ID,
  TAX_INCLUDED AS TAX_INCLUDED,
  RETURN_ACTION_TYPE AS RETURN_ACTION_TYPE,
  REF_FIELD4 AS REF_FIELD4,
  REF_FIELD5 AS REF_FIELD5,
  REF_FIELD6 AS REF_FIELD6,
  REF_FIELD7 AS REF_FIELD7,
  REF_FIELD8 AS REF_FIELD8,
  REF_FIELD9 AS REF_FIELD9,
  REF_FIELD10 AS REF_FIELD10,
  REF_NUM1 AS REF_NUM1,
  REF_NUM2 AS REF_NUM2,
  REF_NUM3 AS REF_NUM3,
  REF_NUM4 AS REF_NUM4,
  REF_NUM5 AS REF_NUM5,
  REF_BOOLEAN1 AS REF_BOOLEAN1,
  REF_BOOLEAN2 AS REF_BOOLEAN2,
  REF_SYSCODE1 AS REF_SYSCODE1,
  REF_SYSCODE2 AS REF_SYSCODE2,
  REF_SYSCODE3 AS REF_SYSCODE3
FROM
  PURCHASE_ORDERS_LINE_ITEM"""

df_2 = spark.sql(query_2)

df_2.createOrReplaceTempView("Shortcut_to_PURCHASE_ORDERS_LINE_ITEM_2")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_ORDERS_3


query_3 = f"""SELECT
  ORDER_ID AS ORDER_ID,
  TC_ORDER_ID AS TC_ORDER_ID,
  TC_ORDER_ID_U AS TC_ORDER_ID_U,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  CREATION_TYPE AS CREATION_TYPE,
  BUSINESS_PARTNER_ID AS BUSINESS_PARTNER_ID,
  PARENT_ORDER_ID AS PARENT_ORDER_ID,
  EXT_PURCHASE_ORDER AS EXT_PURCHASE_ORDER,
  CONS_RUN_ID AS CONS_RUN_ID,
  O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_DOCK_ID AS O_DOCK_ID,
  O_ADDRESS_1 AS O_ADDRESS_1,
  O_ADDRESS_2 AS O_ADDRESS_2,
  O_ADDRESS_3 AS O_ADDRESS_3,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CODE AS O_POSTAL_CODE,
  O_COUNTY AS O_COUNTY,
  O_COUNTRY_CODE AS O_COUNTRY_CODE,
  D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  D_FACILITY_ID AS D_FACILITY_ID,
  D_DOCK_ID AS D_DOCK_ID,
  D_ADDRESS_1 AS D_ADDRESS_1,
  D_ADDRESS_2 AS D_ADDRESS_2,
  D_ADDRESS_3 AS D_ADDRESS_3,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CODE AS D_POSTAL_CODE,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CODE AS D_COUNTRY_CODE,
  BILL_TO_NAME AS BILL_TO_NAME,
  BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  BILL_FACILITY_ID AS BILL_FACILITY_ID,
  BILL_TO_ADDRESS_1 AS BILL_TO_ADDRESS_1,
  BILL_TO_ADDRESS_2 AS BILL_TO_ADDRESS_2,
  BILL_TO_ADDRESS_3 AS BILL_TO_ADDRESS_3,
  BILL_TO_CITY AS BILL_TO_CITY,
  BILL_TO_STATE_PROV AS BILL_TO_STATE_PROV,
  BILL_TO_COUNTY AS BILL_TO_COUNTY,
  BILL_TO_POSTAL_CODE AS BILL_TO_POSTAL_CODE,
  BILL_TO_COUNTRY_CODE AS BILL_TO_COUNTRY_CODE,
  BILL_TO_PHONE_NUMBER AS BILL_TO_PHONE_NUMBER,
  BILL_TO_FAX_NUMBER AS BILL_TO_FAX_NUMBER,
  BILL_TO_EMAIL AS BILL_TO_EMAIL,
  PLAN_O_FACILITY_ID AS PLAN_O_FACILITY_ID,
  PLAN_D_FACILITY_ID AS PLAN_D_FACILITY_ID,
  PLAN_O_FACILITY_ALIAS_ID AS PLAN_O_FACILITY_ALIAS_ID,
  PLAN_D_FACILITY_ALIAS_ID AS PLAN_D_FACILITY_ALIAS_ID,
  PLAN_LEG_D_ALIAS_ID AS PLAN_LEG_D_ALIAS_ID,
  PLAN_LEG_O_ALIAS_ID AS PLAN_LEG_O_ALIAS_ID,
  INCOTERM_FACILITY_ID AS INCOTERM_FACILITY_ID,
  INCOTERM_FACILITY_ALIAS_ID AS INCOTERM_FACILITY_ALIAS_ID,
  INCOTERM_LOC_AVA_DTTM AS INCOTERM_LOC_AVA_DTTM,
  INCOTERM_LOC_AVA_TIME_ZONE_ID AS INCOTERM_LOC_AVA_TIME_ZONE_ID,
  PICKUP_TZ AS PICKUP_TZ,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  ORDER_DATE_DTTM AS ORDER_DATE_DTTM,
  ORDER_RECON_DTTM AS ORDER_RECON_DTTM,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  DSG_SERVICE_LEVEL_ID AS DSG_SERVICE_LEVEL_ID,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DSG_EQUIPMENT_ID AS DSG_EQUIPMENT_ID,
  DSG_TRACTOR_EQUIPMENT_ID AS DSG_TRACTOR_EQUIPMENT_ID,
  DSG_MOT_ID AS DSG_MOT_ID,
  BASELINE_MOT_ID AS BASELINE_MOT_ID,
  BASELINE_SERVICE_LEVEL_ID AS BASELINE_SERVICE_LEVEL_ID,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  WAVE_ID AS WAVE_ID,
  WAVE_OPTION_ID AS WAVE_OPTION_ID,
  PATH_ID AS PATH_ID,
  PATH_SET_ID AS PATH_SET_ID,
  DRIVER_TYPE_ID AS DRIVER_TYPE_ID,
  UN_NUMBER_ID AS UN_NUMBER_ID,
  BLOCK_AUTO_CREATE AS BLOCK_AUTO_CREATE,
  BLOCK_AUTO_CONSOLIDATE AS BLOCK_AUTO_CONSOLIDATE,
  HAS_ALERTS AS HAS_ALERTS,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_NOTES AS HAS_NOTES,
  HAS_SOFT_CHECK_ERRORS AS HAS_SOFT_CHECK_ERRORS,
  HAS_SPLIT AS HAS_SPLIT,
  IS_BOOKING_REQUIRED AS IS_BOOKING_REQUIRED,
  IS_CANCELLED AS IS_CANCELLED,
  IS_HAZMAT AS IS_HAZMAT,
  IS_IMPORTED AS IS_IMPORTED,
  IS_PARTIALLY_PLANNED AS IS_PARTIALLY_PLANNED,
  IS_PERISHABLE AS IS_PERISHABLE,
  IS_SUSPENDED AS IS_SUSPENDED,
  NORMALIZED_BASELINE_COST AS NORMALIZED_BASELINE_COST,
  BASELINE_COST_CURRENCY_CODE AS BASELINE_COST_CURRENCY_CODE,
  ORIG_BUDG_COST AS ORIG_BUDG_COST,
  BUDG_COST AS BUDG_COST,
  ACTUAL_COST AS ACTUAL_COST,
  BASELINE_COST AS BASELINE_COST,
  TRANS_RESP_CODE AS TRANS_RESP_CODE,
  BILLING_METHOD AS BILLING_METHOD,
  DROPOFF_PICKUP AS DROPOFF_PICKUP,
  MOVEMENT_OPTION AS MOVEMENT_OPTION,
  PRIORITY AS PRIORITY,
  MOVE_TYPE AS MOVE_TYPE,
  SCHED_DOW AS SCHED_DOW,
  EQUIPMENT_TYPE AS EQUIPMENT_TYPE,
  DELIVERY_REQ AS DELIVERY_REQ,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  MONETARY_VALUE AS MONETARY_VALUE,
  COMPARTMENT_NO AS COMPARTMENT_NO,
  PACKAGING AS PACKAGING,
  ORDER_LOADING_SEQ AS ORDER_LOADING_SEQ,
  REF_FIELD_1 AS REF_FIELD_1,
  REF_FIELD_2 AS REF_FIELD_2,
  REF_FIELD_3 AS REF_FIELD_3,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  ACTUAL_COST_CURRENCY_CODE AS ACTUAL_COST_CURRENCY_CODE,
  BUDG_COST_CURRENCY_CODE AS BUDG_COST_CURRENCY_CODE,
  SHIPMENT_ID AS SHIPMENT_ID,
  BILL_TO_TITLE AS BILL_TO_TITLE,
  ORDER_STATUS AS ORDER_STATUS,
  ADDR_CODE AS ADDR_CODE,
  ADDR_VALID AS ADDR_VALID,
  ADVT_DATE AS ADVT_DATE,
  CHUTE_ID AS CHUTE_ID,
  COD_FUNDS AS COD_FUNDS,
  DC_CTR_NBR AS DC_CTR_NBR,
  DO_STATUS AS DO_STATUS,
  DO_TYPE AS DO_TYPE,
  DOCS_ONLY_SHPMT AS DOCS_ONLY_SHPMT,
  DUTY_AND_TAX AS DUTY_AND_TAX,
  DUTY_TAX_ACCT_NBR AS DUTY_TAX_ACCT_NBR,
  DUTY_TAX_PAYMENT_TYPE AS DUTY_TAX_PAYMENT_TYPE,
  EST_LPN AS EST_LPN,
  EST_LPN_BRIDGED AS EST_LPN_BRIDGED,
  FTSR_NBR AS FTSR_NBR,
  IS_BACK_ORDERED AS IS_BACK_ORDERED,
  LPN_CUBING_INDIC AS LPN_CUBING_INDIC,
  O_PHONE_NUMBER AS O_PHONE_NUMBER,
  ORDER_PRINT_DTTM AS ORDER_PRINT_DTTM,
  PALLET_CUBING_INDIC AS PALLET_CUBING_INDIC,
  PRE_PACK_FLAG AS PRE_PACK_FLAG,
  RTE_TYPE_1 AS RTE_TYPE_1,
  RTE_TYPE_2 AS RTE_TYPE_2,
  SHIP_GROUP_SEQUENCE AS SHIP_GROUP_SEQUENCE,
  SHPNG_CHRG AS SHPNG_CHRG,
  STAGE_INDIC AS STAGE_INDIC,
  STORE_NBR AS STORE_NBR,
  TOTAL_NBR_OF_LPN AS TOTAL_NBR_OF_LPN,
  TOTAL_NBR_OF_PLT AS TOTAL_NBR_OF_PLT,
  WM_ORDER_STATUS AS WM_ORDER_STATUS,
  D_NAME AS D_NAME,
  O_CONTACT AS O_CONTACT,
  SECONDARY_MAXI_ADDR_NBR AS SECONDARY_MAXI_ADDR_NBR,
  D_CONTACT AS D_CONTACT,
  AES_ITN AS AES_ITN,
  BATCH_ID AS BATCH_ID,
  ORIGIN_SHIP_THRU_FACILITY_ID AS ORIGIN_SHIP_THRU_FACILITY_ID,
  ORIGIN_SHIP_THRU_FAC_ALIAS_ID AS ORIGIN_SHIP_THRU_FAC_ALIAS_ID,
  DEST_SHIP_THRU_FACILITY_ID AS DEST_SHIP_THRU_FACILITY_ID,
  DEST_SHIP_THRU_FAC_ALIAS_ID AS DEST_SHIP_THRU_FAC_ALIAS_ID,
  ACTUAL_SHIPPED_DTTM AS ACTUAL_SHIPPED_DTTM,
  BILL_OF_LADING_NUMBER AS BILL_OF_LADING_NUMBER,
  BOL_BREAK_ATTR AS BOL_BREAK_ATTR,
  D_EMAIL AS D_EMAIL,
  D_FAX_NUMBER AS D_FAX_NUMBER,
  D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DYNAMIC_ROUTING_REQD AS DYNAMIC_ROUTING_REQD,
  INTL_GOODS_DESC AS INTL_GOODS_DESC,
  MAJOR_ORDER_GRP_ATTR AS MAJOR_ORDER_GRP_ATTR,
  ORDER_CONSOL_PROFILE AS ORDER_CONSOL_PROFILE,
  PACK_SLIP_PRT_CNT AS PACK_SLIP_PRT_CNT,
  PROD_SCHED_REF_NUMBER AS PROD_SCHED_REF_NUMBER,
  MUST_RELEASE_BY_DTTM AS MUST_RELEASE_BY_DTTM,
  CANCEL_DTTM AS CANCEL_DTTM,
  ASSIGNED_STATIC_ROUTE_ID AS ASSIGNED_STATIC_ROUTE_ID,
  DSG_STATIC_ROUTE_ID AS DSG_STATIC_ROUTE_ID,
  O_FACILITY_NAME AS O_FACILITY_NAME,
  O_DOCK_DOOR_ID AS O_DOCK_DOOR_ID,
  O_FAX_NUMBER AS O_FAX_NUMBER,
  O_EMAIL AS O_EMAIL,
  D_FACILITY_NAME AS D_FACILITY_NAME,
  D_DOCK_DOOR_ID AS D_DOCK_DOOR_ID,
  PURCHASE_ORDER_NUMBER AS PURCHASE_ORDER_NUMBER,
  CUSTOMER_ID AS CUSTOMER_ID,
  REPL_WAVE_NBR AS REPL_WAVE_NBR,
  CUBING_STATUS AS CUBING_STATUS,
  SCHED_PICKUP_DTTM AS SCHED_PICKUP_DTTM,
  SCHED_DELIVERY_DTTM AS SCHED_DELIVERY_DTTM,
  ZONE_SKIP_HUB_LOCATION_ID AS ZONE_SKIP_HUB_LOCATION_ID,
  BILL_TO_FACILITY_NAME AS BILL_TO_FACILITY_NAME,
  FREIGHT_CLASS AS FREIGHT_CLASS,
  NON_MACHINEABLE AS NON_MACHINEABLE,
  ASSIGNED_MOT_ID AS ASSIGNED_MOT_ID,
  ASSIGNED_CARRIER_ID AS ASSIGNED_CARRIER_ID,
  ASSIGNED_SERVICE_LEVEL_ID AS ASSIGNED_SERVICE_LEVEL_ID,
  ASSIGNED_EQUIPMENT_ID AS ASSIGNED_EQUIPMENT_ID,
  DYNAMIC_REQUEST_SENT AS DYNAMIC_REQUEST_SENT,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  TC_SHIPMENT_ID AS TC_SHIPMENT_ID,
  IN_TRANSIT_ALLOCATION AS IN_TRANSIT_ALLOCATION,
  RELEASE_DESTINATION AS RELEASE_DESTINATION,
  TEMPLATE_ID AS TEMPLATE_ID,
  COD_AMOUNT AS COD_AMOUNT,
  BILL_TO_CONTACT_NAME AS BILL_TO_CONTACT_NAME,
  SHIP_GROUP_ID AS SHIP_GROUP_ID,
  PURCHASE_ORDER_ID AS PURCHASE_ORDER_ID,
  DSG_HUB_LOCATION_ID AS DSG_HUB_LOCATION_ID,
  OVERRIDE_BILLING_METHOD AS OVERRIDE_BILLING_METHOD,
  PARENT_TYPE AS PARENT_TYPE,
  ACCT_RCVBL_CODE AS ACCT_RCVBL_CODE,
  ADVT_CODE AS ADVT_CODE,
  IS_CUSTOMER_PICKUP AS IS_CUSTOMER_PICKUP,
  IS_DIRECT_ALLOWED AS IS_DIRECT_ALLOWED,
  RTE_ATTR AS RTE_ATTR,
  LAST_RUN_ID AS LAST_RUN_ID,
  PLAN_DUE_DTTM AS PLAN_DUE_DTTM,
  IS_ORDER_RECONCILED AS IS_ORDER_RECONCILED,
  PRTL_SHIP_CONF_FLAG AS PRTL_SHIP_CONF_FLAG,
  PRTL_SHIP_CONF_STATUS AS PRTL_SHIP_CONF_STATUS,
  ALLOW_PRE_BILLING AS ALLOW_PRE_BILLING,
  LANE_NAME AS LANE_NAME,
  DECLARED_VALUE AS DECLARED_VALUE,
  DV_CURRENCY_CODE AS DV_CURRENCY_CODE,
  COD_CURRENCY_CODE AS COD_CURRENCY_CODE,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  LINE_HAUL_SHIP_VIA AS LINE_HAUL_SHIP_VIA,
  ORIGINAL_ASSIGNED_SHIP_VIA AS ORIGINAL_ASSIGNED_SHIP_VIA,
  DISTRIBUTION_SHIP_VIA AS DISTRIBUTION_SHIP_VIA,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  TAX_ID AS TAX_ID,
  ORDER_RECEIVED AS ORDER_RECEIVED,
  IS_ORIGINAL_ORDER AS IS_ORIGINAL_ORDER,
  FREIGHT_FORWARDER_ACCT_NBR AS FREIGHT_FORWARDER_ACCT_NBR,
  GLOBAL_LOCN_NBR AS GLOBAL_LOCN_NBR,
  IMPORTER_DEFN AS IMPORTER_DEFN,
  LANG_ID AS LANG_ID,
  MAJOR_MINOR_ORDER AS MAJOR_MINOR_ORDER,
  MAJOR_ORDER_CTRL_NBR AS MAJOR_ORDER_CTRL_NBR,
  MHE_FLAG AS MHE_FLAG,
  MHE_ORD_STATE AS MHE_ORD_STATE,
  ORDER_CONSOL_LOCN_ID AS ORDER_CONSOL_LOCN_ID,
  ORDER_TYPE AS ORDER_TYPE,
  PACK_WAVE_NBR AS PACK_WAVE_NBR,
  PARTIAL_LPN_OPTION AS PARTIAL_LPN_OPTION,
  PARTIES_RELATED AS PARTIES_RELATED,
  PNH_FLAG AS PNH_FLAG,
  PRE_STICKER_CODE AS PRE_STICKER_CODE,
  PRIMARY_MAXI_ADDR_NBR AS PRIMARY_MAXI_ADDR_NBR,
  RTE_SWC_NBR AS RTE_SWC_NBR,
  RTE_TO AS RTE_TO,
  RTE_WAVE_NBR AS RTE_WAVE_NBR,
  BASELINE_CARRIER_ID AS BASELINE_CARRIER_ID,
  COD_RETURN_COMPANY_NAME AS COD_RETURN_COMPANY_NAME,
  BILL_ACCT_NBR AS BILL_ACCT_NBR,
  CUST_BROKER_ACCT_NBR AS CUST_BROKER_ACCT_NBR,
  MANIFEST_NBR AS MANIFEST_NBR,
  DESTINATION_ACTION AS DESTINATION_ACTION,
  TRANS_PLAN_OWNER AS TRANS_PLAN_OWNER,
  MARK_FOR AS MARK_FOR,
  DELIVERY_OPTIONS AS DELIVERY_OPTIONS,
  PRE_BILL_STATUS AS PRE_BILL_STATUS,
  CONTNT_LABEL_TYPE AS CONTNT_LABEL_TYPE,
  NBR_OF_CONTNT_LABEL AS NBR_OF_CONTNT_LABEL,
  NBR_OF_LABEL AS NBR_OF_LABEL,
  NBR_OF_PAKNG_SLIPS AS NBR_OF_PAKNG_SLIPS,
  PALLET_CONTENT_LABEL_TYPE AS PALLET_CONTENT_LABEL_TYPE,
  LPN_LABEL_TYPE AS LPN_LABEL_TYPE,
  PACK_SLIP_TYPE AS PACK_SLIP_TYPE,
  BOL_TYPE AS BOL_TYPE,
  MANIF_TYPE AS MANIF_TYPE,
  PRINT_CANADIAN_CUST_INVC_FLAG AS PRINT_CANADIAN_CUST_INVC_FLAG,
  PRINT_COO AS PRINT_COO,
  PRINT_DOCK_RCPT_FLAG AS PRINT_DOCK_RCPT_FLAG,
  PRINT_INV AS PRINT_INV,
  PRINT_NAFTA_COO_FLAG AS PRINT_NAFTA_COO_FLAG,
  PRINT_OCEAN_BOL_FLAG AS PRINT_OCEAN_BOL_FLAG,
  PRINT_SED AS PRINT_SED,
  PRINT_SHPR_LTR_OF_INSTR_FLAG AS PRINT_SHPR_LTR_OF_INSTR_FLAG,
  PRINT_PKG_LIST_FLAG AS PRINT_PKG_LIST_FLAG,
  FREIGHT_REVENUE_CURRENCY_CODE AS FREIGHT_REVENUE_CURRENCY_CODE,
  FREIGHT_REVENUE AS FREIGHT_REVENUE,
  TRANS_PLAN_DIRECTION AS TRANS_PLAN_DIRECTION,
  DSG_VOYAGE_FLIGHT AS DSG_VOYAGE_FLIGHT,
  IS_D_POBOX AS IS_D_POBOX,
  REF_SHIPMENT_NBR AS REF_SHIPMENT_NBR,
  REF_STOP_SEQ AS REF_STOP_SEQ,
  HAZ_OFFEROR_NAME AS HAZ_OFFEROR_NAME,
  DISTRO_NUMBER AS DISTRO_NUMBER,
  INCOTERM_ID AS INCOTERM_ID,
  DIRECTION AS DIRECTION,
  ORDER_SHIPMENT_SEQ AS ORDER_SHIPMENT_SEQ,
  MOVEMENT_TYPE AS MOVEMENT_TYPE,
  ACCT_RCVBL_ACCT_NBR AS ACCT_RCVBL_ACCT_NBR,
  REF_FIELD_4 AS REF_FIELD_4,
  REF_FIELD_5 AS REF_FIELD_5,
  REF_FIELD_6 AS REF_FIELD_6,
  REF_FIELD_7 AS REF_FIELD_7,
  REF_FIELD_8 AS REF_FIELD_8,
  REF_FIELD_9 AS REF_FIELD_9,
  REF_FIELD_10 AS REF_FIELD_10,
  FIRST_ZONE AS FIRST_ZONE,
  LAST_ZONE AS LAST_ZONE,
  NBR_OF_ZONES AS NBR_OF_ZONES,
  REF_NUM1 AS REF_NUM1,
  REF_NUM2 AS REF_NUM2,
  REF_NUM3 AS REF_NUM3,
  REF_NUM4 AS REF_NUM4,
  REF_NUM5 AS REF_NUM5,
  SPL_INSTR_CODE_1 AS SPL_INSTR_CODE_1,
  SPL_INSTR_CODE_2 AS SPL_INSTR_CODE_2,
  SPL_INSTR_CODE_3 AS SPL_INSTR_CODE_3,
  SPL_INSTR_CODE_4 AS SPL_INSTR_CODE_4,
  SPL_INSTR_CODE_5 AS SPL_INSTR_CODE_5,
  SPL_INSTR_CODE_6 AS SPL_INSTR_CODE_6,
  SPL_INSTR_CODE_7 AS SPL_INSTR_CODE_7,
  SPL_INSTR_CODE_8 AS SPL_INSTR_CODE_8,
  SPL_INSTR_CODE_9 AS SPL_INSTR_CODE_9,
  SPL_INSTR_CODE_10 AS SPL_INSTR_CODE_10,
  SINGLE_UNIT_FLAG AS SINGLE_UNIT_FLAG,
  TOTAL_NBR_OF_UNITS AS TOTAL_NBR_OF_UNITS,
  IS_ROUTED AS IS_ROUTED,
  DSG_TRAILER_NUMBER AS DSG_TRAILER_NUMBER,
  STAGING_LOCN_ID AS STAGING_LOCN_ID,
  UPSMI_COST_CENTER AS UPSMI_COST_CENTER,
  EST_PALLET_BRIDGED AS EST_PALLET_BRIDGED,
  EST_PALLET AS EST_PALLET,
  PICKLIST_ID AS PICKLIST_ID,
  EFFECTIVE_RANK AS EFFECTIVE_RANK,
  CHASE_ELIGIBLE AS CHASE_ELIGIBLE,
  SHIPPING_CHANNEL AS SHIPPING_CHANNEL,
  IS_GUARANTEED_DELIVERY AS IS_GUARANTEED_DELIVERY,
  FAILED_GUARANTEED_DELIVERY AS FAILED_GUARANTEED_DELIVERY,
  APPLY_LPNTYPE_FOR_ORDER AS APPLY_LPNTYPE_FOR_ORDER,
  PO_TYPE_ATTR AS PO_TYPE_ATTR
FROM
  ORDERS"""

df_3 = spark.sql(query_3)

df_3.createOrReplaceTempView("Shortcut_to_ORDERS_3")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_PURCHASE_ORDERS_4


query_4 = f"""SELECT
  PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  BUSINESS_PARTNER_ID AS BUSINESS_PARTNER_ID,
  CREATION_TYPE AS CREATION_TYPE,
  PURCHASE_ORDERS_TYPE AS PURCHASE_ORDERS_TYPE,
  PURCHASE_ORDERS_STATUS AS PURCHASE_ORDERS_STATUS,
  TC_PURCHASE_ORDERS_ID AS TC_PURCHASE_ORDERS_ID,
  TC_PURCHASE_ORDERS_ID_U AS TC_PURCHASE_ORDERS_ID_U,
  PARENT_PURCHASE_ORDERS_ID AS PARENT_PURCHASE_ORDERS_ID,
  MO_AUTO_CREATE_METHOD AS MO_AUTO_CREATE_METHOD,
  O_FACILITY_ID AS O_FACILITY_ID,
  O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  O_DOCK_ID AS O_DOCK_ID,
  O_NAME AS O_NAME,
  O_ADDRESS_1 AS O_ADDRESS_1,
  O_ADDRESS_2 AS O_ADDRESS_2,
  O_ADDRESS_3 AS O_ADDRESS_3,
  O_CITY AS O_CITY,
  O_STATE_PROV AS O_STATE_PROV,
  O_POSTAL_CODE AS O_POSTAL_CODE,
  O_COUNTY AS O_COUNTY,
  O_COUNTRY_CODE AS O_COUNTRY_CODE,
  D_FACILITY_ID AS D_FACILITY_ID,
  D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  D_DOCK_ID AS D_DOCK_ID,
  D_NAME AS D_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  D_ADDRESS_1 AS D_ADDRESS_1,
  D_ADDRESS_2 AS D_ADDRESS_2,
  D_ADDRESS_3 AS D_ADDRESS_3,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CODE AS D_POSTAL_CODE,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CODE AS D_COUNTRY_CODE,
  D_PHONE_NUMBER AS D_PHONE_NUMBER,
  D_FAX_NUMBER AS D_FAX_NUMBER,
  D_EMAIL AS D_EMAIL,
  BILL_FACILITY_ID AS BILL_FACILITY_ID,
  BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  BILL_TO_WHSE AS BILL_TO_WHSE,
  BILL_TO_NAME AS BILL_TO_NAME,
  BILL_TO_LAST_NAME AS BILL_TO_LAST_NAME,
  BILL_TO_ADDRESS_1 AS BILL_TO_ADDRESS_1,
  BILL_TO_ADDRESS_2 AS BILL_TO_ADDRESS_2,
  BILL_TO_ADDRESS_3 AS BILL_TO_ADDRESS_3,
  BILL_TO_CITY AS BILL_TO_CITY,
  BILL_TO_STATE_PROV AS BILL_TO_STATE_PROV,
  BILL_TO_COUNTY AS BILL_TO_COUNTY,
  BILL_TO_POSTAL_CODE AS BILL_TO_POSTAL_CODE,
  BILL_TO_COUNTRY_CODE AS BILL_TO_COUNTRY_CODE,
  BILL_TO_PHONE_NUMBER AS BILL_TO_PHONE_NUMBER,
  BILL_TO_FAX_NUMBER AS BILL_TO_FAX_NUMBER,
  BILL_TO_EMAIL AS BILL_TO_EMAIL,
  BILL_ACCOUNT_NBR AS BILL_ACCOUNT_NBR,
  ORG_SHIP_VIA_FACILITY_ALIAS_ID AS ORG_SHIP_VIA_FACILITY_ALIAS_ID,
  ORG_SHIP_VIA_FACILITY_ID AS ORG_SHIP_VIA_FACILITY_ID,
  DES_SHIP_VIA_FACILITY_ALIAS_ID AS DES_SHIP_VIA_FACILITY_ALIAS_ID,
  DES_SHIP_VIA_FACILITY_ID AS DES_SHIP_VIA_FACILITY_ID,
  PICKUP_TZ AS PICKUP_TZ,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  REQUESTED_DLVR_DTTM AS REQUESTED_DLVR_DTTM,
  MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  PROMISED_DLVR_DTTM AS PROMISED_DLVR_DTTM,
  DUE_DT AS DUE_DT,
  CANCEL_DT AS CANCEL_DT,
  PURCHASE_ORDERS_DATE_DTTM AS PURCHASE_ORDERS_DATE_DTTM,
  RELEASE_DTTM AS RELEASE_DTTM,
  FIRST_RCPT_DTTM AS FIRST_RCPT_DTTM,
  LAST_RCPT_DTTM AS LAST_RCPT_DTTM,
  BILLING_METHOD AS BILLING_METHOD,
  PAYMENT_MODE AS PAYMENT_MODE,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  MONETARY_VALUE AS MONETARY_VALUE,
  CURRENCY_CODE AS CURRENCY_CODE,
  ORIG_BUDG_COST AS ORIG_BUDG_COST,
  BUDG_COST_CURRENCY_CODE AS BUDG_COST_CURRENCY_CODE,
  BUDG_COST AS BUDG_COST,
  TAX_CHARGES AS TAX_CHARGES,
  MISC_CHARGES AS MISC_CHARGES,
  INCOTERM_FACILITY_ID AS INCOTERM_FACILITY_ID,
  INCOTERM_FACILITY_ALIAS_ID AS INCOTERM_FACILITY_ALIAS_ID,
  INCOTERM_LOC_AVA_DTTM AS INCOTERM_LOC_AVA_DTTM,
  INCOTERM_LOC_AVA_TIME_ZONE_ID AS INCOTERM_LOC_AVA_TIME_ZONE_ID,
  IS_CANCELLED AS IS_CANCELLED,
  IS_IMPORTED AS IS_IMPORTED,
  UPDATE_SENT AS UPDATE_SENT,
  IS_HAZMAT AS IS_HAZMAT,
  IS_PERISHABLE AS IS_PERISHABLE,
  IS_INFO_ONLY AS IS_INFO_ONLY,
  HAS_IMPORT_ERROR AS HAS_IMPORT_ERROR,
  HAS_SOFT_CHECK_ERRORS AS HAS_SOFT_CHECK_ERRORS,
  HAS_NOTES AS HAS_NOTES,
  HAS_ALERTS AS HAS_ALERTS,
  IS_PURCHASE_ORDERS_RECONCILED AS IS_PURCHASE_ORDERS_RECONCILED,
  DELIVERY_REQ AS DELIVERY_REQ,
  IS_ACCEPTANCE_REQUIRED AS IS_ACCEPTANCE_REQUIRED,
  ARE_LEGAL_TERMS_REQUIRED AS ARE_LEGAL_TERMS_REQUIRED,
  IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  IS_CUSTOMER_PICKUP AS IS_CUSTOMER_PICKUP,
  IS_DIRECT_ALLOWED AS IS_DIRECT_ALLOWED,
  IS_PARTIALLY_PLANNED AS IS_PARTIALLY_PLANNED,
  IS_PL_MANUALLY_SET AS IS_PL_MANUALLY_SET,
  IS_LOCKED AS IS_LOCKED,
  IS_PURCHASE_ORDERS_CONFIRMED AS IS_PURCHASE_ORDERS_CONFIRMED,
  HAS_ROUTING_REQUEST AS HAS_ROUTING_REQUEST,
  HAS_EM_NOTIFY_FLAG AS HAS_EM_NOTIFY_FLAG,
  IS_PUTAWAY AS IS_PUTAWAY,
  ALLOW_PARTIAL_SHIPPING AS ALLOW_PARTIAL_SHIPPING,
  ALLOW_ZONE_SKIPPING AS ALLOW_ZONE_SKIPPING,
  SNGL_UNIT_FLAG AS SNGL_UNIT_FLAG,
  PRE_PACK_FLAG AS PRE_PACK_FLAG,
  PNH_FLAG AS PNH_FLAG,
  ON_HOLD AS ON_HOLD,
  QUAL_CHK_HOLD_UPON_RCPT AS QUAL_CHK_HOLD_UPON_RCPT,
  UN_NUMBER_ID AS UN_NUMBER_ID,
  BILL_OF_LADING_NUMBER AS BILL_OF_LADING_NUMBER,
  TRANS_RESP_CODE AS TRANS_RESP_CODE,
  PRIORITY_TYPE AS PRIORITY_TYPE,
  PURCHASE_ORDERS_WEIGHT AS PURCHASE_ORDERS_WEIGHT,
  PRO_NUMBER AS PRO_NUMBER,
  PRIORITY AS PRIORITY,
  EVENT_IND_TYPEID AS EVENT_IND_TYPEID,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  CARRIER_ID AS CARRIER_ID,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DSG_MOT_ID AS DSG_MOT_ID,
  DSG_SERVICE_LEVEL_ID AS DSG_SERVICE_LEVEL_ID,
  DECLINE_REASON_ID AS DECLINE_REASON_ID,
  CHANNEL_TYPE AS CHANNEL_TYPE,
  PRIMARY_CONTACT_NUMBER AS PRIMARY_CONTACT_NUMBER,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  BUYER_CODE AS BUYER_CODE,
  REP_NAME AS REP_NAME,
  REGION_ID AS REGION_ID,
  INBOUND_REGION_ID AS INBOUND_REGION_ID,
  OUTBOUND_REGION_ID AS OUTBOUND_REGION_ID,
  PLAN_SHPMT_NBR AS PLAN_SHPMT_NBR,
  MISC_INSTR_CODE_1 AS MISC_INSTR_CODE_1,
  MISC_INSTR_CODE_2 AS MISC_INSTR_CODE_2,
  ASN_SHPMT_TYPE AS ASN_SHPMT_TYPE,
  PROD_SCHED_REF_NUMBER AS PROD_SCHED_REF_NUMBER,
  DELAY_TYPE AS DELAY_TYPE,
  CUSTOMER_CODE AS CUSTOMER_CODE,
  CUSTOMER_FIRSTNAME AS CUSTOMER_FIRSTNAME,
  CUSTOMER_LASTNAME AS CUSTOMER_LASTNAME,
  CUSTOMER_ID AS CUSTOMER_ID,
  EST_OUTBD_LPN AS EST_OUTBD_LPN,
  EST_PALLET_BRIDGED AS EST_PALLET_BRIDGED,
  MAJOR_PKT_GRP_ATTR AS MAJOR_PKT_GRP_ATTR,
  MARK_FOR AS MARK_FOR,
  ONHOLD_EVENT_ID AS ONHOLD_EVENT_ID,
  UNHOLD_EVENT_ID AS UNHOLD_EVENT_ID,
  OUTBD_LPN_EPC_TYPE AS OUTBD_LPN_EPC_TYPE,
  PACK_SLIP_PRT_CNT AS PACK_SLIP_PRT_CNT,
  PKT_CONSOL_PROF AS PKT_CONSOL_PROF,
  PKT_PROFILE_ID AS PKT_PROFILE_ID,
  PLT_CONTNT_LABEL_TYPE AS PLT_CONTNT_LABEL_TYPE,
  PLT_CUBNG_INDIC AS PLT_CUBNG_INDIC,
  PRE_STIKR_CODE AS PRE_STIKR_CODE,
  STORE_NBR AS STORE_NBR,
  STORE_TYPE AS STORE_TYPE,
  SWC_NBR_SEQ AS SWC_NBR_SEQ,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  BATCH_ID AS BATCH_ID,
  DROPOFF_PICKUP AS DROPOFF_PICKUP,
  IS_CLOSED AS IS_CLOSED,
  MFG_PLNT AS MFG_PLNT,
  ORG_SHIP_FACILITY_ID AS ORG_SHIP_FACILITY_ID,
  OUTBD_LPN_ASN_REQD AS OUTBD_LPN_ASN_REQD,
  OUTBD_LPN_CUBNG_INDIC AS OUTBD_LPN_CUBNG_INDIC,
  OUTBD_LPN_LABEL_TYPE AS OUTBD_LPN_LABEL_TYPE,
  PACKAGING AS PACKAGING,
  RTN_MISC_NBR AS RTN_MISC_NBR,
  COMMIMTED_DLVR_DTTM AS COMMIMTED_DLVR_DTTM,
  GRAND_TOTAL AS GRAND_TOTAL,
  DSG_CARRIER_CODE AS DSG_CARRIER_CODE,
  TOTAL_DLRS_DISC AS TOTAL_DLRS_DISC,
  FRT_CLASS AS FRT_CLASS,
  PLAN_ID AS PLAN_ID,
  WORK_ORD_NBR AS WORK_ORD_NBR,
  MANUFACTURING_ORDER_NBR AS MANUFACTURING_ORDER_NBR,
  DC_ORDER_NUMBER AS DC_ORDER_NUMBER,
  CUT_NBR AS CUT_NBR,
  EXT_PURCHASE_ORDERS_ID AS EXT_PURCHASE_ORDERS_ID,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  ORDER_CATEGORY AS ORDER_CATEGORY,
  DELIVERY_CHANNEL_ID AS DELIVERY_CHANNEL_ID,
  D_CONTACT_NAME AS D_CONTACT_NAME,
  BILL_TO_CONTACT_NAME AS BILL_TO_CONTACT_NAME,
  CHANNEL_ID AS CHANNEL_ID,
  DEPARTMENT_ID AS DEPARTMENT_ID,
  DOM_STORE_TYPE AS DOM_STORE_TYPE,
  FULFILL_MODE AS FULFILL_MODE,
  CONS_RUN_ID AS CONS_RUN_ID,
  LAST_RUN_ID AS LAST_RUN_ID,
  ACCEPTED_DTTM AS ACCEPTED_DTTM,
  IS_DO_CREATED AS IS_DO_CREATED,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  ENTERED_BY AS ENTERED_BY,
  ENTRY_TYPE AS ENTRY_TYPE,
  ENTRY_CODE AS ENTRY_CODE,
  CUSTOMER_USER_ID AS CUSTOMER_USER_ID,
  CUSTOMER_EMAIL AS CUSTOMER_EMAIL,
  CUSTOMER_PHONE AS CUSTOMER_PHONE,
  CUSTOMER_TYPE AS CUSTOMER_TYPE,
  PAYMENT_STATUS AS PAYMENT_STATUS,
  REASON_ID AS REASON_ID,
  ADDR_VALID AS ADDR_VALID,
  ORG_APPT_EXISTS AS ORG_APPT_EXISTS,
  DEST_APPT_EXISTS AS DEST_APPT_EXISTS,
  MINIMIZE_SHIPMENTS AS MINIMIZE_SHIPMENTS,
  ORDER_RECEIVED AS ORDER_RECEIVED,
  REF_FIELD_1 AS REF_FIELD_1,
  REF_FIELD_2 AS REF_FIELD_2,
  REF_FIELD_3 AS REF_FIELD_3,
  CONTNT_LABEL_TYPE AS CONTNT_LABEL_TYPE,
  NBR_OF_CONTNT_LABEL AS NBR_OF_CONTNT_LABEL,
  NBR_OF_LABEL AS NBR_OF_LABEL,
  NBR_OF_PAKNG_SLIPS AS NBR_OF_PAKNG_SLIPS,
  PALLET_CONTENT_LABEL_TYPE AS PALLET_CONTENT_LABEL_TYPE,
  LPN_LABEL_TYPE AS LPN_LABEL_TYPE,
  PACK_SLIP_TYPE AS PACK_SLIP_TYPE,
  BOL_TYPE AS BOL_TYPE,
  MANIF_TYPE AS MANIF_TYPE,
  PRINT_CANADIAN_CUST_INVC_FLAG AS PRINT_CANADIAN_CUST_INVC_FLAG,
  PRINT_COO AS PRINT_COO,
  PRINT_DOCK_RCPT_FLAG AS PRINT_DOCK_RCPT_FLAG,
  PRINT_INV AS PRINT_INV,
  PRINT_NAFTA_COO_FLAG AS PRINT_NAFTA_COO_FLAG,
  PRINT_OCEAN_BOL_FLAG AS PRINT_OCEAN_BOL_FLAG,
  PRINT_SED AS PRINT_SED,
  PRINT_SHPR_LTR_OF_INSTR_FLAG AS PRINT_SHPR_LTR_OF_INSTR_FLAG,
  PRINT_PKG_LIST_FLAG AS PRINT_PKG_LIST_FLAG,
  FREIGHT_REVENUE_CURRENCY_CODE AS FREIGHT_REVENUE_CURRENCY_CODE,
  FREIGHT_REVENUE AS FREIGHT_REVENUE,
  TRANS_PLAN_DIRECTION AS TRANS_PLAN_DIRECTION,
  DSG_VOYAGE_FLIGHT AS DSG_VOYAGE_FLIGHT,
  REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  COMPLETED_EXTERNALLY AS COMPLETED_EXTERNALLY,
  INCOTERM_ID AS INCOTERM_ID,
  DIRECTION AS DIRECTION,
  ENTRY_CODE_FACILITY_ID AS ENTRY_CODE_FACILITY_ID,
  RETURN_REFERENCE_NUMBER AS RETURN_REFERENCE_NUMBER,
  ORDER_CONFIRMATION_DATE AS ORDER_CONFIRMATION_DATE,
  RMA_STATUS AS RMA_STATUS,
  O_PHONE_NUMBER AS O_PHONE_NUMBER,
  O_EMAIL AS O_EMAIL,
  O_FAX_NUMBER AS O_FAX_NUMBER,
  TAX_ID AS TAX_ID,
  SHIPPING_CHANNEL AS SHIPPING_CHANNEL,
  SHIP_GROUP_ID AS SHIP_GROUP_ID
FROM
  PURCHASE_ORDERS"""

df_4 = spark.sql(query_4)

df_4.createOrReplaceTempView("Shortcut_to_PURCHASE_ORDERS_4")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_PURCHASE_ORDERS_5


query_5 = f"""SELECT
  DISTINCT PO.PURCHASE_ORDERS_ID,
  PO.TC_PURCHASE_ORDERS_ID
FROM
  PRODUCT.PURCHASE_ORDERS_LINE_ITEM POL
  INNER JOIN PRODUCT.Shortcut_to_PURCHASE_ORDERS_4 PO ON PO.PURCHASE_ORDERS_ID = POL.PURCHASE_ORDERS_ID
  LEFT OUTER JOIN (
    SELECT
      ORDERS.PURCHASE_ORDER_ID,
      ORDER_LINE_ITEM.MO_LINE_ITEM_ID,
      MAX(ORDERS.LAST_UPDATED_DTTM) AS LAST_UPDATED_DTTM
    FROM
      PRODUCT.ORDERS
      JOIN PRODUCT.ORDER_LINE_ITEM ON ORDERS.ORDER_ID = ORDER_LINE_ITEM.ORDER_ID
    GROUP BY
      ORDERS.PURCHASE_ORDER_ID,
      ORDER_LINE_ITEM.MO_LINE_ITEM_ID
  ) O ON O.PURCHASE_ORDER_ID = POL.PURCHASE_ORDERS_ID
  AND O.MO_LINE_ITEM_ID = POL.PURCHASE_ORDERS_LINE_ITEM_ID
  LEFT OUTER JOIN PRODUCT.A_INVOICE I ON I.ENTITY_ID = PO.PURCHASE_ORDERS_ID
  LEFT OUTER JOIN PRODUCT.A_INVOICE_LINE IL ON IL.INVOICE_ID = I.INVOICE_ID
WHERE
  LENGTH(PO.TC_PURCHASE_ORDERS_ID) < 10
  AND (
    TRUNC(PO.LAST_UPDATED_DTTM) > TRUNC(now()) {OMSDaysFilter}
    OR TRUNC(POL.LAST_UPDATED_DTTM) > TRUNC(now()) {OMSDaysFilter}
    OR CASE
      WHEN O.LAST_UPDATED_DTTM IS NULL THEN TRUNC(now())
      ELSE O.LAST_UPDATED_DTTM
    END > TRUNC(now()) {OMSDaysFilter}
    OR CASE
      WHEN I.LAST_UPDATED_DTTM IS NULL THEN TRUNC(now())
      ELSE I.LAST_UPDATED_DTTM
    END > TRUNC(now()) {OMSDaysFilter}
    OR CASE
      WHEN IL.LAST_UPDATED_DTTM IS NULL THEN TRUNC(now())
      ELSE IL.LAST_UPDATED_DTTM
    END > TRUNC(now()) {OMSDaysFilter}
  )"""

df_5 = spark.sql(query_5)

df_5.createOrReplaceTempView("SQ_Shortcut_to_PURCHASE_ORDERS_5")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_ORDER_LINE_ITEM_6


query_6 = f"""SELECT
  ORDER_ID AS ORDER_ID,
  LINE_ITEM_ID AS LINE_ITEM_ID,
  PARENT_LINE_ITEM_ID AS PARENT_LINE_ITEM_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  COMMODITY_CLASS AS COMMODITY_CLASS,
  REF_FIELD1 AS REF_FIELD1,
  REF_FIELD2 AS REF_FIELD2,
  REF_FIELD3 AS REF_FIELD3,
  EXT_SYS_LINE_ITEM_ID AS EXT_SYS_LINE_ITEM_ID,
  MASTER_ORDER_ID AS MASTER_ORDER_ID,
  MO_LINE_ITEM_ID AS MO_LINE_ITEM_ID,
  IS_HAZMAT AS IS_HAZMAT,
  IS_STACKABLE AS IS_STACKABLE,
  HAS_ERRORS AS HAS_ERRORS,
  ORIG_BUDG_COST AS ORIG_BUDG_COST,
  BUDG_COST_CURRENCY_CODE AS BUDG_COST_CURRENCY_CODE,
  BUDG_COST AS BUDG_COST,
  ACTUAL_COST_CURRENCY_CODE AS ACTUAL_COST_CURRENCY_CODE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  RTS_ID AS RTS_ID,
  RTS_LINE_ITEM_ID AS RTS_LINE_ITEM_ID,
  STD_PACK_QTY AS STD_PACK_QTY,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  PROTECTION_LEVEL_ID AS PROTECTION_LEVEL_ID,
  PACKAGE_TYPE_ID AS PACKAGE_TYPE_ID,
  COMMODITY_CODE_ID AS COMMODITY_CODE_ID,
  MV_SIZE_UOM_ID AS MV_SIZE_UOM_ID,
  QTY_UOM_ID_BASE AS QTY_UOM_ID_BASE,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  PRIORITY AS PRIORITY,
  MERCHANDIZING_DEPARTMENT_ID AS MERCHANDIZING_DEPARTMENT_ID,
  UN_NUMBER_ID AS UN_NUMBER_ID,
  PICKUP_REFERENCE_NUMBER AS PICKUP_REFERENCE_NUMBER,
  DELIVERY_REFERENCE_NUMBER AS DELIVERY_REFERENCE_NUMBER,
  CNTRY_OF_ORGN AS CNTRY_OF_ORGN,
  PROD_STAT AS PROD_STAT,
  STACK_RANK AS STACK_RANK,
  STACK_LENGTH_VALUE AS STACK_LENGTH_VALUE,
  STACK_LENGTH_STANDARD_UOM AS STACK_LENGTH_STANDARD_UOM,
  STACK_WIDTH_VALUE AS STACK_WIDTH_VALUE,
  STACK_WIDTH_STANDARD_UOM AS STACK_WIDTH_STANDARD_UOM,
  STACK_HEIGHT_VALUE AS STACK_HEIGHT_VALUE,
  STACK_HEIGHT_STANDARD_UOM AS STACK_HEIGHT_STANDARD_UOM,
  STACK_DIAMETER_VALUE AS STACK_DIAMETER_VALUE,
  STACK_DIAMETER_STANDARD_UOM AS STACK_DIAMETER_STANDARD_UOM,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_SOURCE_TYPE AS LAST_UPDATED_SOURCE_TYPE,
  LAST_UPDATED_SOURCE AS LAST_UPDATED_SOURCE,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  HIBERNATE_VERSION AS HIBERNATE_VERSION,
  CUBE_MULTIPLE_QTY AS CUBE_MULTIPLE_QTY,
  DO_DTL_STATUS AS DO_DTL_STATUS,
  INTERNAL_ORDER_SEQ_NBR AS INTERNAL_ORDER_SEQ_NBR,
  IS_EMERGENCY AS IS_EMERGENCY,
  LPN_SIZE AS LPN_SIZE,
  MANUFACTURING_DTTM AS MANUFACTURING_DTTM,
  ORDER_LINE_ID AS ORDER_LINE_ID,
  PACK_RATE AS PACK_RATE,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  PLANNED_SHIP_DATE AS PLANNED_SHIP_DATE,
  PPACK_QTY AS PPACK_QTY,
  STD_BUNDLE_QTY AS STD_BUNDLE_QTY,
  STD_LPN_QTY AS STD_LPN_QTY,
  STD_LPN_VOL AS STD_LPN_VOL,
  STD_LPN_WT AS STD_LPN_WT,
  UNIT_COST AS UNIT_COST,
  UNIT_PRICE_AMOUNT AS UNIT_PRICE_AMOUNT,
  UNIT_VOL AS UNIT_VOL,
  UNIT_WT AS UNIT_WT,
  USER_CANCELED_QTY AS USER_CANCELED_QTY,
  WAVE_PROC_TYPE AS WAVE_PROC_TYPE,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  EVENT_CODE AS EVENT_CODE,
  REASON_CODE AS REASON_CODE,
  EXP_INFO_CODE AS EXP_INFO_CODE,
  PARTL_FILL AS PARTL_FILL,
  LINE_TYPE AS LINE_TYPE,
  REPL_PROC_TYPE AS REPL_PROC_TYPE,
  ORDER_QTY AS ORDER_QTY,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RTL_TO_BE_DISTROED_QTY AS RTL_TO_BE_DISTROED_QTY,
  PRICE AS PRICE,
  RETAIL_PRICE AS RETAIL_PRICE,
  UNITS_PAKD AS UNITS_PAKD,
  MINOR_ORDER_NBR AS MINOR_ORDER_NBR,
  ITEM_ID AS ITEM_ID,
  TC_ORDER_LINE_ID AS TC_ORDER_LINE_ID,
  ACTUAL_SHIPPED_DTTM AS ACTUAL_SHIPPED_DTTM,
  QTY_UOM_ID AS QTY_UOM_ID,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  PURCHASE_ORDER_LINE_NUMBER AS PURCHASE_ORDER_LINE_NUMBER,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  REFERENCE_LINE_ITEM_ID AS REFERENCE_LINE_ITEM_ID,
  REFERENCE_ORDER_ID AS REFERENCE_ORDER_ID,
  REPL_WAVE_RUN AS REPL_WAVE_RUN,
  STD_PALLET_QTY AS STD_PALLET_QTY,
  STD_SUB_PACK_QTY AS STD_SUB_PACK_QTY,
  STORE_DEPT AS STORE_DEPT,
  ALLOC_TYPE AS ALLOC_TYPE,
  BATCH_NBR AS BATCH_NBR,
  BATCH_REQUIREMENT_TYPE AS BATCH_REQUIREMENT_TYPE,
  CHUTE_ASSIGN_TYPE AS CHUTE_ASSIGN_TYPE,
  CUSTOM_TAG AS CUSTOM_TAG,
  CUSTOMER_ITEM AS CUSTOMER_ITEM,
  INTERNAL_ORDER_ID AS INTERNAL_ORDER_ID,
  INVN_TYPE AS INVN_TYPE,
  ITEM_ATTR_1 AS ITEM_ATTR_1,
  ITEM_ATTR_2 AS ITEM_ATTR_2,
  ITEM_ATTR_3 AS ITEM_ATTR_3,
  ITEM_ATTR_4 AS ITEM_ATTR_4,
  ITEM_ATTR_5 AS ITEM_ATTR_5,
  LPN_BRK_ATTRIB AS LPN_BRK_ATTRIB,
  MERCH_GRP AS MERCH_GRP,
  MERCH_TYPE AS MERCH_TYPE,
  PACK_ZONE AS PACK_ZONE,
  PALLET_TYPE AS PALLET_TYPE,
  PICK_LOCN_ASSIGN_TYPE AS PICK_LOCN_ASSIGN_TYPE,
  PICK_LOCN_ID AS PICK_LOCN_ID,
  PPACK_GRP_CODE AS PPACK_GRP_CODE,
  PRICE_TKT_TYPE AS PRICE_TKT_TYPE,
  SERIAL_NUMBER_REQUIRED_FLAG AS SERIAL_NUMBER_REQUIRED_FLAG,
  SKU_GTIN AS SKU_GTIN,
  SKU_SUB_CODE_ID AS SKU_SUB_CODE_ID,
  SKU_SUB_CODE_VALUE AS SKU_SUB_CODE_VALUE,
  VAS_PROCESS_TYPE AS VAS_PROCESS_TYPE,
  SUBSTITUTED_PARENT_LINE_ID AS SUBSTITUTED_PARENT_LINE_ID,
  IS_CANCELLED AS IS_CANCELLED,
  ITEM_NAME AS ITEM_NAME,
  ALLOC_LINE_ID AS ALLOC_LINE_ID,
  ALLOCATION_SOURCE_ID AS ALLOCATION_SOURCE_ID,
  ALLOCATION_SOURCE_LINE_ID AS ALLOCATION_SOURCE_LINE_ID,
  ALLOCATION_SOURCE AS ALLOCATION_SOURCE,
  SHELF_DAYS AS SHELF_DAYS,
  FULFILLMENT_TYPE AS FULFILLMENT_TYPE,
  WAVE_NBR AS WAVE_NBR,
  SHIP_WAVE_NBR AS SHIP_WAVE_NBR,
  REPL_WAVE_NBR AS REPL_WAVE_NBR,
  SINGLE_UNIT_FLAG AS SINGLE_UNIT_FLAG,
  ACTUAL_COST AS ACTUAL_COST,
  QTY_CONV_FACTOR AS QTY_CONV_FACTOR,
  PLANNED_WEIGHT AS PLANNED_WEIGHT,
  RECEIVED_WEIGHT AS RECEIVED_WEIGHT,
  SHIPPED_WEIGHT AS SHIPPED_WEIGHT,
  WEIGHT_UOM_ID_BASE AS WEIGHT_UOM_ID_BASE,
  WEIGHT_UOM_ID AS WEIGHT_UOM_ID,
  PLANNED_VOLUME AS PLANNED_VOLUME,
  RECEIVED_VOLUME AS RECEIVED_VOLUME,
  SHIPPED_VOLUME AS SHIPPED_VOLUME,
  VOLUME_UOM_ID_BASE AS VOLUME_UOM_ID_BASE,
  VOLUME_UOM_ID AS VOLUME_UOM_ID,
  SIZE1_UOM_ID AS SIZE1_UOM_ID,
  SIZE1_VALUE AS SIZE1_VALUE,
  RECEIVED_SIZE1 AS RECEIVED_SIZE1,
  SHIPPED_SIZE1 AS SHIPPED_SIZE1,
  SIZE2_UOM_ID AS SIZE2_UOM_ID,
  SIZE2_VALUE AS SIZE2_VALUE,
  RECEIVED_SIZE2 AS RECEIVED_SIZE2,
  SHIPPED_SIZE2 AS SHIPPED_SIZE2,
  LPN_TYPE AS LPN_TYPE,
  ORDER_CONSOL_ATTR AS ORDER_CONSOL_ATTR,
  SKU_BREAK_ATTR AS SKU_BREAK_ATTR,
  PURCHASE_ORDER_NUMBER AS PURCHASE_ORDER_NUMBER,
  EXT_PURCHASE_ORDER AS EXT_PURCHASE_ORDER,
  CRITCL_DIM_1 AS CRITCL_DIM_1,
  CRITCL_DIM_2 AS CRITCL_DIM_2,
  CRITCL_DIM_3 AS CRITCL_DIM_3,
  ASSORT_NBR AS ASSORT_NBR,
  DESCRIPTION AS DESCRIPTION,
  ORIGINAL_ORDERED_ITEM_ID AS ORIGINAL_ORDERED_ITEM_ID,
  SUBSTITUTION_TYPE AS SUBSTITUTION_TYPE,
  BACK_ORD_REASON AS BACK_ORD_REASON,
  FREIGHT_REVENUE_CURRENCY_CODE AS FREIGHT_REVENUE_CURRENCY_CODE,
  FREIGHT_REVENUE AS FREIGHT_REVENUE,
  IS_CHASE_CREATED_LINE AS IS_CHASE_CREATED_LINE,
  REF_FIELD4 AS REF_FIELD4,
  REF_FIELD5 AS REF_FIELD5,
  REF_FIELD6 AS REF_FIELD6,
  REF_FIELD7 AS REF_FIELD7,
  REF_FIELD8 AS REF_FIELD8,
  REF_FIELD9 AS REF_FIELD9,
  REF_FIELD10 AS REF_FIELD10,
  REF_NUM1 AS REF_NUM1,
  REF_NUM2 AS REF_NUM2,
  REF_NUM3 AS REF_NUM3,
  REF_NUM4 AS REF_NUM4,
  REF_NUM5 AS REF_NUM5,
  IS_GIFT AS IS_GIFT,
  ADJUSTED_ORDER_QTY AS ADJUSTED_ORDER_QTY,
  PRE_RECEIPT_STATUS AS PRE_RECEIPT_STATUS,
  ALLOW_REVIVAL_RECEIPT_ALLOC AS ALLOW_REVIVAL_RECEIPT_ALLOC,
  SEGMENT_NAME AS SEGMENT_NAME,
  EFFECTIVE_RANK AS EFFECTIVE_RANK,
  WM_RECEIPT_ALLOCATED AS WM_RECEIPT_ALLOCATED,
  REF_BOOLEAN1 AS REF_BOOLEAN1,
  REF_BOOLEAN2 AS REF_BOOLEAN2,
  REF_SYSCODE1 AS REF_SYSCODE1,
  REF_SYSCODE2 AS REF_SYSCODE2,
  REF_SYSCODE3 AS REF_SYSCODE3
FROM
  ORDER_LINE_ITEM"""

df_6 = spark.sql(query_6)

df_6.createOrReplaceTempView("Shortcut_to_ORDER_LINE_ITEM_6")

# COMMAND ----------
# DBTITLE 1, OMS_PURCH_ORDER_LOAD_CTRL


spark.sql("""INSERT INTO
  OMS_PURCH_ORDER_LOAD_CTRL
SELECT
  PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  TC_PURCHASE_ORDERS_ID AS TC_PURCHASE_ORDERS_ID
FROM
  SQ_Shortcut_to_PURCHASE_ORDERS_5""")

# COMMAND ----------
#Post session variable updation
updateVariable(postVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Purch_Order_Load_Ctrl")

# COMMAND ----------
#Update Mapping Variables in database.
persistVariables(variablesTableName, "m_OMS_Purch_Order_Load_Ctrl", mainWorkflowId, parentName)
