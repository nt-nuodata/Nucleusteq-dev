# Databricks notebook source
# MAGIC %run "./udf_informatica"

# COMMAND ----------


from pyspark.sql.types import *

spark.sql("use DELTA_TRAINING")
spark.sql("set spark.sql.legacy.timeParserPolicy = LEGACY")

# COMMAND ----------
%run ../WorkflowUtility

# COMMAND ----------
mainWorkflowId = dbutils.widgets.get("mainWorkflowId")
mainWorkflowRunId = dbutils.widgets.get("mainWorkflowRunId")
parentName = dbutils.widgets.get("parentName")
preVariableAssignment = dbutils.widgets.get("preVariableAssignment")
postVariableAssignment = dbutils.widgets.get("postVariableAssignment")
truncTargetTableOptions = dbutils.widgets.get("truncTargetTableOptions")
variablesTableName = dbutils.widgets.get("variablesTableName")

# COMMAND ----------
#Truncate Target Tables
truncateTargetTables(truncTargetTableOptions)

# COMMAND ----------
#Pre presession variable updation
updateVariable(preVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Order_Ln")

# COMMAND ----------
fetchAndCreateVariables(parentName,"m_OMS_Order_Ln", variablesTableName, mainWorkflowId)

# COMMAND ----------
# DBTITLE 1, Lkp_Site_Profile


spark.sql(
  """CREATE OR REPLACE FUNCTION Lkp_Site_Profile (in_FACILITY_ALIAS_ID STRING, in_FACILITY_TYPE_ID INT)
RETURNS INT
READS SQL DATA SQL SECURITY DEFINER
RETURN SELECT FIRST(LOCATION_ID) FROM SITE_PROFILE WHERE LOCATION_NBR = in_FACILITY_ALIAS_ID AND LOCATION_TYPE_ID = in_FACILITY_TYPE_ID"""
)

# COMMAND ----------
# DBTITLE 1, LKP_SKU_PROFILE


spark.sql(
  """CREATE OR REPLACE FUNCTION LKP_SKU_PROFILE (in_SKU INT)
RETURNS INT
READS SQL DATA SQL SECURITY DEFINER
RETURN SELECT FIRST(PRODUCT_ID) FROM SKU_PROFILE WHERE SKU_NBR = in_SKU"""
)

# COMMAND ----------
# DBTITLE 1, Lkp_CURRENCY_DAY


spark.sql(
  """CREATE OR REPLACE FUNCTION Lkp_CURRENCY_DAY (in_DAY_DT DATE)
RETURNS STRING
READS SQL DATA SQL SECURITY DEFINER
RETURN SELECT FIRST(EXCHANGE_RATE_PCNT) FROM CURRENCY_DAY WHERE DAY_DT = in_DAY_DT"""
)

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_FACILITY1_3


query_3 = f"""SELECT
  OMS_FACILITY_ID AS OMS_FACILITY_ID,
  FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_FACILITY"""

df_3 = spark.sql(query_3)

df_3.createOrReplaceTempView("Shortcut_to_OMS_FACILITY1_3")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_FACILITY1_4


query_4 = f"""SELECT
  OMS_FACILITY_ID AS OMS_FACILITY_ID,
  FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_FACILITY1_3"""

df_4 = spark.sql(query_4)

df_4.createOrReplaceTempView("SQ_Shortcut_to_OMS_FACILITY1_4")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_FACILITY_5


query_5 = f"""SELECT
  OMS_FACILITY_ID AS OMS_FACILITY_ID,
  FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_FACILITY"""

df_5 = spark.sql(query_5)

df_5.createOrReplaceTempView("Shortcut_to_OMS_FACILITY_5")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_FACILITY_6


query_6 = f"""SELECT
  OMS_FACILITY_ID AS OMS_FACILITY_ID,
  FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_FACILITY_5"""

df_6 = spark.sql(query_6)

df_6.createOrReplaceTempView("SQ_Shortcut_to_OMS_FACILITY_6")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_A_CO_REASON_CODE_7


query_7 = f"""SELECT
  OMS_REASON_CODE_ID AS OMS_REASON_CODE_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_REASON_CD AS OMS_REASON_CD,
  OMS_REASON_DESC AS OMS_REASON_DESC,
  OMS_REASON_CODE_TYPE AS OMS_REASON_CODE_TYPE,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  SYSTEM_DEFINED_FLAG AS SYSTEM_DEFINED_FLAG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_A_CO_REASON_CODE"""

df_7 = spark.sql(query_7)

df_7.createOrReplaceTempView("Shortcut_to_OMS_A_CO_REASON_CODE_7")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_A_CO_REASON_CODE_8


query_8 = f"""SELECT
  OMS_REASON_CODE_ID AS OMS_REASON_CODE_ID,
  OMS_REASON_CD AS OMS_REASON_CD,
  OMS_REASON_CODE_TYPE AS OMS_REASON_CODE_TYPE,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_A_CO_REASON_CODE_7
WHERE
  OMS_REASON_CODE_TYPE = 1
  AND MARK_FOR_DELETION_FLAG = 0"""

df_8 = spark.sql(query_8)

df_8.createOrReplaceTempView("SQ_Shortcut_to_OMS_A_CO_REASON_CODE_8")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_9


query_9 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  ORDER_NBR AS ORDER_NBR,
  OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  OMS_TC_PO_LINE_ID AS OMS_TC_PO_LINE_ID,
  OMS_ORDER_FULFILLMENT_OPTION AS OMS_ORDER_FULFILLMENT_OPTION,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_ENTERED_BY AS OMS_ENTERED_BY,
  OMS_ROLE_NAME AS OMS_ROLE_NAME,
  PO_OMS_CREATED_TSTMP AS PO_OMS_CREATED_TSTMP,
  PO_OMS_LAST_UPDATED_DTTM AS PO_OMS_LAST_UPDATED_DTTM,
  POL_OMS_CREATED_TSTMP AS POL_OMS_CREATED_TSTMP,
  POL_OMS_LAST_UPDATED_TSTMP AS POL_OMS_LAST_UPDATED_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_EDW_LOAD_CTRL_PRE"""

df_9 = spark.sql(query_9)

df_9.createOrReplaceTempView("Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_9")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_10


query_10 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  ORDER_NBR AS ORDER_NBR,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_9"""

df_10 = spark.sql(query_10)

df_10.createOrReplaceTempView("SQ_Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_10")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_11


query_11 = f"""SELECT
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  REF_FIELD1 AS REF_FIELD1,
  REF_FIELD2 AS REF_FIELD2,
  REF_FIELD3 AS REF_FIELD3,
  REF_FIELD4 AS REF_FIELD4,
  REF_FIELD5 AS REF_FIELD5,
  REF_FIELD6 AS REF_FIELD6,
  REF_FIELD7 AS REF_FIELD7,
  REF_FIELD8 AS REF_FIELD8,
  REF_FIELD9 AS REF_FIELD9,
  REF_FIELD10 AS REF_FIELD10,
  REF_NUM1 AS REF_NUM1,
  REF_NUM2 AS REF_NUM2,
  REF_NUM3 AS REF_NUM3,
  REF_NUM4 AS REF_NUM4,
  REF_NUM5 AS REF_NUM5,
  RX_STATUS AS RX_STATUS,
  RX_ASSIGNED_TO AS RX_ASSIGNED_TO,
  RX_ASSIGNED_TSTMP AS RX_ASSIGNED_TSTMP,
  RX_VET_INQUIRY AS RX_VET_INQUIRY,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_PO_LINE_ITEM_REF_FIELDS"""

df_11 = spark.sql(query_11)

df_11.createOrReplaceTempView("Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_11")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_12


query_12 = f"""SELECT
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  REF_FIELD1 AS REF_FIELD1,
  REF_FIELD3 AS REF_FIELD3,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_11"""

df_12 = spark.sql(query_12)

df_12.createOrReplaceTempView("SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_12")

# COMMAND ----------
# DBTITLE 1, Exp_POLR_13


query_13 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  IFF(
    ISNULL(REF_FIELD3)
    or UPPER(REF_FIELD3) = 'FALSE',
    0,
    1
  ) AS SUBSCRIPTION_ORDER_FLG,
  IFF(ISNULL(REF_FIELD1), 0, TO_INTEGER(REF_FIELD1)) AS SCHED_DELIVERY_FLG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS1_12"""

df_13 = spark.sql(query_13)

df_13.createOrReplaceTempView("Exp_POLR_13")

# COMMAND ----------
# DBTITLE 1, SRTTRANS_14


query_14 = f"""SELECT
  PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  Exp_POLR_13
ORDER BY
  PURCHASE_ORDERS_ID ASC"""

df_14 = spark.sql(query_14)

df_14.createOrReplaceTempView("SRTTRANS_14")

# COMMAND ----------
# DBTITLE 1, Agg_POLR_15


query_15 = f"""SELECT
  PURCHASE_ORDERS_ID AS polr_PURCHASE_ORDERS_ID,
  MAX(SUBSCRIPTION_ORDER_FLG) AS SUBSCRIPTION_ORDER_FLG,
  MAX(SCHED_DELIVERY_FLG) AS SCHED_DELIVERY_FLG,
  MAX(UPDATE_TSTMP) AS UPDATE_TSTMP,
  last(Monotonically_Increasing_Id) AS Monotonically_Increasing_Id
FROM
  SRTTRANS_14
GROUP BY
  PURCHASE_ORDERS_ID"""

df_15 = spark.sql(query_15)

df_15.createOrReplaceTempView("Agg_POLR_15")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_16


query_16 = f"""SELECT
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  REF_FIELD1 AS REF_FIELD1,
  REF_FIELD2 AS REF_FIELD2,
  REF_FIELD3 AS REF_FIELD3,
  REF_FIELD4 AS REF_FIELD4,
  REF_FIELD5 AS REF_FIELD5,
  REF_FIELD6 AS REF_FIELD6,
  REF_FIELD7 AS REF_FIELD7,
  REF_FIELD8 AS REF_FIELD8,
  REF_FIELD9 AS REF_FIELD9,
  REF_FIELD10 AS REF_FIELD10,
  REF_NUM1 AS REF_NUM1,
  REF_NUM2 AS REF_NUM2,
  REF_NUM3 AS REF_NUM3,
  REF_NUM4 AS REF_NUM4,
  REF_NUM5 AS REF_NUM5,
  RX_STATUS AS RX_STATUS,
  RX_ASSIGNED_TO AS RX_ASSIGNED_TO,
  RX_ASSIGNED_TSTMP AS RX_ASSIGNED_TSTMP,
  RX_VET_INQUIRY AS RX_VET_INQUIRY,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_PO_LINE_ITEM_REF_FIELDS"""

df_16 = spark.sql(query_16)

df_16.createOrReplaceTempView("Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_16")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_17


query_17 = f"""SELECT
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  REF_FIELD3 AS REF_FIELD3,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_16
WHERE
  UPPER(REF_FIELD3) = 'TRUE'"""

df_17 = spark.sql(query_17)

df_17.createOrReplaceTempView("SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_17")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_A_CHARGE_DETAIL_18


query_18 = f"""SELECT
  OMS_CHARGE_DETAIL_ID AS OMS_CHARGE_DETAIL_ID,
  OMS_ENTITY_TYPE_ID AS OMS_ENTITY_TYPE_ID,
  OMS_ENTITY_ID AS OMS_ENTITY_ID,
  OMS_ENTITY_LINE_ID AS OMS_ENTITY_LINE_ID,
  OMS_CHARGE_NAME AS OMS_CHARGE_NAME,
  OMS_CHARGE_CATEGORY AS OMS_CHARGE_CATEGORY,
  OMS_REASON_CODE_GROUP_ID AS OMS_REASON_CODE_GROUP_ID,
  CHARGE_AMT AS CHARGE_AMT,
  ORIGINAL_CHARGE_AMT AS ORIGINAL_CHARGE_AMT,
  OVERRIDEN_CHARGE_FLAG AS OVERRIDEN_CHARGE_FLAG,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_A_CHARGE_DETAIL"""

df_18 = spark.sql(query_18)

df_18.createOrReplaceTempView("Shortcut_to_OMS_A_CHARGE_DETAIL_18")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_A_CHARGE_DETAIL_19


query_19 = f"""SELECT
  OMS_ENTITY_ID AS OMS_ENTITY_ID,
  OMS_ENTITY_LINE_ID AS OMS_ENTITY_LINE_ID,
  OMS_CHARGE_NAME AS OMS_CHARGE_NAME,
  OMS_CHARGE_CATEGORY AS OMS_CHARGE_CATEGORY,
  CHARGE_AMT AS CHARGE_AMT,
  ORIGINAL_CHARGE_AMT AS ORIGINAL_CHARGE_AMT,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION_FLAG,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_A_CHARGE_DETAIL_18"""

df_19 = spark.sql(query_19)

df_19.createOrReplaceTempView("SQ_Shortcut_to_OMS_A_CHARGE_DETAIL_19")

# COMMAND ----------
# DBTITLE 1, EXP_CHARGE_AMOUNT_20


query_20 = f"""SELECT
  OMS_ENTITY_ID AS ENTITY_ID,
  OMS_ENTITY_LINE_ID AS ENTITY_LINE_ID,
  TO_CHAR(OMS_CHARGE_CATEGORY) AS CHARGE_CATEGORY,
  OMS_CHARGE_NAME AS CHARGE_NAME,
  IFF(ISNULL(CHARGE_AMT), 0, CHARGE_AMT) AS o_CHARGE_AMOUNT1,
  MARK_FOR_DELETION_FLAG AS MARK_FOR_DELETION,
  OMS_LAST_UPDATED_TSTMP AS LAST_UPDATED_DTTM,
  IFF(
    ISNULL(ORIGINAL_CHARGE_AMT),
    0,
    ORIGINAL_CHARGE_AMT
  ) AS o_ORIGINAL_CHARGE_AMOUNT1,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_A_CHARGE_DETAIL_19"""

df_20 = spark.sql(query_20)

df_20.createOrReplaceTempView("EXP_CHARGE_AMOUNT_20")

# COMMAND ----------
# DBTITLE 1, Fil_Mark_for_deletion_21


query_21 = f"""SELECT
  ENTITY_ID AS ENTITY_ID,
  ENTITY_LINE_ID AS ENTITY_LINE_ID,
  CHARGE_CATEGORY AS CHARGE_CATEGORY,
  CHARGE_NAME AS CHARGE_NAME,
  o_CHARGE_AMOUNT1 AS CHARGE_AMOUNT,
  MARK_FOR_DELETION AS MARK_FOR_DELETION,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  o_ORIGINAL_CHARGE_AMOUNT1 AS ORIGINAL_CHARGE_AMOUNT,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  EXP_CHARGE_AMOUNT_20
WHERE
  MARK_FOR_DELETION = 0
  AND (
    o_CHARGE_AMOUNT1 > 0
    OR o_ORIGINAL_CHARGE_AMOUNT1 > 0
  )"""

df_21 = spark.sql(query_21)

df_21.createOrReplaceTempView("Fil_Mark_for_deletion_21")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_22


query_22 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  ATTRIBUTE_NAME AS ATTRIBUTE_NAME,
  ATTRIBUTE_SEQ AS ATTRIBUTE_SEQ,
  ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_PO_LINE_ITEM_ATTRIBUTE"""

df_22 = spark.sql(query_22)

df_22.createOrReplaceTempView("Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_22")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_23


query_23 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  ATTRIBUTE_NAME AS ATTRIBUTE_NAME,
  ATTRIBUTE_SEQ AS ATTRIBUTE_SEQ,
  ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_22
WHERE
  ATTRIBUTE_NAME = 'Proxy_Tracking_Code'
  AND ATTRIBUTE_VALUE IS NOT NULL"""

df_23 = spark.sql(query_23)

df_23.createOrReplaceTempView("SQ_Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_23")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_24


query_24 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_TC_PO_LINE_ID AS OMS_TC_PO_LINE_ID,
  OMS_PARENT_PO_LINE_ITEM_ID AS OMS_PARENT_PO_LINE_ITEM_ID,
  OMS_ORIGINAL_PO_LINE_ITEM_ID AS OMS_ORIGINAL_PO_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_LINE_STATUS_ID AS OMS_PURCHASE_ORDERS_LINE_STATUS_ID,
  ORDER_FULFILLMENT_OPTION_ID AS ORDER_FULFILLMENT_OPTION_ID,
  SKU AS SKU,
  CUST_SKU AS CUST_SKU,
  OMS_PRODUCT_CLASS_ID AS OMS_PRODUCT_CLASS_ID,
  RETURNABLE_FLAG AS RETURNABLE_FLAG,
  EXCHANGEABLE_FLAG AS EXCHANGEABLE_FLAG,
  PRICE_OVERRIDE_FLAG AS PRICE_OVERRIDE_FLAG,
  OMS_STORE_FACILITY_ALIAS_ID AS OMS_STORE_FACILITY_ALIAS_ID,
  OMS_STORE_FACILITY_ID AS OMS_STORE_FACILITY_ID,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  OMS_O_FACILITY_ALIAS_ID AS OMS_O_FACILITY_ALIAS_ID,
  OMS_BILL_FACILITY_ALIAS_ID AS OMS_BILL_FACILITY_ALIAS_ID,
  OMS_BILL_FACILITY_ID AS OMS_BILL_FACILITY_ID,
  OMS_D_FACILITY_ID AS OMS_D_FACILITY_ID,
  OMS_D_FACILITY_ALIAS_ID AS OMS_D_FACILITY_ALIAS_ID,
  D_FIRST_NAME AS D_FIRST_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  D_ADDR_1 AS D_ADDR_1,
  D_ADDR_2 AS D_ADDR_2,
  D_ADDR_3 AS D_ADDR_3,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  D_PHONE_NBR AS D_PHONE_NBR,
  D_EMAIL AS D_EMAIL,
  ADDR_VALID_FLAG AS ADDR_VALID_FLAG,
  OMS_ALLOC_FINALIZER AS OMS_ALLOC_FINALIZER,
  OMS_DSG_CARRIER_ID AS OMS_DSG_CARRIER_ID,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DO_CREATED_FLAG AS DO_CREATED_FLAG,
  READY_TO_SHIP_FLAG AS READY_TO_SHIP_FLAG,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  CLOSED_FLAG AS CLOSED_FLAG,
  DELETED_FLAG AS DELETED_FLAG,
  OMS_REASON_ID AS OMS_REASON_ID,
  OMS_REASON_CODES_GROUP_ID AS OMS_REASON_CODES_GROUP_ID,
  OMS_BACK_ORD_REASON_ID AS OMS_BACK_ORD_REASON_ID,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  OMS_REQ_DLVR_TSTMP AS OMS_REQ_DLVR_TSTMP,
  OMS_MUST_DLVR_TSTMP AS OMS_MUST_DLVR_TSTMP,
  OMS_SHIP_BY_DT AS OMS_SHIP_BY_DT,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  ORDER_QTY AS ORDER_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  PPACK_QTY AS PPACK_QTY,
  SHIPPED_QTY AS SHIPPED_QTY,
  ORIGINAL_PRICE_AMT AS ORIGINAL_PRICE_AMT,
  RETAIL_PRICE_AMT AS RETAIL_PRICE_AMT,
  UNIT_TAX_AMT AS UNIT_TAX_AMT,
  LINE_TOTAL_AMT AS LINE_TOTAL_AMT,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  OMS_EXT_CREATED_TSTMP AS OMS_EXT_CREATED_TSTMP,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_PURCHASE_ORDERS_LINE_ITEM"""

df_24 = spark.sql(query_24)

df_24.createOrReplaceTempView("Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_24")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_25


query_25 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_TC_PO_LINE_ID AS OMS_TC_PO_LINE_ID,
  OMS_PARENT_PO_LINE_ITEM_ID AS OMS_PARENT_PO_LINE_ITEM_ID,
  OMS_ORIGINAL_PO_LINE_ITEM_ID AS OMS_ORIGINAL_PO_LINE_ITEM_ID,
  OMS_PURCHASE_ORDERS_LINE_STATUS_ID AS OMS_PURCHASE_ORDERS_LINE_STATUS_ID,
  ORDER_FULFILLMENT_OPTION_ID AS ORDER_FULFILLMENT_OPTION_ID,
  SKU AS SKU,
  CUST_SKU AS CUST_SKU,
  OMS_PRODUCT_CLASS_ID AS OMS_PRODUCT_CLASS_ID,
  RETURNABLE_FLAG AS RETURNABLE_FLAG,
  EXCHANGEABLE_FLAG AS EXCHANGEABLE_FLAG,
  PRICE_OVERRIDE_FLAG AS PRICE_OVERRIDE_FLAG,
  OMS_STORE_FACILITY_ALIAS_ID AS OMS_STORE_FACILITY_ALIAS_ID,
  OMS_STORE_FACILITY_ID AS OMS_STORE_FACILITY_ID,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  OMS_O_FACILITY_ALIAS_ID AS OMS_O_FACILITY_ALIAS_ID,
  OMS_BILL_FACILITY_ALIAS_ID AS OMS_BILL_FACILITY_ALIAS_ID,
  OMS_BILL_FACILITY_ID AS OMS_BILL_FACILITY_ID,
  OMS_D_FACILITY_ID AS OMS_D_FACILITY_ID,
  OMS_D_FACILITY_ALIAS_ID AS OMS_D_FACILITY_ALIAS_ID,
  D_FIRST_NAME AS D_FIRST_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  D_ADDR_1 AS D_ADDR_1,
  D_ADDR_2 AS D_ADDR_2,
  D_ADDR_3 AS D_ADDR_3,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CD AS D_POSTAL_CD,
  D_COUNTY AS D_COUNTY,
  D_COUNTRY_CD AS D_COUNTRY_CD,
  D_PHONE_NBR AS D_PHONE_NBR,
  D_EMAIL AS D_EMAIL,
  ADDR_VALID_FLAG AS ADDR_VALID_FLAG,
  OMS_ALLOC_FINALIZER AS OMS_ALLOC_FINALIZER,
  OMS_DSG_CARRIER_ID AS OMS_DSG_CARRIER_ID,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DO_CREATED_FLAG AS DO_CREATED_FLAG,
  READY_TO_SHIP_FLAG AS READY_TO_SHIP_FLAG,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  CLOSED_FLAG AS CLOSED_FLAG,
  DELETED_FLAG AS DELETED_FLAG,
  OMS_REASON_ID AS OMS_REASON_ID,
  OMS_REASON_CODES_GROUP_ID AS OMS_REASON_CODES_GROUP_ID,
  OMS_BACK_ORD_REASON_ID AS OMS_BACK_ORD_REASON_ID,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  OMS_REQ_DLVR_TSTMP AS OMS_REQ_DLVR_TSTMP,
  OMS_MUST_DLVR_TSTMP AS OMS_MUST_DLVR_TSTMP,
  OMS_SHIP_BY_DT AS OMS_SHIP_BY_DT,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  ORDER_QTY AS ORDER_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  PPACK_QTY AS PPACK_QTY,
  SHIPPED_QTY AS SHIPPED_QTY,
  ORIGINAL_PRICE_AMT AS ORIGINAL_PRICE_AMT,
  RETAIL_PRICE_AMT AS RETAIL_PRICE_AMT,
  UNIT_TAX_AMT AS UNIT_TAX_AMT,
  LINE_TOTAL_AMT AS LINE_TOTAL_AMT,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  OMS_EXT_CREATED_TSTMP AS OMS_EXT_CREATED_TSTMP,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_24"""

df_25 = spark.sql(query_25)

df_25.createOrReplaceTempView("SQ_Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_25")

# COMMAND ----------
# DBTITLE 1, Jnr_Facility_Origin_26


query_26 = f"""SELECT
  DETAIL.OMS_PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.OMS_O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.OMS_D_FACILITY_ALIAS_ID AS OMS_D_FACILITY_ALIAS_ID,
  DETAIL.D_FIRST_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDR_1 AS D_ADDRESS_1,
  DETAIL.D_ADDR_2 AS D_ADDRESS_2,
  DETAIL.D_ADDR_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CD AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CD AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NBR AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.OMS_BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.OMS_STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CD AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMT AS UNIT_TAX_AMOUNT,
  DETAIL.OMS_PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.OMS_DELIVERY_TZ_ID AS DELIVERY_TZ,
  DETAIL.OMS_PICKUP_TZ_ID AS PICKUP_TZ,
  DETAIL.OMS_PICKUP_START_TSTMP AS PICKUP_START_DTTM,
  DETAIL.OMS_PICKUP_END_TSTMP AS PICKUP_END_DTTM,
  DETAIL.OMS_DELIVERY_START_TSTMP AS DELIVERY_START_DTTM,
  DETAIL.OMS_DELIVERY_END_TSTMP AS DELIVERY_END_DTTM,
  DETAIL.OMS_REQ_DLVR_TSTMP AS REQ_DLVR_DTTM,
  DETAIL.OMS_MUST_DLVR_TSTMP AS MUST_DLVR_DTTM,
  DETAIL.OMS_SHIP_BY_DT AS SHIP_BY_DATE,
  DETAIL.READY_TO_SHIP_FLAG AS IS_READY_TO_SHIP,
  DETAIL.CANCELLED_FLAG AS IS_CANCELLED,
  DETAIL.CLOSED_FLAG AS IS_CLOSED,
  DETAIL.DELETED_FLAG AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.OMS_CREATED_SOURCE_TYPE_ID AS CREATED_SOURCE_TYPE,
  DETAIL.OMS_CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.OMS_CREATED_TSTMP AS CREATED_DTTM,
  DETAIL.OMS_LAST_UPDATED_TSTMP AS LAST_UPDATED_DTTM,
  DETAIL.OMS_DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.OMS_PURCHASE_ORDERS_LINE_STATUS_ID AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.OMS_TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.OMS_ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.DO_CREATED_FLAG AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE_AMT AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL_AMT AS LINE_TOTAL,
  DETAIL.OMS_REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION_ID AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE_FLAG AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE_AMT AS ORIGINAL_PRICE,
  DETAIL.OMS_REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_O_FACILITY_ID AS O_FACILITY_ID,
  DETAIL.OMS_D_FACILITY_ID AS OMS_D_FACILITY_ID,
  MASTER.OMS_FACILITY_ID AS OMS_FACILITY_ID,
  MASTER.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_FACILITY_6 MASTER
  RIGHT JOIN SQ_Shortcut_to_OMS_PURCHASE_ORDERS_LINE_ITEM_25 DETAIL ON MASTER.OMS_FACILITY_ID = DETAIL.OMS_O_FACILITY_ID"""

df_26 = spark.sql(query_26)

df_26.createOrReplaceTempView("Jnr_Facility_Origin_26")

# COMMAND ----------
# DBTITLE 1, Jnr_Facility_Destination_27


query_27 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.OMS_D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.OMS_D_FACILITY_ID AS D_FACILITY_ID,
  MASTER.OMS_FACILITY_ID AS OMS_FACILITY_ID,
  MASTER.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_FACILITY1_4 MASTER
  RIGHT JOIN Jnr_Facility_Origin_26 DETAIL ON MASTER.OMS_FACILITY_ID = DETAIL.OMS_D_FACILITY_ID"""

df_27 = spark.sql(query_27)

df_27.createOrReplaceTempView("Jnr_Facility_Destination_27")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_SYS_CODE1_28


query_28 = f"""SELECT
  OMS_REC_TYPE AS OMS_REC_TYPE,
  OMS_CODE_TYPE AS OMS_CODE_TYPE,
  OMS_CODE_ID AS OMS_CODE_ID,
  OMS_CODE_DESC AS OMS_CODE_DESC,
  OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  OMS_SYS_CODE_ID AS OMS_SYS_CODE_ID,
  OMS_SYS_CODE_TYPE_ID AS OMS_SYS_CODE_TYPE_ID,
  OMS_CREATE_TSTMP AS OMS_CREATE_TSTMP,
  OMS_MOD_TSTMP AS OMS_MOD_TSTMP,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_SYS_CODE"""

df_28 = spark.sql(query_28)

df_28.createOrReplaceTempView("Shortcut_to_OMS_SYS_CODE1_28")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_SYS_CODE1_29


query_29 = f"""SELECT
  OMS_REC_TYPE AS OMS_REC_TYPE,
  OMS_CODE_TYPE AS OMS_CODE_TYPE,
  OMS_CODE_ID AS OMS_CODE_ID,
  OMS_CODE_DESC AS OMS_CODE_DESC,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_SYS_CODE1_28
WHERE
  OMS_REC_TYPE = 'B'
  AND OMS_CODE_TYPE = '039'"""

df_29 = spark.sql(query_29)

df_29.createOrReplaceTempView("SQ_Shortcut_to_OMS_SYS_CODE1_29")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_SYS_CODE_30


query_30 = f"""SELECT
  OMS_REC_TYPE AS OMS_REC_TYPE,
  OMS_CODE_TYPE AS OMS_CODE_TYPE,
  OMS_CODE_ID AS OMS_CODE_ID,
  OMS_CODE_DESC AS OMS_CODE_DESC,
  OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  OMS_SYS_CODE_ID AS OMS_SYS_CODE_ID,
  OMS_SYS_CODE_TYPE_ID AS OMS_SYS_CODE_TYPE_ID,
  OMS_CREATE_TSTMP AS OMS_CREATE_TSTMP,
  OMS_MOD_TSTMP AS OMS_MOD_TSTMP,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_SYS_CODE"""

df_30 = spark.sql(query_30)

df_30.createOrReplaceTempView("Shortcut_to_OMS_SYS_CODE_30")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_SYS_CODE_31


query_31 = f"""SELECT
  OMS_REC_TYPE AS OMS_REC_TYPE,
  OMS_CODE_TYPE AS OMS_CODE_TYPE,
  OMS_CODE_ID AS OMS_CODE_ID,
  OMS_CODE_DESC AS OMS_CODE_DESC,
  OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_SYS_CODE_30
WHERE
  OMS_REC_TYPE = 'B'
  AND OMS_CODE_TYPE = '032'"""

df_31 = spark.sql(query_31)

df_31.createOrReplaceTempView("SQ_Shortcut_to_OMS_SYS_CODE_31")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_32


query_32 = f"""SELECT
  OMS_RETURN_ORDERS_LINE_ITEM_ID AS OMS_RETURN_ORDERS_LINE_ITEM_ID,
  OMS_RETURN_ORDERS_ID AS OMS_RETURN_ORDERS_ID,
  OMS_RETURN_REASON_ID AS OMS_RETURN_REASON_ID,
  OMS_RETURN_ACTION_ID AS OMS_RETURN_ACTION_ID,
  RECEIVABLE_FLAG AS RECEIVABLE_FLAG,
  EXPECTED_RECEIVING_CONDITION AS EXPECTED_RECEIVING_CONDITION,
  OMS_RECEIVING_VARIANCE_CD AS OMS_RECEIVING_VARIANCE_CD,
  UNIT_SHIPPING_HANDLING_CHARGE_AMT AS UNIT_SHIPPING_HANDLING_CHARGE_AMT,
  TOTAL_FEE AS TOTAL_FEE,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_RLM_RETURN_ORDERS_LINE_ITEM"""

df_32 = spark.sql(query_32)

df_32.createOrReplaceTempView("Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_32")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_33


query_33 = f"""SELECT
  OMS_RETURN_ORDERS_LINE_ITEM_ID AS OMS_RETURN_ORDERS_LINE_ITEM_ID,
  OMS_RETURN_ORDERS_ID AS OMS_RETURN_ORDERS_ID,
  OMS_RETURN_REASON_ID AS OMS_RETURN_REASON_ID,
  UNIT_SHIPPING_HANDLING_CHARGE_AMT AS UNIT_SHIPPING_HANDLING_CHARGE_AMT,
  TOTAL_FEE AS TOTAL_FEE,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_32"""

df_33 = spark.sql(query_33)

df_33.createOrReplaceTempView("SQ_Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_33")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_PURCHASE_ORDERS_34


query_34 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  OMS_EXT_PURCHASE_ORDERS_ID AS OMS_EXT_PURCHASE_ORDERS_ID,
  OMS_PARENT_PURCHASE_ORDERS_ID AS OMS_PARENT_PURCHASE_ORDERS_ID,
  OMS_PURCHASE_ORDERS_TYPE_ID AS OMS_PURCHASE_ORDERS_TYPE_ID,
  OMS_PURCHASE_ORDERS_STATUS_ID AS OMS_PURCHASE_ORDERS_STATUS_ID,
  OMS_ORDER_CATEGORY_ID AS OMS_ORDER_CATEGORY_ID,
  OMS_O_FACILITY_ID AS OMS_O_FACILITY_ID,
  OMS_O_FACILITY_ALIAS_ID AS OMS_O_FACILITY_ALIAS_ID,
  OMS_D_FACILITY_ID AS OMS_D_FACILITY_ID,
  OMS_D_FACILITY_ALIAS_ID AS OMS_D_FACILITY_ALIAS_ID,
  OMS_BILL_FACILITY_ID AS OMS_BILL_FACILITY_ID,
  OMS_BILL_FACILITY_ALIAS_ID AS OMS_BILL_FACILITY_ALIAS_ID,
  OMS_ORIGIN_SHIP_VIA_FACILITY_ALIAS_ID AS OMS_ORIGIN_SHIP_VIA_FACILITY_ALIAS_ID,
  OMS_ORIGIN_SHIP_VIA_FACILITY_ID AS OMS_ORIGIN_SHIP_VIA_FACILITY_ID,
  OMS_DES_SHIP_VIA_FACILITY_ALIAS_ID AS OMS_DES_SHIP_VIA_FACILITY_ALIAS_ID,
  OMS_DES_SHIP_VIA_FACILITY_ID AS OMS_DES_SHIP_VIA_FACILITY_ID,
  OMS_CUSTOMER_CD AS OMS_CUSTOMER_CD,
  CUSTOMER_FIRST_NAME AS CUSTOMER_FIRST_NAME,
  CUSTOMER_LAST_NAME AS CUSTOMER_LAST_NAME,
  CUSTOMER_PHONE_NBR AS CUSTOMER_PHONE_NBR,
  CUSTOMER_EMAIL AS CUSTOMER_EMAIL,
  OMS_RETURN_REFERENCE_NBR AS OMS_RETURN_REFERENCE_NBR,
  OMS_BILL_OF_LADING_NBR AS OMS_BILL_OF_LADING_NBR,
  OMS_TRANS_RESP_CD AS OMS_TRANS_RESP_CD,
  OMS_COMMODITY_CODE_ID AS OMS_COMMODITY_CODE_ID,
  OMS_CARRIER_ID AS OMS_CARRIER_ID,
  OMS_PRODUCT_CLASS_ID AS OMS_PRODUCT_CLASS_ID,
  OMS_PROTECTION_LEVEL_ID AS OMS_PROTECTION_LEVEL_ID,
  OMS_CREATION_TYPE_ID AS OMS_CREATION_TYPE_ID,
  OMS_CHANNEL_TYPE_ID AS OMS_CHANNEL_TYPE_ID,
  OMS_CHANNEL_ID AS OMS_CHANNEL_ID,
  OMS_FULFILL_MODE_ID AS OMS_FULFILL_MODE_ID,
  OMS_ENTERED_BY AS OMS_ENTERED_BY,
  OMS_ENTRY_CD AS OMS_ENTRY_CD,
  OMS_PAYMENT_MODE_ID AS OMS_PAYMENT_MODE_ID,
  OMS_PAYMENT_STATUS_ID AS OMS_PAYMENT_STATUS_ID,
  DROPOFF_PICKUP AS DROPOFF_PICKUP,
  ORDER_RECEIVED_FLAG AS ORDER_RECEIVED_FLAG,
  ON_HOLD_FLAG AS ON_HOLD_FLAG,
  HAS_ALERTS_FLAG AS HAS_ALERTS_FLAG,
  CANCELLED_FLAG AS CANCELLED_FLAG,
  CLOSED_FLAG AS CLOSED_FLAG,
  OMS_REASON_ID AS OMS_REASON_ID,
  OMS_DECLINE_REASON_ID AS OMS_DECLINE_REASON_ID,
  OMS_REASON_CODES_GROUP_ID AS OMS_REASON_CODES_GROUP_ID,
  IMPORTED_FLAG AS IMPORTED_FLAG,
  PURCHASE_ORDERS_RECONCILED_FLAG AS PURCHASE_ORDERS_RECONCILED_FLAG,
  READY_TO_SHIP_FLAG AS READY_TO_SHIP_FLAG,
  CUSTOMER_PICKUP_FLAG AS CUSTOMER_PICKUP_FLAG,
  DIRECT_ALLOWED_FLAG AS DIRECT_ALLOWED_FLAG,
  PARTIALLY_PLANNED_FLAG AS PARTIALLY_PLANNED_FLAG,
  OMS_PURCHASE_ORDERS_DT_TSTMP AS OMS_PURCHASE_ORDERS_DT_TSTMP,
  OMS_PICKUP_START_TSTMP AS OMS_PICKUP_START_TSTMP,
  OMS_PICKUP_END_TSTMP AS OMS_PICKUP_END_TSTMP,
  OMS_PICKUP_TZ_ID AS OMS_PICKUP_TZ_ID,
  OMS_DELIVERY_START_TSTMP AS OMS_DELIVERY_START_TSTMP,
  OMS_DELIVERY_END_TSTMP AS OMS_DELIVERY_END_TSTMP,
  OMS_DELIVERY_TZ_ID AS OMS_DELIVERY_TZ_ID,
  OMS_REQUESTED_DLVR_TSTMP AS OMS_REQUESTED_DLVR_TSTMP,
  OMS_MUST_DLVR_TSTMP AS OMS_MUST_DLVR_TSTMP,
  OMS_PROMISED_DLVR_TSTMP AS OMS_PROMISED_DLVR_TSTMP,
  OMS_DUE_DT AS OMS_DUE_DT,
  OMS_CANCEL_DT AS OMS_CANCEL_DT,
  OMS_RELEASE_TSTMP AS OMS_RELEASE_TSTMP,
  OMS_FIRST_RCPT_TSTMP AS OMS_FIRST_RCPT_TSTMP,
  OMS_LAST_RCPT_TSTMP AS OMS_LAST_RCPT_TSTMP,
  MONETARY_VALUE AS MONETARY_VALUE,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  ORIG_BUDG_COST AS ORIG_BUDG_COST,
  BUDG_COST AS BUDG_COST,
  BUDG_COST_CURRENCY_CD AS BUDG_COST_CURRENCY_CD,
  TAX_CHARGES_AMT AS TAX_CHARGES_AMT,
  MISC_CHARGES_AMT AS MISC_CHARGES_AMT,
  GRAND_TOTAL_AMT AS GRAND_TOTAL_AMT,
  FREIGHT_REVENUE_AMT AS FREIGHT_REVENUE_AMT,
  CURRENCY_CD AS CURRENCY_CD,
  OMS_CREATED_SOURCE_TYPE_ID AS OMS_CREATED_SOURCE_TYPE_ID,
  OMS_CREATED_SOURCE AS OMS_CREATED_SOURCE,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  OMS_LAST_UPDATED_TSTMP AS OMS_LAST_UPDATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_PURCHASE_ORDERS"""

df_34 = spark.sql(query_34)

df_34.createOrReplaceTempView("Shortcut_to_OMS_PURCHASE_ORDERS_34")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_PURCHASE_ORDERS_35


query_35 = f"""SELECT
  OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  OMS_ENTERED_BY AS OMS_ENTERED_BY,
  OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_PURCHASE_ORDERS_34"""

df_35 = spark.sql(query_35)

df_35.createOrReplaceTempView("SQ_Shortcut_to_OMS_PURCHASE_ORDERS_35")

# COMMAND ----------
# DBTITLE 1, JNR_PO_POL_36


query_36 = f"""SELECT
  MASTER.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  MASTER.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  MASTER.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  MASTER.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  MASTER.D_NAME AS D_NAME,
  MASTER.D_LAST_NAME AS D_LAST_NAME,
  MASTER.D_ADDRESS_1 AS D_ADDRESS_1,
  MASTER.D_ADDRESS_2 AS D_ADDRESS_2,
  MASTER.D_ADDRESS_3 AS D_ADDRESS_3,
  MASTER.D_CITY AS D_CITY,
  MASTER.D_STATE_PROV AS D_STATE_PROV,
  MASTER.D_POSTAL_CODE AS D_POSTAL_CODE,
  MASTER.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  MASTER.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  MASTER.D_EMAIL AS D_EMAIL,
  MASTER.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  MASTER.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  MASTER.SKU AS SKU,
  MASTER.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  MASTER.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  MASTER.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  MASTER.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  MASTER.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  MASTER.ALLOCATED_QTY AS ALLOCATED_QTY,
  MASTER.RELEASED_QTY AS RELEASED_QTY,
  MASTER.CANCELLED_QTY AS CANCELLED_QTY,
  MASTER.PPACK_QTY AS PPACK_QTY,
  MASTER.DELIVERY_TZ AS DELIVERY_TZ,
  MASTER.PICKUP_TZ AS PICKUP_TZ,
  MASTER.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  MASTER.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  MASTER.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  MASTER.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  MASTER.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  MASTER.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  MASTER.SHIP_BY_DATE AS SHIP_BY_DATE,
  MASTER.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  MASTER.IS_CANCELLED AS IS_CANCELLED,
  MASTER.IS_CLOSED AS IS_CLOSED,
  MASTER.IS_DELETED AS IS_DELETED,
  MASTER.SHIPPED_QTY AS SHIPPED_QTY,
  MASTER.RECEIVED_QTY AS RECEIVED_QTY,
  MASTER.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  MASTER.CREATED_SOURCE AS CREATED_SOURCE,
  MASTER.CREATED_DTTM AS CREATED_DTTM,
  MASTER.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  MASTER.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  MASTER.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  MASTER.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  MASTER.ORDER_QTY AS ORDER_QTY,
  MASTER.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  MASTER.IS_DO_CREATED AS IS_DO_CREATED,
  MASTER.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  MASTER.RETAIL_PRICE AS RETAIL_PRICE,
  MASTER.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  MASTER.LINE_TOTAL AS LINE_TOTAL,
  MASTER.REASON_ID AS REASON_ID,
  MASTER.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  MASTER.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  MASTER.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  MASTER.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  MASTER.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  MASTER.FACILITY_TYPE_BITS1 AS d_FACILITY_TYPE_BITS1,
  MASTER.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  MASTER.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  MASTER.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.UPDATE_TSTMP AS po_UPDATE_TSTMP,
  MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  Jnr_Facility_Destination_27 MASTER
  INNER JOIN SQ_Shortcut_to_OMS_PURCHASE_ORDERS_35 DETAIL ON MASTER.PURCHASE_ORDERS_ID = DETAIL.OMS_PURCHASE_ORDERS_ID"""

df_36 = spark.sql(query_36)

df_36.createOrReplaceTempView("JNR_PO_POL_36")

# COMMAND ----------
# DBTITLE 1, JNR_MO_37


query_37 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  MASTER.OMS_PURCHASE_ORDERS_ID AS mo_OMS_PURCHASE_ORDERS_ID1,
  MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS mo_OMS_PURCHASE_ORDERS_LINE_ITEM_ID,
  MASTER.ORDER_NBR AS mo_ORDER_NBR,
  MASTER.ORDER_FULFILLMENT_CHANNEL AS mo_ORDER_FULFILLMENT_CHANNEL,
  MASTER.ORDER_CREATION_CHANNEL AS mo_ORDER_CREATION_CHANNEL,
  MASTER.ORDER_CHANNEL AS mo_ORDER_CHANNEL,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.d_FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_EDW_LOAD_CTRL_PRE_10 MASTER
  INNER JOIN JNR_PO_POL_36 DETAIL ON MASTER.OMS_PURCHASE_ORDERS_ID = DETAIL.PURCHASE_ORDERS_ID
  AND MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID = DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID"""

df_37 = spark.sql(query_37)

df_37.createOrReplaceTempView("JNR_MO_37")

# COMMAND ----------
# DBTITLE 1, JNR_ACD_38


query_38 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_PURCHASE_ORDERS_ID AS OMS_PURCHASE_ORDERS_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.mo_ORDER_NBR AS ORDER_NBR,
  DETAIL.mo_ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.mo_ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.mo_ORDER_CHANNEL AS ORDER_CHANNEL,
  MASTER.ENTITY_ID AS ENTITY_ID,
  MASTER.ENTITY_LINE_ID AS ENTITY_LINE_ID,
  MASTER.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  MASTER.CHARGE_NAME AS CHARGE_NAME,
  MASTER.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  MASTER.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  Fil_Mark_for_deletion_21 MASTER
  RIGHT JOIN JNR_MO_37 DETAIL ON MASTER.ENTITY_ID = DETAIL.PURCHASE_ORDERS_ID
  AND MASTER.ENTITY_LINE_ID = DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID"""

df_38 = spark.sql(query_38)

df_38.createOrReplaceTempView("JNR_ACD_38")

# COMMAND ----------
# DBTITLE 1, JNR_SYS_CODE_39


query_39 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  MASTER.OMS_CODE_ID AS CODE_ID,
  MASTER.OMS_CODE_DESC AS CODE_DESC,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_SYS_CODE1_29 MASTER
  RIGHT JOIN JNR_ACD_38 DETAIL ON MASTER.OMS_CODE_ID = DETAIL.CHARGE_CATEGORY"""

df_39 = spark.sql(query_39)

df_39.createOrReplaceTempView("JNR_SYS_CODE_39")

# COMMAND ----------
# DBTITLE 1, JNR_ADD_ON_FLAG_40


query_40 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  MASTER.OMS_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS poli_PURCHASE_ORDERS_LINE_ITEM_ID,
  MASTER.REF_FIELD3 AS poli_REF_FIELD3,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_PO_LINE_ITEM_REF_FIELDS_17 MASTER
  RIGHT JOIN JNR_SYS_CODE_39 DETAIL ON MASTER.OMS_PURCHASE_ORDERS_ID = DETAIL.PURCHASE_ORDERS_ID
  AND MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID = DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID"""

df_40 = spark.sql(query_40)

df_40.createOrReplaceTempView("JNR_ADD_ON_FLAG_40")

# COMMAND ----------
# DBTITLE 1, JNR_REF_FEILDS_41


query_41 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.poli_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  MASTER.polr_PURCHASE_ORDERS_ID AS polr_PURCHASE_ORDERS_ID1,
  MASTER.SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  MASTER.SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  Agg_POLR_15 MASTER
  RIGHT JOIN JNR_ADD_ON_FLAG_40 DETAIL ON MASTER.polr_PURCHASE_ORDERS_ID = DETAIL.PURCHASE_ORDERS_ID"""

df_41 = spark.sql(query_41)

df_41.createOrReplaceTempView("JNR_REF_FEILDS_41")

# COMMAND ----------
# DBTITLE 1, JNR_RETURN_ORDERS_42


query_42 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  DETAIL.SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.poli_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  MASTER.OMS_RETURN_ORDERS_ID AS RETURN_ORDERS_ID,
  MASTER.OMS_RETURN_ORDERS_LINE_ITEM_ID AS RETURN_ORDERS_LINE_ITEM_ID,
  MASTER.OMS_RETURN_REASON_ID AS RETURN_REASON_ID,
  MASTER.UNIT_SHIPPING_HANDLING_CHARGE_AMT AS UNIT_SHIPPING_HANDLING_CHARGE,
  MASTER.TOTAL_FEE AS TOTAL_FEE,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  DETAIL.ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_RLM_RETURN_ORDERS_LINE_ITEM_33 MASTER
  RIGHT JOIN JNR_REF_FEILDS_41 DETAIL ON MASTER.OMS_RETURN_ORDERS_ID = DETAIL.PURCHASE_ORDERS_ID
  AND MASTER.OMS_RETURN_ORDERS_LINE_ITEM_ID = DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID"""

df_42 = spark.sql(query_42)

df_42.createOrReplaceTempView("JNR_RETURN_ORDERS_42")

# COMMAND ----------
# DBTITLE 1, JNR_SYS_CODE2_43


query_43 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.OMS_ENTERED_BY AS OMS_ENTERED_BY,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CHARGE_CATEGORY AS CHARGE_CATEGORY,
  DETAIL.SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.poli_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  DETAIL.RETURN_REASON_ID AS RETURN_REASON_ID,
  DETAIL.UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  DETAIL.TOTAL_FEE AS TOTAL_FEE,
  MASTER.OMS_CODE_ID AS OMS_CODE_ID,
  MASTER.OMS_CODE_DESC AS OMS_CODE_DESC,
  MASTER.OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  DETAIL.ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  DETAIL.rro_UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS sc2_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_SYS_CODE_31 MASTER
  RIGHT JOIN JNR_RETURN_ORDERS_42 DETAIL ON MASTER.OMS_CODE_ID = DETAIL.RETURN_REASON_ID"""

df_43 = spark.sql(query_43)

df_43.createOrReplaceTempView("JNR_SYS_CODE2_43")

# COMMAND ----------
# DBTITLE 1, JNR_ACR_44


query_44 = f"""SELECT
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.poli_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  DETAIL.RETURN_REASON_ID AS RETURN_REASON_ID,
  DETAIL.UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  DETAIL.TOTAL_FEE AS TOTAL_FEE,
  DETAIL.OMS_CODE_DESC AS OMS_CODE_DESC,
  DETAIL.OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  MASTER.OMS_REASON_CODE_ID AS REASON_CODE_ID,
  MASTER.OMS_REASON_CD AS REASON_CODE,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.FACILITY_TYPE_BITS AS FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  DETAIL.ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  DETAIL.rro_UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  DETAIL.sc2_UPDATE_TSTMP AS sc2_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS acr_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_A_CO_REASON_CODE_8 MASTER
  RIGHT JOIN JNR_SYS_CODE2_43 DETAIL ON MASTER.OMS_REASON_CODE_ID = DETAIL.REASON_ID"""

df_44 = spark.sql(query_44)

df_44.createOrReplaceTempView("JNR_ACR_44")

# COMMAND ----------
# DBTITLE 1, JNR_ATTR_45


query_45 = f"""SELECT
  MASTER.OMS_PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID,
  MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID,
  MASTER.ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  DETAIL.PURCHASE_ORDERS_ID AS PURCHASE_ORDERS_ID1,
  DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID AS PURCHASE_ORDERS_LINE_ITEM_ID1,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS_1 AS D_ADDRESS_1,
  DETAIL.D_ADDRESS_2 AS D_ADDRESS_2,
  DETAIL.D_ADDRESS_3 AS D_ADDRESS_3,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.OMS_TC_PURCHASE_ORDERS_ID AS OMS_TC_PURCHASE_ORDERS_ID,
  DETAIL.OMS_CREATED_TSTMP AS OMS_CREATED_TSTMP,
  DETAIL.SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.poli_PURCHASE_ORDERS_ID AS poli_PURCHASE_ORDERS_ID,
  DETAIL.RETURN_REASON_ID AS RETURN_REASON_ID,
  DETAIL.UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  DETAIL.TOTAL_FEE AS TOTAL_FEE,
  DETAIL.OMS_CODE_DESC AS OMS_CODE_DESC,
  DETAIL.OMS_CODE_SHORT_DESC AS OMS_CODE_SHORT_DESC,
  DETAIL.REASON_CODE_ID AS REASON_CODE_ID,
  DETAIL.REASON_CODE AS REASON_CODE,
  DETAIL.OMS_TC_COMPANY_ID AS OMS_TC_COMPANY_ID,
  DETAIL.FACILITY_TYPE_BITS AS o_FACILITY_TYPE_BITS,
  DETAIL.FACILITY_TYPE_BITS1 AS d_FACILITY_TYPE_BITS1,
  DETAIL.pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  DETAIL.f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  DETAIL.f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  DETAIL.po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  DETAIL.acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  DETAIL.sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  DETAIL.ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  DETAIL.ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  DETAIL.rro_UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  DETAIL.sc2_UPDATE_TSTMP AS sc2_UPDATE_TSTMP,
  DETAIL.acr_UPDATE_TSTMP AS acr_UPDATE_TSTMP,
  MASTER.UPDATE_TSTMP AS attr_UPDATE_TSTMP,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_PO_LINE_ITEM_ATTRIBUTE_23 MASTER
  RIGHT JOIN JNR_ACR_44 DETAIL ON MASTER.OMS_PURCHASE_ORDERS_ID = DETAIL.PURCHASE_ORDERS_ID
  AND MASTER.OMS_PURCHASE_ORDERS_LINE_ITEM_ID = DETAIL.PURCHASE_ORDERS_LINE_ITEM_ID"""

df_45 = spark.sql(query_45)

df_45.createOrReplaceTempView("JNR_ATTR_45")

# COMMAND ----------
# DBTITLE 1, EXP_PRE_46


query_46 = f"""SELECT
  TO_INTEGER(PURCHASE_ORDERS_ID1) AS o_PURCHASE_ORDERS_ID,
  TO_INTEGER(PURCHASE_ORDERS_LINE_ITEM_ID1) AS o_PURCHASE_ORDERS_LINE_ITEM_ID,
  OMS_TC_COMPANY_ID AS TC_COMPANY_ID,
  O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  D_NAME AS D_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  LTRIM(RTRIM(D_ADDRESS_1)) || ' ' || LTRIM(RTRIM(D_ADDRESS_2)) || ' ' || LTRIM(RTRIM(D_ADDRESS_3)) AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CODE AS D_POSTAL_CODE,
  D_COUNTRY_CODE AS D_COUNTRY_CODE,
  D_PHONE_NUMBER AS D_PHONE_NUMBER,
  D_EMAIL AS D_EMAIL,
  BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  SKU AS SKU,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  PPACK_QTY AS PPACK_QTY,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  SHIP_BY_DATE AS SHIP_BY_DATE,
  IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  IS_CANCELLED AS IS_CANCELLED,
  IS_CLOSED AS IS_CLOSED,
  IS_DELETED AS IS_DELETED,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  TC_PO_LINE_ID AS TC_PO_LINE_ID,
  ORDER_QTY AS ORDER_QTY,
  ALLOC_FINALIZER AS ALLOC_FINALIZER,
  IS_DO_CREATED AS IS_DO_CREATED,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RETAIL_PRICE AS RETAIL_PRICE,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  LINE_TOTAL AS LINE_TOTAL,
  REASON_ID AS REASON_ID,
  ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  PRICE_OVERRIDE AS PRICE_OVERRIDE,
  ORIGINAL_PRICE AS ORIGINAL_PRICE,
  REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  ORDER_NBR AS ORDER_NBR,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  OMS_CREATED_TSTMP AS CREATED_DTTM1,
  IFF(ISNULL(SCHED_DELIVERY_FLG), 0, SCHED_DELIVERY_FLG) AS o_SCHED_DELIVERY_FLG,
  IFF(
    ISNULL(SUBSCRIPTION_ORDER_FLG),
    0,
    SUBSCRIPTION_ORDER_FLG
  ) AS o_SUBSCRIPTION_ORDER_FLG,
  CHARGE_NAME AS CHARGE_NAME,
  CHARGE_AMOUNT AS CHARGE_AMOUNT,
  ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  CODE_DESC AS CODE_DESC,
  IFF(NOT ISNULL(poli_PURCHASE_ORDERS_ID), 1, 0) AS ADD_ON_FLAG,
  RETURN_REASON_ID AS RETURN_REASON_ID,
  UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  TOTAL_FEE AS TOTAL_FEE,
  OMS_CODE_DESC AS RETURN_CODE_DESC,
  OMS_CODE_SHORT_DESC AS RETURN_SHORT_DESC,
  REASON_CODE AS REASON_CODE,
  IFF (
    IS_CANCELLED = 1
    AND PURCHASE_ORDERS_LINE_STATUS = 940,
    LAST_UPDATED_DTTM,
    NULL
  ) AS CANCELLED_DTTM,
  o_FACILITY_TYPE_BITS AS O_FACILITY_TYPE_BITS,
  d_FACILITY_TYPE_BITS1 AS D_FACILITY_TYPE_BITS,
  ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  rro_UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  sc2_UPDATE_TSTMP AS sc2_UPDATE_TSTMP,
  acr_UPDATE_TSTMP AS acr_UPDATE_TSTMP,
  attr_UPDATE_TSTMP AS attr_UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  JNR_ATTR_45"""

df_46 = spark.sql(query_46)

df_46.createOrReplaceTempView("EXP_PRE_46")

# COMMAND ----------
# DBTITLE 1, FIL_UPDATE_TSTMP_47


query_47 = f"""SELECT
  o_PURCHASE_ORDERS_ID AS o_PURCHASE_ORDERS_ID,
  o_PURCHASE_ORDERS_LINE_ITEM_ID AS o_PURCHASE_ORDERS_LINE_ITEM_ID,
  TC_COMPANY_ID AS TC_COMPANY_ID,
  O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  D_NAME AS D_NAME,
  D_LAST_NAME AS D_LAST_NAME,
  D_ADDRESS AS D_ADDRESS,
  D_CITY AS D_CITY,
  D_STATE_PROV AS D_STATE_PROV,
  D_POSTAL_CODE AS D_POSTAL_CODE,
  D_COUNTRY_CODE AS D_COUNTRY_CODE,
  D_PHONE_NUMBER AS D_PHONE_NUMBER,
  D_EMAIL AS D_EMAIL,
  BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  SKU AS SKU,
  MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  PPACK_QTY AS PPACK_QTY,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  PICKUP_START_DTTM AS PICKUP_START_DTTM,
  PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  SHIP_BY_DATE AS SHIP_BY_DATE,
  IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  IS_CANCELLED AS IS_CANCELLED,
  IS_CLOSED AS IS_CLOSED,
  IS_DELETED AS IS_DELETED,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_DTTM AS CREATED_DTTM,
  LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  TC_PO_LINE_ID AS TC_PO_LINE_ID,
  ORDER_QTY AS ORDER_QTY,
  ALLOC_FINALIZER AS ALLOC_FINALIZER,
  IS_DO_CREATED AS IS_DO_CREATED,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RETAIL_PRICE AS RETAIL_PRICE,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  LINE_TOTAL AS LINE_TOTAL,
  REASON_ID AS REASON_ID,
  ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  PRICE_OVERRIDE AS PRICE_OVERRIDE,
  ORIGINAL_PRICE AS ORIGINAL_PRICE,
  REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  ORDER_NBR AS ORDER_NBR,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  CREATED_DTTM1 AS CREATED_DTTM1,
  o_SCHED_DELIVERY_FLG AS o_SCHED_DELIVERY_FLG,
  o_SUBSCRIPTION_ORDER_FLG AS o_SUBSCRIPTION_ORDER_FLG,
  CHARGE_NAME AS CHARGE_NAME,
  CHARGE_AMOUNT AS CHARGE_AMOUNT,
  ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  CODE_DESC AS CODE_DESC,
  ADD_ON_FLAG AS ADD_ON_FLAG,
  RETURN_REASON_ID AS RETURN_REASON_ID,
  UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  TOTAL_FEE AS TOTAL_FEE,
  RETURN_CODE_DESC AS RETURN_CODE_DESC,
  RETURN_SHORT_DESC AS RETURN_SHORT_DESC,
  REASON_CODE AS REASON_CODE,
  CANCELLED_DTTM AS CANCELLED_DTTM,
  O_FACILITY_TYPE_BITS AS O_FACILITY_TYPE_BITS,
  D_FACILITY_TYPE_BITS AS D_FACILITY_TYPE_BITS,
  ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  pol_UPDATE_TSTMP AS pol_UPDATE_TSTMP,
  f1_UPDATE_TSTMP AS f1_UPDATE_TSTMP,
  f2_UPDATE_TSTMP AS f2_UPDATE_TSTMP,
  po_UPDATE_TSTMP AS po_UPDATE_TSTMP,
  acd_UPDATE_TSTMP AS acd_UPDATE_TSTMP,
  sc1_UPDATE_TSTMP AS sc1_UPDATE_TSTMP,
  ref1_UPDATE_TSTMP AS ref1_UPDATE_TSTMP,
  ref2_UPDATE_TSTMP AS ref2_UPDATE_TSTMP,
  rro_UPDATE_TSTMP AS rro_UPDATE_TSTMP,
  sc2_UPDATE_TSTMP AS sc2_UPDATE_TSTMP,
  acr_UPDATE_TSTMP AS acr_UPDATE_TSTMP,
  attr_UPDATE_TSTMP AS attr_UPDATE_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  EXP_PRE_46
WHERE
  pol_UPDATE_TSTMP > TRUNC(now())
  OR f1_UPDATE_TSTMP > TRUNC(now())
  OR f2_UPDATE_TSTMP > TRUNC(now())
  OR po_UPDATE_TSTMP > TRUNC(now())
  OR acd_UPDATE_TSTMP > TRUNC(now())
  OR sc1_UPDATE_TSTMP > TRUNC(now())
  OR ref1_UPDATE_TSTMP > TRUNC(now())
  OR ref2_UPDATE_TSTMP > TRUNC(now())
  OR rro_UPDATE_TSTMP > TRUNC(now())
  OR sc2_UPDATE_TSTMP > TRUNC(now())
  OR acr_UPDATE_TSTMP > TRUNC(now())
  OR attr_UPDATE_TSTMP > TRUNC(now())"""

df_47 = spark.sql(query_47)

df_47.createOrReplaceTempView("FIL_UPDATE_TSTMP_47")

# COMMAND ----------
# DBTITLE 1, Shortcut_to_OMS_ORDER_LN_48


query_48 = f"""SELECT
  OMS_ORDER_ID AS OMS_ORDER_ID,
  OMS_ORDER_LN_ID AS OMS_ORDER_LN_ID,
  OMS_COMPANY_ID AS OMS_COMPANY_ID,
  ORIG_LOCATION_NBR AS ORIG_LOCATION_NBR,
  ORIG_LOCATION_ID AS ORIG_LOCATION_ID,
  DEST_LOCATION_NBR AS DEST_LOCATION_NBR,
  DEST_LOCATION_ID AS DEST_LOCATION_ID,
  SHIP_NAME AS SHIP_NAME,
  SHIP_LAST_NAME AS SHIP_LAST_NAME,
  SHIP_ADDRESS AS SHIP_ADDRESS,
  SHIP_CITY AS SHIP_CITY,
  SHIP_STATE AS SHIP_STATE,
  SHIP_POSTAL_CD AS SHIP_POSTAL_CD,
  SHIP_COUNTRY_CD AS SHIP_COUNTRY_CD,
  SHIP_PHONE AS SHIP_PHONE,
  SHIP_EMAIL AS SHIP_EMAIL,
  BILL_LOCATION_NBR AS BILL_LOCATION_NBR,
  BILL_LOCATION_ID AS BILL_LOCATION_ID,
  STORE_LOCATION_NBR AS STORE_LOCATION_NBR,
  STORE_LOCATION_ID AS STORE_LOCATION_ID,
  PRODUCT_ID AS PRODUCT_ID,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  TOTAL_MONETARY_VALUE_AMT AS TOTAL_MONETARY_VALUE_AMT,
  UNIT_MONETARY_VALUE_AMT AS UNIT_MONETARY_VALUE_AMT,
  UNIT_TAX_AMOUNT_AMT AS UNIT_TAX_AMOUNT_AMT,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  PPACK_QTY AS PPACK_QTY,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  REQ_DLVR_DT AS REQ_DLVR_DT,
  MUST_DLVR_DT AS MUST_DLVR_DT,
  SHIP_BY_DT AS SHIP_BY_DT,
  READY_TO_SHIP_FLG AS READY_TO_SHIP_FLG,
  CANCELLED_FLG AS CANCELLED_FLG,
  CLOSED_FLG AS CLOSED_FLG,
  DELETED_FLG AS DELETED_FLG,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  OMS_ORDER_LN_STATUS_ID AS OMS_ORDER_LN_STATUS_ID,
  OMS_ORDER_LN_NBR AS OMS_ORDER_LN_NBR,
  ORDER_QTY AS ORDER_QTY,
  ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DIST_ORDER_CREATED_FLG AS DIST_ORDER_CREATED_FLG,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RETAIL_PRICE AS RETAIL_PRICE,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  LINE_TOTAL AS LINE_TOTAL,
  REASON_ID AS REASON_ID,
  ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  PRICE_OVERRIDE_FLG AS PRICE_OVERRIDE_FLG,
  ORIGINAL_PRICE_AMT AS ORIGINAL_PRICE_AMT,
  REASON_CDS_GROUP_ID AS REASON_CDS_GROUP_ID,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  ORDER_NBR AS ORDER_NBR,
  OMS_ORDER_CREATED_TSTMP AS OMS_ORDER_CREATED_TSTMP,
  SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  ADD_ON_FLAG AS ADD_ON_FLAG,
  SHIP_CHARGE_NAME AS SHIP_CHARGE_NAME,
  SHIP_CHARGE_AMT AS SHIP_CHARGE_AMT,
  ORIG_SHIP_CHARGE_AMT AS ORIG_SHIP_CHARGE_AMT,
  SHIP_CHARGE_DESC AS SHIP_CHARGE_DESC,
  RETURN_REASON_ID AS RETURN_REASON_ID,
  RETURN_SHIP_HANDLING_AMT AS RETURN_SHIP_HANDLING_AMT,
  RETURN_TOTAL_FEE_AMT AS RETURN_TOTAL_FEE_AMT,
  RETURN_CODE_DESC AS RETURN_CODE_DESC,
  RETURN_SHORT_DESC AS RETURN_SHORT_DESC,
  CANCEL_REASON_DESC AS CANCEL_REASON_DESC,
  CANCELLED_TSTMP AS CANCELLED_TSTMP,
  EXCHANGE_RATE_PCNT AS EXCHANGE_RATE_PCNT,
  TRACKING_NBR AS TRACKING_NBR,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP
FROM
  OMS_ORDER_LN"""

df_48 = spark.sql(query_48)

df_48.createOrReplaceTempView("Shortcut_to_OMS_ORDER_LN_48")

# COMMAND ----------
# DBTITLE 1, SQ_Shortcut_to_OMS_ORDER_LN_49


query_49 = f"""SELECT
  OMS_ORDER_ID AS OMS_ORDER_ID,
  OMS_ORDER_LN_ID AS OMS_ORDER_LN_ID,
  OMS_COMPANY_ID AS OMS_COMPANY_ID,
  ORIG_LOCATION_NBR AS ORIG_LOCATION_NBR,
  ORIG_LOCATION_ID AS ORIG_LOCATION_ID,
  DEST_LOCATION_NBR AS DEST_LOCATION_NBR,
  DEST_LOCATION_ID AS DEST_LOCATION_ID,
  SHIP_NAME AS SHIP_NAME,
  SHIP_LAST_NAME AS SHIP_LAST_NAME,
  SHIP_ADDRESS AS SHIP_ADDRESS,
  SHIP_CITY AS SHIP_CITY,
  SHIP_STATE AS SHIP_STATE,
  SHIP_POSTAL_CD AS SHIP_POSTAL_CD,
  SHIP_COUNTRY_CD AS SHIP_COUNTRY_CD,
  SHIP_PHONE AS SHIP_PHONE,
  SHIP_EMAIL AS SHIP_EMAIL,
  BILL_LOCATION_NBR AS BILL_LOCATION_NBR,
  BILL_LOCATION_ID AS BILL_LOCATION_ID,
  STORE_LOCATION_NBR AS STORE_LOCATION_NBR,
  STORE_LOCATION_ID AS STORE_LOCATION_ID,
  PRODUCT_ID AS PRODUCT_ID,
  MV_CURRENCY_CD AS MV_CURRENCY_CD,
  TOTAL_MONETARY_VALUE_AMT AS TOTAL_MONETARY_VALUE_AMT,
  UNIT_MONETARY_VALUE_AMT AS UNIT_MONETARY_VALUE_AMT,
  UNIT_TAX_AMOUNT_AMT AS UNIT_TAX_AMOUNT_AMT,
  PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  ALLOCATED_QTY AS ALLOCATED_QTY,
  RELEASED_QTY AS RELEASED_QTY,
  CANCELLED_QTY AS CANCELLED_QTY,
  PPACK_QTY AS PPACK_QTY,
  DELIVERY_TZ AS DELIVERY_TZ,
  PICKUP_TZ AS PICKUP_TZ,
  PICKUP_START_DT AS PICKUP_START_DT,
  PICKUP_END_DT AS PICKUP_END_DT,
  DELIVERY_START_DT AS DELIVERY_START_DT,
  DELIVERY_END_DT AS DELIVERY_END_DT,
  REQ_DLVR_DT AS REQ_DLVR_DT,
  MUST_DLVR_DT AS MUST_DLVR_DT,
  SHIP_BY_DT AS SHIP_BY_DT,
  READY_TO_SHIP_FLG AS READY_TO_SHIP_FLG,
  CANCELLED_FLG AS CANCELLED_FLG,
  CLOSED_FLG AS CLOSED_FLG,
  DELETED_FLG AS DELETED_FLG,
  SHIPPED_QTY AS SHIPPED_QTY,
  RECEIVED_QTY AS RECEIVED_QTY,
  CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS CREATED_SOURCE,
  CREATED_TSTMP AS CREATED_TSTMP,
  LAST_UPDATED_TSTMP AS LAST_UPDATED_TSTMP,
  DSG_CARRIER_ID AS DSG_CARRIER_ID,
  OMS_ORDER_LN_STATUS_ID AS OMS_ORDER_LN_STATUS_ID,
  OMS_ORDER_LN_NBR AS OMS_ORDER_LN_NBR,
  ORDER_QTY AS ORDER_QTY,
  ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DIST_ORDER_CREATED_FLG AS DIST_ORDER_CREATED_FLG,
  ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  RETAIL_PRICE AS RETAIL_PRICE,
  DSG_SHIP_VIA AS DSG_SHIP_VIA,
  LINE_TOTAL AS LINE_TOTAL,
  REASON_ID AS REASON_ID,
  ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  PRICE_OVERRIDE_FLG AS PRICE_OVERRIDE_FLG,
  ORIGINAL_PRICE_AMT AS ORIGINAL_PRICE_AMT,
  REASON_CDS_GROUP_ID AS REASON_CDS_GROUP_ID,
  ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS ORDER_CHANNEL,
  ORDER_NBR AS ORDER_NBR,
  OMS_ORDER_CREATED_TSTMP AS OMS_ORDER_CREATED_TSTMP,
  SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  ADD_ON_FLAG AS ADD_ON_FLAG,
  SHIP_CHARGE_NAME AS SHIP_CHARGE_NAME,
  SHIP_CHARGE_AMT AS SHIP_CHARGE_AMT,
  ORIG_SHIP_CHARGE_AMT AS ORIG_SHIP_CHARGE_AMT,
  SHIP_CHARGE_DESC AS SHIP_CHARGE_DESC,
  RETURN_REASON_ID AS RETURN_REASON_ID,
  RETURN_SHIP_HANDLING_AMT AS RETURN_SHIP_HANDLING_AMT,
  RETURN_TOTAL_FEE_AMT AS RETURN_TOTAL_FEE_AMT,
  RETURN_CODE_DESC AS RETURN_CODE_DESC,
  RETURN_SHORT_DESC AS RETURN_SHORT_DESC,
  CANCEL_REASON_DESC AS CANCEL_REASON_DESC,
  CANCELLED_TSTMP AS CANCELLED_TSTMP,
  EXCHANGE_RATE_PCNT AS EXCHANGE_RATE_PCNT,
  TRACKING_NBR AS TRACKING_NBR,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  monotonically_increasing_id() AS Monotonically_Increasing_Id
FROM
  Shortcut_to_OMS_ORDER_LN_48"""

df_49 = spark.sql(query_49)

df_49.createOrReplaceTempView("SQ_Shortcut_to_OMS_ORDER_LN_49")

# COMMAND ----------
# DBTITLE 1, JNR_OMS_ORDER_LN_50


query_50 = f"""SELECT
  DETAIL.o_PURCHASE_ORDERS_ID AS o_PURCHASE_ORDERS_ID,
  DETAIL.o_PURCHASE_ORDERS_LINE_ITEM_ID AS o_PURCHASE_ORDERS_LINE_ITEM_ID,
  DETAIL.TC_COMPANY_ID AS TC_COMPANY_ID,
  DETAIL.O_FACILITY_ALIAS_ID AS O_FACILITY_ALIAS_ID,
  DETAIL.D_FACILITY_ALIAS_ID AS D_FACILITY_ALIAS_ID,
  DETAIL.D_NAME AS D_NAME,
  DETAIL.D_LAST_NAME AS D_LAST_NAME,
  DETAIL.D_ADDRESS AS D_ADDRESS,
  DETAIL.D_CITY AS D_CITY,
  DETAIL.D_STATE_PROV AS D_STATE_PROV,
  DETAIL.D_POSTAL_CODE AS D_POSTAL_CODE,
  DETAIL.D_COUNTRY_CODE AS D_COUNTRY_CODE,
  DETAIL.D_PHONE_NUMBER AS D_PHONE_NUMBER,
  DETAIL.D_EMAIL AS D_EMAIL,
  DETAIL.BILL_FACILITY_ALIAS_ID AS BILL_FACILITY_ALIAS_ID,
  DETAIL.STORE_FACILITY_ALIAS_ID AS STORE_FACILITY_ALIAS_ID,
  DETAIL.SKU AS SKU,
  DETAIL.MV_CURRENCY_CODE AS MV_CURRENCY_CODE,
  DETAIL.TOTAL_MONETARY_VALUE AS TOTAL_MONETARY_VALUE,
  DETAIL.UNIT_MONETARY_VALUE AS UNIT_MONETARY_VALUE,
  DETAIL.UNIT_TAX_AMOUNT AS UNIT_TAX_AMOUNT,
  DETAIL.PRODUCT_CLASS_ID AS PRODUCT_CLASS_ID,
  DETAIL.ALLOCATED_QTY AS ALLOCATED_QTY,
  DETAIL.RELEASED_QTY AS RELEASED_QTY,
  DETAIL.CANCELLED_QTY AS CANCELLED_QTY,
  DETAIL.PPACK_QTY AS PPACK_QTY,
  DETAIL.DELIVERY_TZ AS DELIVERY_TZ,
  DETAIL.PICKUP_TZ AS PICKUP_TZ,
  DETAIL.PICKUP_START_DTTM AS PICKUP_START_DTTM,
  DETAIL.PICKUP_END_DTTM AS PICKUP_END_DTTM,
  DETAIL.DELIVERY_START_DTTM AS DELIVERY_START_DTTM,
  DETAIL.DELIVERY_END_DTTM AS DELIVERY_END_DTTM,
  DETAIL.REQ_DLVR_DTTM AS REQ_DLVR_DTTM,
  DETAIL.MUST_DLVR_DTTM AS MUST_DLVR_DTTM,
  DETAIL.SHIP_BY_DATE AS SHIP_BY_DATE,
  DETAIL.IS_READY_TO_SHIP AS IS_READY_TO_SHIP,
  DETAIL.IS_CANCELLED AS IS_CANCELLED,
  DETAIL.IS_CLOSED AS IS_CLOSED,
  DETAIL.IS_DELETED AS IS_DELETED,
  DETAIL.SHIPPED_QTY AS SHIPPED_QTY,
  DETAIL.RECEIVED_QTY AS RECEIVED_QTY,
  DETAIL.CREATED_SOURCE_TYPE AS CREATED_SOURCE_TYPE,
  DETAIL.CREATED_SOURCE AS CREATED_SOURCE,
  DETAIL.CREATED_DTTM AS CREATED_DTTM,
  DETAIL.LAST_UPDATED_DTTM AS LAST_UPDATED_DTTM,
  DETAIL.DSG_CARRIER_ID AS DSG_CARRIER_ID,
  DETAIL.PURCHASE_ORDERS_LINE_STATUS AS PURCHASE_ORDERS_LINE_STATUS,
  DETAIL.TC_PO_LINE_ID AS TC_PO_LINE_ID,
  DETAIL.ORDER_QTY AS ORDER_QTY,
  DETAIL.ALLOC_FINALIZER AS ALLOC_FINALIZER,
  DETAIL.IS_DO_CREATED AS IS_DO_CREATED,
  DETAIL.ORIG_ORDER_QTY AS ORIG_ORDER_QTY,
  DETAIL.RETAIL_PRICE AS RETAIL_PRICE,
  DETAIL.DSG_SHIP_VIA AS DSG_SHIP_VIA,
  DETAIL.LINE_TOTAL AS LINE_TOTAL,
  DETAIL.REASON_ID AS REASON_ID,
  DETAIL.ORDER_FULFILLMENT_OPTION AS ORDER_FULFILLMENT_OPTION,
  DETAIL.PRICE_OVERRIDE AS PRICE_OVERRIDE,
  DETAIL.ORIGINAL_PRICE AS ORIGINAL_PRICE,
  DETAIL.REASON_CODES_GROUP_ID AS REASON_CODES_GROUP_ID,
  DETAIL.ORDER_NBR AS ORDER_NBR,
  DETAIL.ORDER_FULFILLMENT_CHANNEL AS ORDER_FULFILLMENT_CHANNEL,
  DETAIL.ORDER_CREATION_CHANNEL AS ORDER_CREATION_CHANNEL,
  DETAIL.ORDER_CHANNEL AS ORDER_CHANNEL,
  DETAIL.CREATED_DTTM1 AS CREATED_DTTM1,
  DETAIL.o_SCHED_DELIVERY_FLG AS SCHED_DELIVERY_FLG,
  DETAIL.o_SUBSCRIPTION_ORDER_FLG AS SUBSCRIPTION_ORDER_FLG,
  DETAIL.CHARGE_NAME AS CHARGE_NAME,
  DETAIL.CHARGE_AMOUNT AS CHARGE_AMOUNT,
  DETAIL.ORIGINAL_CHARGE_AMOUNT AS ORIGINAL_CHARGE_AMOUNT,
  DETAIL.CODE_DESC AS CODE_DESC,
  DETAIL.ADD_ON_FLAG AS ADD_ON_FLAG,
  DETAIL.RETURN_REASON_ID AS RETURN_REASON_ID,
  DETAIL.UNIT_SHIPPING_HANDLING_CHARGE AS UNIT_SHIPPING_HANDLING_CHARGE,
  DETAIL.TOTAL_FEE AS TOTAL_FEE,
  DETAIL.RETURN_CODE_DESC AS RETURN_CODE_DESC,
  DETAIL.RETURN_SHORT_DESC AS RETURN_SHORT_DESC,
  DETAIL.REASON_CODE AS REASON_CODE,
  DETAIL.CANCELLED_DTTM AS CANCELLED_DTTM,
  DETAIL.O_FACILITY_TYPE_BITS AS O_FACILITY_TYPE_BITS,
  DETAIL.D_FACILITY_TYPE_BITS AS D_FACILITY_TYPE_BITS,
  DETAIL.ATTRIBUTE_VALUE AS ATTRIBUTE_VALUE,
  MASTER.OMS_ORDER_ID AS lkp_OMS_ORDER_ID,
  MASTER.OMS_ORDER_LN_ID AS lkp_OMS_ORDER_LN_ID,
  MASTER.OMS_COMPANY_ID AS lkp_OMS_COMPANY_ID,
  MASTER.ORIG_LOCATION_NBR AS lkp_ORIG_LOCATION_NBR,
  MASTER.ORIG_LOCATION_ID AS lkp_ORIG_LOCATION_ID,
  MASTER.DEST_LOCATION_NBR AS lkp_DEST_LOCATION_NBR,
  MASTER.DEST_LOCATION_ID AS lkp_DEST_LOCATION_ID,
  MASTER.SHIP_NAME AS lkp_SHIP_NAME,
  MASTER.SHIP_LAST_NAME AS lkp_SHIP_LAST_NAME,
  MASTER.SHIP_ADDRESS AS lkp_SHIP_ADDRESS,
  MASTER.SHIP_CITY AS lkp_SHIP_CITY,
  MASTER.SHIP_STATE AS lkp_SHIP_STATE,
  MASTER.SHIP_POSTAL_CD AS lkp_SHIP_POSTAL_CD,
  MASTER.SHIP_COUNTRY_CD AS lkp_SHIP_COUNTRY_CD,
  MASTER.SHIP_PHONE AS lkp_SHIP_PHONE,
  MASTER.SHIP_EMAIL AS lkp_SHIP_EMAIL,
  MASTER.BILL_LOCATION_NBR AS lkp_BILL_LOCATION_NBR,
  MASTER.BILL_LOCATION_ID AS lkp_BILL_LOCATION_ID,
  MASTER.STORE_LOCATION_NBR AS lkp_STORE_LOCATION_NBR,
  MASTER.STORE_LOCATION_ID AS lkp_STORE_LOCATION_ID,
  MASTER.PRODUCT_ID AS lkp_PRODUCT_ID,
  MASTER.MV_CURRENCY_CD AS lkp_MV_CURRENCY_CD,
  MASTER.TOTAL_MONETARY_VALUE_AMT AS lkp_TOTAL_MONETARY_VALUE_AMT,
  MASTER.UNIT_MONETARY_VALUE_AMT AS lkp_UNIT_MONETARY_VALUE_AMT,
  MASTER.UNIT_TAX_AMOUNT_AMT AS lkp_UNIT_TAX_AMOUNT_AMT,
  MASTER.PRODUCT_CLASS_ID AS lkp_PRODUCT_CLASS_ID1,
  MASTER.ALLOCATED_QTY AS lkp_ALLOCATED_QTY1,
  MASTER.RELEASED_QTY AS lkp_RELEASED_QTY1,
  MASTER.CANCELLED_QTY AS lkp_CANCELLED_QTY1,
  MASTER.PPACK_QTY AS lkp_PPACK_QTY1,
  MASTER.DELIVERY_TZ AS lkp_DELIVERY_TZ1,
  MASTER.PICKUP_TZ AS lkp_PICKUP_TZ1,
  MASTER.PICKUP_START_DT AS lkp_PICKUP_START_DT,
  MASTER.PICKUP_END_DT AS lkp_PICKUP_END_DT,
  MASTER.DELIVERY_START_DT AS lkp_DELIVERY_START_DT,
  MASTER.DELIVERY_END_DT AS lkp_DELIVERY_END_DT,
  MASTER.REQ_DLVR_DT AS lkp_REQ_DLVR_DT,
  MASTER.MUST_DLVR_DT AS lkp_MUST_DLVR_DT,
  MASTER.SHIP_BY_DT AS lkp_SHIP_BY_DT,
  MASTER.READY_TO_SHIP_FLG AS lkp_READY_TO_SHIP_FLG,
  MASTER.CANCELLED_FLG AS lkp_CANCELLED_FLG,
  MASTER.CLOSED_FLG AS lkp_CLOSED_FLG,
  MASTER.DELETED_FLG AS lkp_DELETED_FLG,
  MASTER.SHIPPED_QTY AS lkp_SHIPPED_QTY1,
  MASTER.RECEIVED_QTY AS lkp_RECEIVED_QTY1,
  MASTER.CREATED_SOURCE_TYPE AS lkp_CREATED_SOURCE_TYPE1,
  MASTER.CREATED_SOURCE AS lkp_CREATED_SOURCE1,
  MASTER.CREATED_TSTMP AS lkp_CREATED_TSTMP,
  MASTER.LAST_UPDATED_TSTMP AS lkp_LAST_UPDATED_TSTMP,
  MASTER.DSG_CARRIER_ID AS lkp_DSG_CARRIER_ID1,
  MASTER.OMS_ORDER_LN_STATUS_ID AS lkp_OMS_ORDER_LN_STATUS_ID,
  MASTER.OMS_ORDER_LN_NBR AS lkp_OMS_ORDER_LN_NBR,
  MASTER.ORDER_QTY AS lkp_ORDER_QTY1,
  MASTER.ALLOC_FINALIZER AS lkp_ALLOC_FINALIZER1,
  MASTER.DIST_ORDER_CREATED_FLG AS lkp_DIST_ORDER_CREATED_FLG,
  MASTER.ORIG_ORDER_QTY AS lkp_ORIG_ORDER_QTY1,
  MASTER.RETAIL_PRICE AS lkp_RETAIL_PRICE1,
  MASTER.DSG_SHIP_VIA AS lkp_DSG_SHIP_VIA1,
  MASTER.LINE_TOTAL AS lkp_LINE_TOTAL1,
  MASTER.REASON_ID AS lkp_REASON_ID1,
  MASTER.ORDER_FULFILLMENT_OPTION AS lkp_ORDER_FULFILLMENT_OPTION1,
  MASTER.PRICE_OVERRIDE_FLG AS lkp_PRICE_OVERRIDE_FLG,
  MASTER.ORIGINAL_PRICE_AMT AS lkp_ORIGINAL_PRICE_AMT,
  MASTER.REASON_CDS_GROUP_ID AS lkp_REASON_CDS_GROUP_ID,
  MASTER.ORDER_FULFILLMENT_CHANNEL AS lkp_ORDER_FULFILLMENT_CHANNEL1,
  MASTER.ORDER_CREATION_CHANNEL AS lkp_ORDER_CREATION_CHANNEL1,
  MASTER.ORDER_CHANNEL AS lkp_ORDER_CHANNEL1,
  MASTER.ORDER_NBR AS lkp_ORDER_NBR1,
  MASTER.OMS_ORDER_CREATED_TSTMP AS lkp_OMS_ORDER_CREATED_TSTMP,
  MASTER.SCHED_DELIVERY_FLG AS lkp_SCHED_DELIVERY_FLG1,
  MASTER.SUBSCRIPTION_ORDER_FLG AS lkp_SUBSCRIPTION_ORDER_FLG1,
  MASTER.ADD_ON_FLAG AS lkp_ADD_ON_FLAG1,
  MASTER.SHIP_CHARGE_NAME AS lkp_SHIP_CHARGE_NAME,
  MASTER.SHIP_CHARGE_AMT AS lkp_SHIP_CHARGE_AMT,
  MASTER.ORIG_SHIP_CHARGE_AMT AS lkp_ORIG_SHIP_CHARGE_AMT,
  MASTER.SHIP_CHARGE_DESC AS lkp_SHIP_CHARGE_DESC,
  MASTER.RETURN_REASON_ID AS lkp_RETURN_REASON_ID1,
  MASTER.RETURN_SHIP_HANDLING_AMT AS lkp_RETURN_SHIP_HANDLING_AMT,
  MASTER.RETURN_TOTAL_FEE_AMT AS lkp_RETURN_TOTAL_FEE_AMT,
  MASTER.RETURN_CODE_DESC AS lkp_RETURN_CODE_DESC1,
  MASTER.RETURN_SHORT_DESC AS lkp_RETURN_SHORT_DESC1,
  MASTER.CANCEL_REASON_DESC AS lkp_CANCEL_REASON_DESC,
  MASTER.CANCELLED_TSTMP AS lkp_CANCELLED_TSTMP,
  MASTER.TRACKING_NBR AS lkp_TRACKING_NBR,
  MASTER.LOAD_TSTMP AS lkp_LOAD_TSTMP1,
  DETAIL.Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  SQ_Shortcut_to_OMS_ORDER_LN_49 MASTER
  RIGHT JOIN FIL_UPDATE_TSTMP_47 DETAIL ON MASTER.OMS_ORDER_ID = DETAIL.o_PURCHASE_ORDERS_ID
  AND MASTER.OMS_ORDER_LN_ID = DETAIL.o_PURCHASE_ORDERS_LINE_ITEM_ID"""

df_50 = spark.sql(query_50)

df_50.createOrReplaceTempView("JNR_OMS_ORDER_LN_50")

# COMMAND ----------
# DBTITLE 1, EXP_FLAGS_51


query_51 = f"""SELECT
  TC_COMPANY_ID AS src_TC_COMPANY_ID,
  O_FACILITY_ALIAS_ID AS src_O_FACILITY_ALIAS_ID,
  D_FACILITY_ALIAS_ID AS src_D_FACILITY_ALIAS_ID,
  D_NAME AS src_D_NAME,
  D_LAST_NAME AS src_D_LAST_NAME,
  D_ADDRESS AS src_D_ADDRESS,
  D_CITY AS src_D_CITY,
  D_STATE_PROV AS src_D_STATE_PROV,
  D_POSTAL_CODE AS src_D_POSTAL_CODE,
  D_COUNTRY_CODE AS src_D_COUNTRY_CODE,
  D_PHONE_NUMBER AS src_D_PHONE_NUMBER,
  D_EMAIL AS src_D_EMAIL,
  BILL_FACILITY_ALIAS_ID AS src_BILL_FACILITY_ALIAS_ID,
  STORE_FACILITY_ALIAS_ID AS src_STORE_FACILITY_ALIAS_ID,
  SKU AS src_SKU,
  MV_CURRENCY_CODE AS src_MV_CURRENCY_CODE,
  TOTAL_MONETARY_VALUE AS src_TOTAL_MONETARY_VALUE,
  UNIT_MONETARY_VALUE AS src_UNIT_MONETARY_VALUE,
  UNIT_TAX_AMOUNT AS src_UNIT_TAX_AMOUNT,
  PRODUCT_CLASS_ID AS src_PRODUCT_CLASS_ID,
  ALLOCATED_QTY AS src_ALLOCATED_QTY,
  RELEASED_QTY AS src_RELEASED_QTY,
  CANCELLED_QTY AS src_CANCELLED_QTY,
  PPACK_QTY AS src_PPACK_QTY,
  DELIVERY_TZ AS src_DELIVERY_TZ,
  PICKUP_TZ AS src_PICKUP_TZ,
  PICKUP_START_DTTM AS src_PICKUP_START_DTTM,
  PICKUP_END_DTTM AS src_PICKUP_END_DTTM,
  DELIVERY_START_DTTM AS src_DELIVERY_START_DTTM,
  DELIVERY_END_DTTM AS src_DELIVERY_END_DTTM,
  REQ_DLVR_DTTM AS src_REQ_DLVR_DTTM,
  MUST_DLVR_DTTM AS src_MUST_DLVR_DTTM,
  SHIP_BY_DATE AS src_SHIP_BY_DATE,
  IS_READY_TO_SHIP AS src_IS_READY_TO_SHIP,
  IS_CANCELLED AS src_IS_CANCELLED,
  IS_CLOSED AS src_IS_CLOSED,
  IS_DELETED AS src_IS_DELETED,
  SHIPPED_QTY AS src_SHIPPED_QTY,
  RECEIVED_QTY AS src_RECEIVED_QTY,
  CREATED_SOURCE_TYPE AS src_CREATED_SOURCE_TYPE,
  CREATED_SOURCE AS src_CREATED_SOURCE,
  CREATED_DTTM AS src_CREATED_DTTM,
  LAST_UPDATED_DTTM AS src_LAST_UPDATED_DTTM,
  DSG_CARRIER_ID AS src_DSG_CARRIER_ID,
  PURCHASE_ORDERS_LINE_STATUS AS src_PURCHASE_ORDERS_LN_STATUS,
  TC_PO_LINE_ID AS src_TC_PO_LN_ID,
  ORDER_QTY AS src_ORDER_QTY,
  ALLOC_FINALIZER AS src_ALLOC_FINALIZER,
  IS_DO_CREATED AS src_IS_DO_CREATED,
  ORIG_ORDER_QTY AS src_ORIG_ORDER_QTY,
  RETAIL_PRICE AS src_RETAIL_PRICE,
  DSG_SHIP_VIA AS src_DSG_SHIP_VIA,
  LINE_TOTAL AS src_LINE_TOTAL,
  REASON_ID AS src_REASON_ID,
  ORDER_FULFILLMENT_OPTION AS src_ORDER_FULFILLMENT_OPTION,
  PRICE_OVERRIDE AS src_PRICE_OVERRIDE,
  ORIGINAL_PRICE AS src_ORIGINAL_PRICE,
  REASON_CODES_GROUP_ID AS src_REASON_CODES_GROUP_ID,
  ORDER_FULFILLMENT_CHANNEL AS src_ORDER_FULFILLMENT_CHANNEL,
  ORDER_CREATION_CHANNEL AS src_ORDER_CREATION_CHANNEL,
  ORDER_CHANNEL AS src_ORDER_CHANNEL,
  ORDER_NBR AS src_ORDER_NBR,
  CREATED_DTTM1 AS src_OMS_ORDER_CREATED_TSTMP,
  SCHED_DELIVERY_FLG AS src_SCHED_DELIVERY_FLG,
  SUBSCRIPTION_ORDER_FLG AS src_SUBSCRIPTION_ORDER_FLG,
  ADD_ON_FLAG AS src_ADD_ON_FLAG,
  CHARGE_NAME AS src_CHARGE_NAME,
  CHARGE_AMOUNT AS src_CHARGE_AMOUNT,
  ORIGINAL_CHARGE_AMOUNT AS src_ORIGINAL_CHARGE_AMOUNT,
  CODE_DESC AS src_CODE_DESC,
  RETURN_REASON_ID AS src_RETURN_REASON_ID,
  UNIT_SHIPPING_HANDLING_CHARGE AS src_UNIT_SHIPPING_HANDLING_CHARGE,
  TOTAL_FEE AS src_TOTAL_FEE,
  RETURN_CODE_DESC AS src_RETURN_CODE_DESC,
  RETURN_SHORT_DESC AS src_RETURN_SHORT_DESC,
  REASON_CODE AS src_REASON_CODE,
  CANCELLED_DTTM AS src_CANCELLED_DTTM,
  ATTRIBUTE_VALUE AS src_TRACKING_NBR,
  IFF(
    ISNULL(lkp_OMS_ORDER_ID),
    o_PURCHASE_ORDERS_ID,
    lkp_OMS_ORDER_ID
  ) AS ORDER_ID,
  IFF(
    ISNULL(lkp_OMS_ORDER_LN_ID),
    o_PURCHASE_ORDERS_LINE_ITEM_ID,
    lkp_OMS_ORDER_LN_ID
  ) AS ORDER_LN_ID,
  IFF(
    NOT ISNULL(src_O_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(
      src_O_FACILITY_ALIAS_ID,
      DECODE(src_O_FACILITY_TYPE_ID, 64, 8, 545, 6, 33, 6, 9, 19, 8)
    ),
    NULL
  ) AS v_ORIG_LOCATION_ID,
  IFF(
    NOT ISNULL(O_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(
      O_FACILITY_ALIAS_ID,
      DECODE(O_FACILITY_TYPE_BITS, 64, 8, 545, 6, 33, 6, 9, 19, 8)
    ),
    NULL
  ) AS ORIG_LOCATION_ID,
  IFF(
    NOT ISNULL(src_D_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(
      src_D_FACILITY_ALIAS_ID,
      DECODE(src_D_FACILITY_TYPE_ID, 64, 8, 545, 6, 33, 6, 9, 19, 8)
    ),
    NULL
  ) AS v_DEST_LOCATION_ID,
  IFF(
    NOT ISNULL(D_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(
      D_FACILITY_ALIAS_ID,
      DECODE(D_FACILITY_TYPE_BITS, 64, 8, 545, 6, 33, 6, 9, 19, 8)
    ),
    NULL
  ) AS DEST_LOCATION_ID,
  IFF(
    NOT ISNULL(src_BILL_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(src_BILL_FACILITY_ALIAS_ID, 8),
    NULL
  ) AS v_BILL_LOCATION_ID,
  IFF(
    NOT ISNULL(BILL_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(BILL_FACILITY_ALIAS_ID, 8),
    NULL
  ) AS BILL_LOCATION_ID1,
  IFF(
    NOT ISNULL(src_STORE_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(src_STORE_FACILITY_ALIAS_ID, 8),
    NULL
  ) AS v_STORE_LOCATION_ID,
  IFF(
    NOT ISNULL(STORE_FACILITY_ALIAS_ID),
    LKP_SITE_PROFILE(STORE_FACILITY_ALIAS_ID, 8),
    NULL
  ) AS STORE_LOCATION_ID,
  LKP_SKU_PROFILE(src_SKU) AS v_PRODUCT_ID,
  LKP_SKU_PROFILE(SKU) AS PRODUCT_ID1,
  IFF(
    TC_COMPANY_ID = 8840,
    1,
    LKP_CURRENCY_DAY(TRUNC(CREATED_DTTM1))
  ) AS EXCHANGE_RATE_PCNT,
  IFF(
    (
      ISNULL(lkp_OMS_ORDER_ID)
      AND ISNULL(lkp_OMS_ORDER_LN_ID)
    ),
    'INSERT',
    IFF(
      (
        TO_CHAR(src_TC_COMPANY_ID) <> TO_CHAR(lkp_OMS_COMPANY_ID)
        OR LTRIM(RTRIM(src_O_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_ORIG_LOCATION_NBR))
        OR TO_CHAR(v_ORIG_LOCATION_ID) <> TO_CHAR(lkp_ORIG_LOCATION_ID1)
        OR LTRIM(RTRIM(src_D_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_DEST_LOCATION_NBR))
        OR TO_CHAR(v_DEST_LOCATION_ID) <> TO_CHAR(lkp_DEST_LOCATION_ID1)
        OR LTRIM(RTRIM(src_D_NAME)) <> LTRIM(RTRIM(lkp_SHIP_NAME))
        OR LTRIM(RTRIM(src_D_LAST_NAME)) <> LTRIM(RTRIM(lkp_SHIP_LAST_NAME))
        OR LTRIM(RTRIM(src_D_ADDRESS)) <> LTRIM(RTRIM(lkp_SHIP_ADDRESS))
        OR LTRIM(RTRIM(src_D_CITY)) <> LTRIM(RTRIM(lkp_SHIP_CITY))
        OR LTRIM(RTRIM(src_D_STATE_PROV)) <> LTRIM(RTRIM(lkp_SHIP_STATE))
        OR LTRIM(RTRIM(src_D_POSTAL_CODE)) <> LTRIM(RTRIM(lkp_SHIP_POSTAL_CD))
        OR LTRIM(RTRIM(src_D_COUNTRY_CODE)) <> LTRIM(RTRIM(lkp_SHIP_COUNTRY_CD))
        OR LTRIM(RTRIM(src_D_PHONE_NUMBER)) <> LTRIM(RTRIM(lkp_SHIP_PHONE))
        OR LTRIM(RTRIM(src_D_EMAIL)) <> LTRIM(RTRIM(lkp_SHIP_EMAIL))
        OR LTRIM(RTRIM(src_BILL_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_BILL_LOCATION_NBR))
        OR TO_CHAR(v_BILL_LOCATION_ID) <> TO_CHAR(lkp_BILL_LOCATION_ID1)
        OR LTRIM(RTRIM(src_STORE_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_STORE_LOCATION_NBR))
        OR TO_CHAR(v_STORE_LOCATION_ID) <> TO_CHAR(lkp_STORE_LOCATION_ID1)
        OR TO_CHAR(v_PRODUCT_ID) <> TO_CHAR(lkp_PRODUCT_ID1)
        OR LTRIM(RTRIM(src_MV_CURRENCY_CODE)) <> LTRIM(RTRIM(lkp_MV_CURRENCY_CD))
        OR TO_CHAR(src_TOTAL_MONETARY_VALUE) <> TO_CHAR(lkp_TOTAL_MONETARY_VALUE_AMT)
        OR TO_CHAR(src_UNIT_MONETARY_VALUE) <> TO_CHAR(lkp_UNIT_MONETARY_VALUE_AMT)
        OR TO_CHAR(src_UNIT_TAX_AMOUNT) <> TO_CHAR(lkp_UNIT_TAX_AMOUNT_AMT)
        OR TO_CHAR(src_PRODUCT_CLASS_ID) <> TO_CHAR(lkp_PRODUCT_CLASS_ID1)
        OR TO_CHAR(src_ALLOCATED_QTY) <> TO_CHAR(lkp_ALLOCATED_QTY1)
        OR TO_CHAR(src_RELEASED_QTY) <> TO_CHAR(lkp_RELEASED_QTY1)
        OR TO_CHAR(src_CANCELLED_QTY) <> TO_CHAR(lkp_CANCELLED_QTY1)
        OR TO_CHAR(src_PPACK_QTY) <> TO_CHAR(lkp_PPACK_QTY1)
        OR TO_CHAR(src_DELIVERY_TZ) <> TO_CHAR(lkp_DELIVERY_TZ1)
        OR TO_CHAR(src_PICKUP_TZ) <> TO_CHAR(lkp_PICKUP_TZ1)
        OR TO_CHAR(
          TRUNC(src_PICKUP_START_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_PICKUP_START_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(
          TRUNC(src_PICKUP_END_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_PICKUP_END_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(
          TRUNC(src_DELIVERY_START_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_DELIVERY_START_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(
          TRUNC(src_DELIVERY_END_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_DELIVERY_END_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(src_REQ_DLVR_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_REQ_DLVR_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(
          TRUNC(src_MUST_DLVR_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_MUST_DLVR_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(src_SHIP_BY_DATE), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_SHIP_BY_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(src_IS_READY_TO_SHIP) <> TO_CHAR(lkp_READY_TO_SHIP_FLG)
        OR TO_CHAR(src_IS_CANCELLED) <> TO_CHAR(lkp_CANCELLED_FLG)
        OR TO_CHAR(src_IS_CLOSED) <> TO_CHAR(lkp_CLOSED_FLG)
        OR TO_CHAR(src_IS_DELETED) <> TO_CHAR(lkp_SHIPPED_QTY1)
        OR TO_CHAR(src_SHIPPED_QTY) <> TO_CHAR(lkp_DELETED_FLG)
        OR TO_CHAR(src_RECEIVED_QTY) <> TO_CHAR(lkp_RECEIVED_QTY1)
        OR TO_CHAR(src_CREATED_SOURCE_TYPE) <> TO_CHAR(lkp_CREATED_SOURCE_TYPE1)
        OR LTRIM(RTRIM(src_CREATED_SOURCE)) <> LTRIM(RTRIM(lkp_CREATED_SOURCE1))
        OR TO_CHAR(src_CREATED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_CREATED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(src_LAST_UPDATED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_LAST_UPDATED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(src_DSG_CARRIER_ID) <> TO_CHAR(lkp_DSG_CARRIER_ID1)
        OR TO_CHAR(src_PURCHASE_ORDERS_LN_STATUS) <> TO_CHAR(lkp_OMS_ORDER_LN_STATUS_ID)
        OR LTRIM(RTRIM(src_TC_PO_LN_ID)) <> LTRIM(RTRIM(lkp_OMS_ORDER_LN_NBR))
        OR TO_CHAR(src_ORDER_QTY) <> TO_CHAR(lkp_ORDER_QTY1)
        OR LTRIM(RTRIM(src_ALLOC_FINALIZER)) <> LTRIM(RTRIM(lkp_ALLOC_FINALIZER1))
        OR TO_CHAR(src_IS_DO_CREATED) <> TO_CHAR(lkp_DIST_ORDER_CREATED_FLG)
        OR TO_CHAR(src_ORIG_ORDER_QTY) <> TO_CHAR(lkp_ORIG_ORDER_QTY1)
        OR TO_CHAR(src_RETAIL_PRICE) <> TO_CHAR(lkp_RETAIL_PRICE1)
        OR LTRIM(RTRIM(src_DSG_SHIP_VIA)) <> LTRIM(RTRIM(lkp_DSG_SHIP_VIA1))
        OR TO_CHAR(src_LINE_TOTAL) <> TO_CHAR(lkp_LINE_TOTAL1)
        OR TO_CHAR(src_REASON_ID) <> TO_CHAR(lkp_REASON_ID1)
        OR LTRIM(RTRIM(src_ORDER_FULFILLMENT_OPTION)) <> LTRIM(RTRIM(lkp_ORDER_FULFILLMENT_OPTION1))
        OR TO_CHAR(src_PRICE_OVERRIDE) <> TO_CHAR(lkp_PRICE_OVERRIDE_FLG)
        OR TO_CHAR(src_ORIGINAL_PRICE) <> TO_CHAR(lkp_ORIGINAL_PRICE_AMT)
        OR TO_CHAR(src_REASON_CODES_GROUP_ID) <> TO_CHAR(lkp_REASON_CDS_GROUP_ID)
        OR LTRIM(RTRIM(src_ORDER_FULFILLMENT_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_FULFILLMENT_CHANNEL1))
        OR LTRIM(RTRIM(src_ORDER_CREATION_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_CREATION_CHANNEL1))
        OR LTRIM(RTRIM(src_ORDER_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_CHANNEL1))
        OR TO_CHAR(src_ORDER_NBR) <> TO_CHAR(lkp_ORDER_NBR1)
        OR TO_CHAR(
          src_OMS_ORDER_CREATED_TSTMP,
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(
          lkp_OMS_ORDER_CREATED_TSTMP1,
          'YYYY-MM-DD HH24:MI:SS'
        )
        OR TO_CHAR(src_SCHED_DELIVERY_FLG) <> TO_CHAR(lkp_SCHED_DELIVERY_FLG1)
        OR TO_CHAR(src_SUBSCRIPTION_ORDER_FLG) <> TO_CHAR(lkp_SUBSCRIPTION_ORDER_FLG1)
        OR TO_CHAR(src_ADD_ON_FLAG) <> TO_CHAR(lkp_ADD_ON_FLAG1)
        OR LTRIM(RTRIM(src_CHARGE_NAME)) <> LTRIM(RTRIM(lkp_SHIP_CHARGE_NAME))
        OR TO_CHAR(src_CHARGE_AMOUNT) <> TO_CHAR(lkp_SHIP_CHARGE_AMT)
        OR TO_CHAR(src_ORIGINAL_CHARGE_AMOUNT) <> TO_CHAR(lkp_ORIG_SHIP_CHARGE_AMT)
        OR LTRIM(RTRIM(src_CODE_DESC)) <> LTRIM(RTRIM(lkp_SHIP_CHARGE_DESC))
        OR LTRIM(RTRIM(src_RETURN_REASON_ID)) <> LTRIM(RTRIM(lkp_RETURN_REASON_ID1))
        OR TO_CHAR(src_UNIT_SHIPPING_HANDLING_CHARGE) <> TO_CHAR(lkp_RETURN_SHIP_HANDLING_AMT)
        OR TO_CHAR(src_TOTAL_FEE) <> TO_CHAR(lkp_RETURN_TOTAL_FEE_AMT)
        OR LTRIM(RTRIM(src_RETURN_CODE_DESC)) <> LTRIM(RTRIM(lkp_RETURN_CODE_DESC1))
        OR LTRIM(RTRIM(src_RETURN_SHORT_DESC)) <> LTRIM(RTRIM(lkp_RETURN_SHORT_DESC1))
        OR LTRIM(RTRIM(src_REASON_CODE)) <> LTRIM(RTRIM(lkp_CANCEL_REASON_DESC))
        OR TO_CHAR(src_CANCELLED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_CANCELLED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR LTRIM(RTRIM(src_TRACKING_NBR)) <> LTRIM(RTRIM(lkp_TRACKING_NBR))
      ),
      'UPDATE',
      'REJECT'
    )
  ) AS v_LOAD_FLAG,
  IFF(
    (
      ISNULL(lkp_OMS_ORDER_ID)
      AND ISNULL(lkp_OMS_ORDER_LN_ID)
    ),
    'INSERT',
    IFF(
      (
        TO_CHAR(TC_COMPANY_ID) <> TO_CHAR(lkp_OMS_COMPANY_ID)
        OR LTRIM(RTRIM(O_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_ORIG_LOCATION_NBR))
        OR TO_CHAR(
          IFF(
            NOT ISNULL(O_FACILITY_ALIAS_ID),
            LKP_SITE_PROFILE(
              O_FACILITY_ALIAS_ID,
              DECODE(O_FACILITY_TYPE_BITS, 64, 8, 545, 6, 33, 6, 9, 19, 8)
            ),
            NULL
          )
        ) <> TO_CHAR(lkp_ORIG_LOCATION_ID)
        OR LTRIM(RTRIM(D_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_DEST_LOCATION_NBR))
        OR TO_CHAR(
          IFF(
            NOT ISNULL(D_FACILITY_ALIAS_ID),
            LKP_SITE_PROFILE(
              D_FACILITY_ALIAS_ID,
              DECODE(D_FACILITY_TYPE_BITS, 64, 8, 545, 6, 33, 6, 9, 19, 8)
            ),
            NULL
          )
        ) <> TO_CHAR(lkp_DEST_LOCATION_ID)
        OR LTRIM(RTRIM(D_NAME)) <> LTRIM(RTRIM(lkp_SHIP_NAME))
        OR LTRIM(RTRIM(D_LAST_NAME)) <> LTRIM(RTRIM(lkp_SHIP_LAST_NAME))
        OR LTRIM(RTRIM(D_ADDRESS)) <> LTRIM(RTRIM(lkp_SHIP_ADDRESS))
        OR LTRIM(RTRIM(D_CITY)) <> LTRIM(RTRIM(lkp_SHIP_CITY))
        OR LTRIM(RTRIM(D_STATE_PROV)) <> LTRIM(RTRIM(lkp_SHIP_STATE))
        OR LTRIM(RTRIM(D_POSTAL_CODE)) <> LTRIM(RTRIM(lkp_SHIP_POSTAL_CD))
        OR LTRIM(RTRIM(D_COUNTRY_CODE)) <> LTRIM(RTRIM(lkp_SHIP_COUNTRY_CD))
        OR LTRIM(RTRIM(D_PHONE_NUMBER)) <> LTRIM(RTRIM(lkp_SHIP_PHONE))
        OR LTRIM(RTRIM(D_EMAIL)) <> LTRIM(RTRIM(lkp_SHIP_EMAIL))
        OR LTRIM(RTRIM(BILL_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_BILL_LOCATION_NBR))
        OR TO_CHAR(
          IFF(
            NOT ISNULL(BILL_FACILITY_ALIAS_ID),
            LKP_SITE_PROFILE(BILL_FACILITY_ALIAS_ID, 8),
            NULL
          )
        ) <> TO_CHAR(lkp_BILL_LOCATION_ID)
        OR LTRIM(RTRIM(STORE_FACILITY_ALIAS_ID)) <> LTRIM(RTRIM(lkp_STORE_LOCATION_NBR))
        OR TO_CHAR(
          IFF(
            NOT ISNULL(STORE_FACILITY_ALIAS_ID),
            LKP_SITE_PROFILE(STORE_FACILITY_ALIAS_ID, 8),
            NULL
          )
        ) <> TO_CHAR(lkp_STORE_LOCATION_ID)
        OR TO_CHAR(LKP_SKU_PROFILE(SKU)) <> TO_CHAR(lkp_PRODUCT_ID)
        OR LTRIM(RTRIM(MV_CURRENCY_CODE)) <> LTRIM(RTRIM(lkp_MV_CURRENCY_CD))
        OR TO_CHAR(TOTAL_MONETARY_VALUE) <> TO_CHAR(lkp_TOTAL_MONETARY_VALUE_AMT)
        OR TO_CHAR(UNIT_MONETARY_VALUE) <> TO_CHAR(lkp_UNIT_MONETARY_VALUE_AMT)
        OR TO_CHAR(UNIT_TAX_AMOUNT) <> TO_CHAR(lkp_UNIT_TAX_AMOUNT_AMT)
        OR TO_CHAR(PRODUCT_CLASS_ID) <> TO_CHAR(lkp_PRODUCT_CLASS_ID1)
        OR TO_CHAR(ALLOCATED_QTY) <> TO_CHAR(lkp_ALLOCATED_QTY1)
        OR TO_CHAR(RELEASED_QTY) <> TO_CHAR(lkp_RELEASED_QTY1)
        OR TO_CHAR(CANCELLED_QTY) <> TO_CHAR(lkp_CANCELLED_QTY1)
        OR TO_CHAR(PPACK_QTY) <> TO_CHAR(lkp_PPACK_QTY1)
        OR TO_CHAR(DELIVERY_TZ) <> TO_CHAR(lkp_DELIVERY_TZ1)
        OR TO_CHAR(PICKUP_TZ) <> TO_CHAR(lkp_PICKUP_TZ1)
        OR TO_CHAR(TRUNC(PICKUP_START_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_PICKUP_START_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(PICKUP_END_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_PICKUP_END_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(
          TRUNC(DELIVERY_START_DTTM),
          'YYYY-MM-DD HH24:MI:SS'
        ) <> TO_CHAR(lkp_DELIVERY_START_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(DELIVERY_END_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_DELIVERY_END_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(REQ_DLVR_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_REQ_DLVR_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(MUST_DLVR_DTTM), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_MUST_DLVR_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(TRUNC(SHIP_BY_DATE), 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_SHIP_BY_DT, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(IS_READY_TO_SHIP) <> TO_CHAR(lkp_READY_TO_SHIP_FLG)
        OR TO_CHAR(IS_CANCELLED) <> TO_CHAR(lkp_CANCELLED_FLG)
        OR TO_CHAR(IS_CLOSED) <> TO_CHAR(lkp_CLOSED_FLG)
        OR TO_CHAR(IS_DELETED) <> TO_CHAR(lkp_SHIPPED_QTY1)
        OR TO_CHAR(SHIPPED_QTY) <> TO_CHAR(lkp_SHIPPED_QTY1)
        OR TO_CHAR(RECEIVED_QTY) <> TO_CHAR(lkp_RECEIVED_QTY1)
        OR TO_CHAR(CREATED_SOURCE_TYPE) <> TO_CHAR(lkp_CREATED_SOURCE_TYPE1)
        OR LTRIM(RTRIM(CREATED_SOURCE)) <> LTRIM(RTRIM(lkp_CREATED_SOURCE1))
        OR TO_CHAR(CREATED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_CREATED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(LAST_UPDATED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_LAST_UPDATED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR TO_CHAR(DSG_CARRIER_ID) <> TO_CHAR(lkp_DSG_CARRIER_ID1)
        OR TO_CHAR(PURCHASE_ORDERS_LINE_STATUS) <> TO_CHAR(lkp_OMS_ORDER_LN_STATUS_ID)
        OR LTRIM(RTRIM(TC_PO_LINE_ID)) <> LTRIM(RTRIM(lkp_OMS_ORDER_LN_NBR))
        OR TO_CHAR(ORDER_QTY) <> TO_CHAR(lkp_ORDER_QTY1)
        OR LTRIM(RTRIM(ALLOC_FINALIZER)) <> LTRIM(RTRIM(lkp_ALLOC_FINALIZER1))
        OR TO_CHAR(IS_DO_CREATED) <> TO_CHAR(lkp_DIST_ORDER_CREATED_FLG)
        OR TO_CHAR(ORIG_ORDER_QTY) <> TO_CHAR(lkp_ORIG_ORDER_QTY1)
        OR TO_CHAR(RETAIL_PRICE) <> TO_CHAR(lkp_RETAIL_PRICE1)
        OR LTRIM(RTRIM(DSG_SHIP_VIA)) <> LTRIM(RTRIM(lkp_DSG_SHIP_VIA1))
        OR TO_CHAR(LINE_TOTAL) <> TO_CHAR(lkp_LINE_TOTAL1)
        OR TO_CHAR(REASON_ID) <> TO_CHAR(lkp_REASON_ID1)
        OR LTRIM(RTRIM(ORDER_FULFILLMENT_OPTION)) <> LTRIM(RTRIM(lkp_ORDER_FULFILLMENT_OPTION1))
        OR TO_CHAR(PRICE_OVERRIDE) <> TO_CHAR(lkp_PRICE_OVERRIDE_FLG)
        OR TO_CHAR(ORIGINAL_PRICE) <> TO_CHAR(lkp_ORIGINAL_PRICE_AMT)
        OR TO_CHAR(REASON_CODES_GROUP_ID) <> TO_CHAR(lkp_REASON_CDS_GROUP_ID)
        OR LTRIM(RTRIM(ORDER_FULFILLMENT_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_FULFILLMENT_CHANNEL1))
        OR LTRIM(RTRIM(ORDER_CREATION_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_CREATION_CHANNEL1))
        OR LTRIM(RTRIM(ORDER_CHANNEL)) <> LTRIM(RTRIM(lkp_ORDER_CHANNEL1))
        OR TO_CHAR(ORDER_NBR) <> TO_CHAR(lkp_ORDER_NBR1)
        OR TO_CHAR(CREATED_DTTM1, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(
          lkp_OMS_ORDER_CREATED_TSTMP,
          'YYYY-MM-DD HH24:MI:SS'
        )
        OR TO_CHAR(SCHED_DELIVERY_FLG) <> TO_CHAR(lkp_SCHED_DELIVERY_FLG1)
        OR TO_CHAR(SUBSCRIPTION_ORDER_FLG) <> TO_CHAR(lkp_SUBSCRIPTION_ORDER_FLG1)
        OR TO_CHAR(ADD_ON_FLAG) <> TO_CHAR(lkp_ADD_ON_FLAG1)
        OR LTRIM(RTRIM(CHARGE_NAME)) <> LTRIM(RTRIM(lkp_SHIP_CHARGE_NAME))
        OR TO_CHAR(CHARGE_AMOUNT) <> TO_CHAR(lkp_SHIP_CHARGE_AMT)
        OR TO_CHAR(ORIGINAL_CHARGE_AMOUNT) <> TO_CHAR(lkp_ORIG_SHIP_CHARGE_AMT)
        OR LTRIM(RTRIM(CODE_DESC)) <> LTRIM(RTRIM(lkp_SHIP_CHARGE_DESC))
        OR LTRIM(RTRIM(RETURN_REASON_ID)) <> LTRIM(RTRIM(lkp_RETURN_REASON_ID1))
        OR TO_CHAR(UNIT_SHIPPING_HANDLING_CHARGE) <> TO_CHAR(lkp_RETURN_SHIP_HANDLING_AMT)
        OR TO_CHAR(TOTAL_FEE) <> TO_CHAR(lkp_RETURN_TOTAL_FEE_AMT)
        OR LTRIM(RTRIM(RETURN_CODE_DESC)) <> LTRIM(RTRIM(lkp_RETURN_CODE_DESC1))
        OR LTRIM(RTRIM(RETURN_SHORT_DESC)) <> LTRIM(RTRIM(lkp_RETURN_SHORT_DESC1))
        OR LTRIM(RTRIM(REASON_CODE)) <> LTRIM(RTRIM(lkp_CANCEL_REASON_DESC))
        OR TO_CHAR(CANCELLED_DTTM, 'YYYY-MM-DD HH24:MI:SS') <> TO_CHAR(lkp_CANCELLED_TSTMP, 'YYYY-MM-DD HH24:MI:SS')
        OR LTRIM(RTRIM(ATTRIBUTE_VALUE)) <> LTRIM(RTRIM(lkp_TRACKING_NBR))
      ),
      'UPDATE',
      'REJECT'
    )
  ) AS LOAD_FLAG,
  now() AS UPDATE_TSTMP,
  IFF(
    ISNULL(lkp_OMS_ORDER_ID)
    AND ISNULL(lkp_OMS_ORDER_LN_ID),
    now(),
    lkp_LOAD_TSTMP1
  ) AS LOAD_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  JNR_OMS_ORDER_LN_50"""

df_51 = spark.sql(query_51)

df_51.createOrReplaceTempView("EXP_FLAGS_51")

# COMMAND ----------
# DBTITLE 1, FIL_FLAGS_52


query_52 = f"""SELECT
  src_TC_COMPANY_ID AS src_TC_COMPANY_ID,
  src_O_FACILITY_ALIAS_ID AS src_O_FACILITY_ALIAS_ID,
  src_D_FACILITY_ALIAS_ID AS src_D_FACILITY_ALIAS_ID,
  src_D_NAME AS src_D_NAME,
  src_D_LAST_NAME AS src_D_LAST_NAME,
  src_D_ADDRESS AS src_D_ADDRESS,
  src_D_CITY AS src_D_CITY,
  src_D_STATE_PROV AS src_D_STATE_PROV,
  src_D_POSTAL_CODE AS src_D_POSTAL_CODE,
  src_D_COUNTRY_CODE AS src_D_COUNTRY_CODE,
  src_D_PHONE_NUMBER AS src_D_PHONE_NUMBER,
  src_D_EMAIL AS src_D_EMAIL,
  src_BILL_FACILITY_ALIAS_ID AS src_BILL_FACILITY_ALIAS_ID,
  src_STORE_FACILITY_ALIAS_ID AS src_STORE_FACILITY_ALIAS_ID,
  src_SKU AS src_SKU,
  src_MV_CURRENCY_CODE AS src_MV_CURRENCY_CODE,
  src_TOTAL_MONETARY_VALUE AS src_TOTAL_MONETARY_VALUE,
  src_UNIT_MONETARY_VALUE AS src_UNIT_MONETARY_VALUE,
  src_UNIT_TAX_AMOUNT AS src_UNIT_TAX_AMOUNT,
  src_PRODUCT_CLASS_ID AS src_PRODUCT_CLASS_ID,
  src_ALLOCATED_QTY AS src_ALLOCATED_QTY,
  src_RELEASED_QTY AS src_RELEASED_QTY,
  src_CANCELLED_QTY AS src_CANCELLED_QTY,
  src_PPACK_QTY AS src_PPACK_QTY,
  src_DELIVERY_TZ AS src_DELIVERY_TZ,
  src_PICKUP_TZ AS src_PICKUP_TZ,
  src_PICKUP_START_DTTM AS src_PICKUP_START_DTTM,
  src_PICKUP_END_DTTM AS src_PICKUP_END_DTTM,
  src_DELIVERY_START_DTTM AS src_DELIVERY_START_DTTM,
  src_DELIVERY_END_DTTM AS src_DELIVERY_END_DTTM,
  src_REQ_DLVR_DTTM AS src_REQ_DLVR_DTTM,
  src_MUST_DLVR_DTTM AS src_MUST_DLVR_DTTM,
  src_SHIP_BY_DATE AS src_SHIP_BY_DATE,
  src_IS_READY_TO_SHIP AS src_IS_READY_TO_SHIP,
  src_IS_CANCELLED AS src_IS_CANCELLED,
  src_IS_CLOSED AS src_IS_CLOSED,
  src_IS_DELETED AS src_IS_DELETED,
  src_SHIPPED_QTY AS src_SHIPPED_QTY,
  src_RECEIVED_QTY AS src_RECEIVED_QTY,
  src_CREATED_SOURCE_TYPE AS src_CREATED_SOURCE_TYPE,
  src_CREATED_SOURCE AS src_CREATED_SOURCE,
  src_CREATED_DTTM AS src_CREATED_DTTM,
  src_LAST_UPDATED_DTTM AS src_LAST_UPDATED_DTTM,
  src_DSG_CARRIER_ID AS src_DSG_CARRIER_ID,
  src_PURCHASE_ORDERS_LN_STATUS AS src_PURCHASE_ORDERS_LN_STATUS,
  src_TC_PO_LN_ID AS src_TC_PO_LN_ID,
  src_ORDER_QTY AS src_ORDER_QTY,
  src_ALLOC_FINALIZER AS src_ALLOC_FINALIZER,
  src_IS_DO_CREATED AS src_IS_DO_CREATED,
  src_ORIG_ORDER_QTY AS src_ORIG_ORDER_QTY,
  src_RETAIL_PRICE AS src_RETAIL_PRICE,
  src_DSG_SHIP_VIA AS src_DSG_SHIP_VIA,
  src_LINE_TOTAL AS src_LINE_TOTAL,
  src_REASON_ID AS src_REASON_ID,
  src_ORDER_FULFILLMENT_OPTION AS src_ORDER_FULFILLMENT_OPTION,
  src_PRICE_OVERRIDE AS src_PRICE_OVERRIDE,
  src_ORIGINAL_PRICE AS src_ORIGINAL_PRICE,
  src_REASON_CODES_GROUP_ID AS src_REASON_CODES_GROUP_ID,
  src_ORDER_FULFILLMENT_CHANNEL AS src_ORDER_FULFILLMENT_CHANNEL,
  src_ORDER_CREATION_CHANNEL AS src_ORDER_CREATION_CHANNEL,
  src_ORDER_CHANNEL AS src_ORDER_CHANNEL,
  src_ORDER_NBR AS src_ORDER_NBR,
  src_OMS_ORDER_CREATED_TSTMP AS src_OMS_ORDER_CREATED_TSTMP,
  src_SCHED_DELIVERY_FLG AS src_SCHED_DELIVERY_FLG,
  src_SUBSCRIPTION_ORDER_FLG AS src_SUBSCRIPTION_ORDER_FLG,
  src_ADD_ON_FLAG AS src_ADD_ON_FLAG,
  src_CHARGE_NAME AS src_CHARGE_NAME,
  src_CHARGE_AMOUNT AS src_CHARGE_AMOUNT,
  src_ORIGINAL_CHARGE_AMOUNT AS src_ORIGINAL_CHARGE_AMOUNT,
  src_CODE_DESC AS src_CODE_DESC,
  src_RETURN_REASON_ID AS src_RETURN_REASON_ID,
  src_UNIT_SHIPPING_HANDLING_CHARGE AS src_UNIT_SHIPPING_HANDLING_CHARGE,
  src_TOTAL_FEE AS src_TOTAL_FEE,
  src_RETURN_CODE_DESC AS src_RETURN_CODE_DESC,
  src_RETURN_SHORT_DESC AS src_RETURN_SHORT_DESC,
  src_REASON_CODE AS src_REASON_CODE,
  src_CANCELLED_DTTM AS src_CANCELLED_DTTM,
  src_TRACKING_NBR AS src_TRACKING_NBR,
  ORDER_ID AS ORDER_ID,
  ORDER_LN_ID AS ORDER_LN_ID,
  ORIG_LOCATION_ID AS ORIG_LOCATION_ID,
  DEST_LOCATION_ID AS DEST_LOCATION_ID,
  BILL_LOCATION_ID1 AS BILL_LOCATION_ID1,
  STORE_LOCATION_ID AS STORE_LOCATION_ID,
  PRODUCT_ID1 AS PRODUCT_ID1,
  EXCHANGE_RATE_PCNT AS EXCHANGE_RATE_PCNT,
  LOAD_FLAG AS LOAD_FLAG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id
FROM
  EXP_FLAGS_51
WHERE
  IN(LOAD_FLAG, 'INSERT', 'UPDATE')"""

df_52 = spark.sql(query_52)

df_52.createOrReplaceTempView("FIL_FLAGS_52")

# COMMAND ----------
# DBTITLE 1, UPD_INSERT_UPDATE_53


query_53 = f"""SELECT
  ORDER_ID AS ORDER_ID,
  ORDER_LN_ID AS ORDER_LN_ID,
  src_TC_COMPANY_ID AS src_TC_COMPANY_ID,
  src_O_FACILITY_ALIAS_ID AS src_O_FACILITY_ALIAS_ID,
  src_D_FACILITY_ALIAS_ID AS src_D_FACILITY_ALIAS_ID,
  src_D_NAME AS src_D_NAME,
  src_D_LAST_NAME AS src_D_LAST_NAME,
  src_D_ADDRESS AS src_D_ADDRESS,
  src_D_CITY AS src_D_CITY,
  src_D_STATE_PROV AS src_D_STATE_PROV,
  src_D_POSTAL_CODE AS src_D_POSTAL_CODE,
  src_D_COUNTRY_CODE AS src_D_COUNTRY_CODE,
  src_D_PHONE_NUMBER AS src_D_PHONE_NUMBER,
  src_D_EMAIL AS src_D_EMAIL,
  src_BILL_FACILITY_ALIAS_ID AS src_BILL_FACILITY_ALIAS_ID,
  src_STORE_FACILITY_ALIAS_ID AS src_STORE_FACILITY_ALIAS_ID,
  src_SKU AS src_SKU,
  src_MV_CURRENCY_CODE AS src_MV_CURRENCY_CODE,
  src_TOTAL_MONETARY_VALUE AS src_TOTAL_MONETARY_VALUE,
  src_UNIT_MONETARY_VALUE AS src_UNIT_MONETARY_VALUE,
  src_UNIT_TAX_AMOUNT AS src_UNIT_TAX_AMOUNT,
  src_PRODUCT_CLASS_ID AS src_PRODUCT_CLASS_ID,
  src_ALLOCATED_QTY AS src_ALLOCATED_QTY,
  src_RELEASED_QTY AS src_RELEASED_QTY,
  src_CANCELLED_QTY AS src_CANCELLED_QTY,
  src_PPACK_QTY AS src_PPACK_QTY,
  src_DELIVERY_TZ AS src_DELIVERY_TZ,
  src_PICKUP_TZ AS src_PICKUP_TZ,
  src_PICKUP_START_DTTM AS src_PICKUP_START_DTTM,
  src_PICKUP_END_DTTM AS src_PICKUP_END_DTTM,
  src_DELIVERY_START_DTTM AS src_DELIVERY_START_DTTM,
  src_DELIVERY_END_DTTM AS src_DELIVERY_END_DTTM,
  src_REQ_DLVR_DTTM AS src_REQ_DLVR_DTTM,
  src_MUST_DLVR_DTTM AS src_MUST_DLVR_DTTM,
  src_SHIP_BY_DATE AS src_SHIP_BY_DATE,
  src_IS_READY_TO_SHIP AS src_IS_READY_TO_SHIP,
  src_IS_CANCELLED AS src_IS_CANCELLED,
  src_IS_CLOSED AS src_IS_CLOSED,
  src_IS_DELETED AS src_IS_DELETED,
  src_SHIPPED_QTY AS src_SHIPPED_QTY,
  src_RECEIVED_QTY AS src_RECEIVED_QTY,
  src_CREATED_SOURCE_TYPE AS src_CREATED_SOURCE_TYPE,
  src_CREATED_SOURCE AS src_CREATED_SOURCE,
  src_CREATED_DTTM AS src_CREATED_DTTM,
  src_LAST_UPDATED_DTTM AS src_LAST_UPDATED_DTTM,
  src_DSG_CARRIER_ID AS src_DSG_CARRIER_ID,
  src_PURCHASE_ORDERS_LN_STATUS AS src_PURCHASE_ORDERS_LN_STATUS,
  src_TC_PO_LN_ID AS src_TC_PO_LN_ID,
  src_ORDER_QTY AS src_ORDER_QTY,
  src_ALLOC_FINALIZER AS src_ALLOC_FINALIZER,
  src_IS_DO_CREATED AS src_IS_DO_CREATED,
  src_ORIG_ORDER_QTY AS src_ORIG_ORDER_QTY,
  src_RETAIL_PRICE AS src_RETAIL_PRICE,
  src_DSG_SHIP_VIA AS src_DSG_SHIP_VIA,
  src_LINE_TOTAL AS src_LINE_TOTAL,
  src_REASON_ID AS src_REASON_ID,
  src_ORDER_FULFILLMENT_OPTION AS src_ORDER_FULFILLMENT_OPTION,
  src_PRICE_OVERRIDE AS src_PRICE_OVERRIDE,
  src_ORIGINAL_PRICE AS src_ORIGINAL_PRICE,
  src_REASON_CODES_GROUP_ID AS src_REASON_CODES_GROUP_ID,
  src_ORDER_FULFILLMENT_CHANNEL AS src_ORDER_FULFILLMENT_CHANNEL,
  src_ORDER_CREATION_CHANNEL AS src_ORDER_CREATION_CHANNEL,
  src_ORDER_CHANNEL AS src_ORDER_CHANNEL,
  src_ORDER_NBR AS src_ORDER_NBR,
  src_OMS_ORDER_CREATED_TSTMP AS src_OMS_ORDER_CREATED_TSTMP,
  src_SCHED_DELIVERY_FLG AS src_SCHED_DELIVERY_FLG,
  src_SUBSCRIPTION_ORDER_FLG AS src_SUBSCRIPTION_ORDER_FLG,
  src_ADD_ON_FLAG AS src_ADD_ON_FLAG,
  src_CHARGE_NAME AS src_CHARGE_NAME,
  src_CHARGE_AMOUNT AS src_CHARGE_AMOUNT,
  src_ORIGINAL_CHARGE_AMOUNT AS src_ORIGINAL_CHARGE_AMOUNT,
  src_CODE_DESC AS src_CODE_DESC,
  src_RETURN_REASON_ID AS src_RETURN_REASON_ID,
  src_UNIT_SHIPPING_HANDLING_CHARGE AS src_UNIT_SHIPPING_HANDLING_CHARGE,
  src_TOTAL_FEE AS src_TOTAL_FEE,
  src_RETURN_CODE_DESC AS src_RETURN_CODE_DESC,
  src_RETURN_SHORT_DESC AS src_RETURN_SHORT_DESC,
  src_REASON_CODE AS src_REASON_CODE,
  src_CANCELLED_DTTM AS src_CANCELLED_DTTM,
  src_TRACKING_NBR AS src_TRACKING_NBR,
  ORIG_LOCATION_ID AS ORIG_LOCATION_ID,
  DEST_LOCATION_ID AS DEST_LOCATION_ID,
  BILL_LOCATION_ID1 AS BILL_LOCATION_ID1,
  STORE_LOCATION_ID AS STORE_LOCATION_ID,
  PRODUCT_ID1 AS PRODUCT_ID1,
  EXCHANGE_RATE_PCNT AS EXCHANGE_RATE_PCNT,
  LOAD_FLAG AS LOAD_FLAG,
  UPDATE_TSTMP AS UPDATE_TSTMP,
  LOAD_TSTMP AS LOAD_TSTMP,
  Monotonically_Increasing_Id AS Monotonically_Increasing_Id,
  DECODE(
    LOAD_FLAG,
    'INSERT',
    'DD_INSERT',
    'UPDATE',
    'DD_UPDATE'
  ) AS UPDATE_STRATEGY_FLAG
FROM
  FIL_FLAGS_52"""

df_53 = spark.sql(query_53)

df_53.createOrReplaceTempView("UPD_INSERT_UPDATE_53")

# COMMAND ----------
# DBTITLE 1, OMS_ORDER_LN


spark.sql("""MERGE INTO OMS_ORDER_LN AS TARGET
USING
  UPD_INSERT_UPDATE_53 AS SOURCE ON TARGET.OMS_ORDER_LN_ID = SOURCE.ORDER_LN_ID
  AND TARGET.OMS_ORDER_ID = SOURCE.ORDER_ID
  WHEN MATCHED
  AND SOURCE.UPDATE_STRATEGY_FLAG = "DD_UPDATE" THEN
UPDATE
SET
  TARGET.OMS_ORDER_ID = SOURCE.ORDER_ID,
  TARGET.OMS_ORDER_LN_ID = SOURCE.ORDER_LN_ID,
  TARGET.OMS_COMPANY_ID = SOURCE.src_TC_COMPANY_ID,
  TARGET.ORIG_LOCATION_NBR = SOURCE.src_O_FACILITY_ALIAS_ID,
  TARGET.ORIG_LOCATION_ID = SOURCE.ORIG_LOCATION_ID,
  TARGET.DEST_LOCATION_NBR = SOURCE.src_D_FACILITY_ALIAS_ID,
  TARGET.DEST_LOCATION_ID = SOURCE.DEST_LOCATION_ID,
  TARGET.SHIP_NAME = SOURCE.src_D_NAME,
  TARGET.SHIP_LAST_NAME = SOURCE.src_D_LAST_NAME,
  TARGET.SHIP_ADDRESS = SOURCE.src_D_ADDRESS,
  TARGET.SHIP_CITY = SOURCE.src_D_CITY,
  TARGET.SHIP_STATE = SOURCE.src_D_STATE_PROV,
  TARGET.SHIP_POSTAL_CD = SOURCE.src_D_POSTAL_CODE,
  TARGET.SHIP_COUNTRY_CD = SOURCE.src_D_COUNTRY_CODE,
  TARGET.SHIP_PHONE = SOURCE.src_D_PHONE_NUMBER,
  TARGET.SHIP_EMAIL = SOURCE.src_D_EMAIL,
  TARGET.BILL_LOCATION_NBR = SOURCE.src_BILL_FACILITY_ALIAS_ID,
  TARGET.BILL_LOCATION_ID = SOURCE.BILL_LOCATION_ID1,
  TARGET.STORE_LOCATION_NBR = SOURCE.src_STORE_FACILITY_ALIAS_ID,
  TARGET.STORE_LOCATION_ID = SOURCE.STORE_LOCATION_ID,
  TARGET.PRODUCT_ID = SOURCE.PRODUCT_ID1,
  TARGET.MV_CURRENCY_CD = SOURCE.src_MV_CURRENCY_CODE,
  TARGET.TOTAL_MONETARY_VALUE_AMT = SOURCE.src_TOTAL_MONETARY_VALUE,
  TARGET.UNIT_MONETARY_VALUE_AMT = SOURCE.src_UNIT_MONETARY_VALUE,
  TARGET.UNIT_TAX_AMOUNT_AMT = SOURCE.src_UNIT_TAX_AMOUNT,
  TARGET.PRODUCT_CLASS_ID = SOURCE.src_PRODUCT_CLASS_ID,
  TARGET.ALLOCATED_QTY = SOURCE.src_ALLOCATED_QTY,
  TARGET.RELEASED_QTY = SOURCE.src_RELEASED_QTY,
  TARGET.CANCELLED_QTY = SOURCE.src_CANCELLED_QTY,
  TARGET.PPACK_QTY = SOURCE.src_PPACK_QTY,
  TARGET.DELIVERY_TZ = SOURCE.src_DELIVERY_TZ,
  TARGET.PICKUP_TZ = SOURCE.src_PICKUP_TZ,
  TARGET.PICKUP_START_DT = SOURCE.src_PICKUP_START_DTTM,
  TARGET.PICKUP_END_DT = SOURCE.src_PICKUP_END_DTTM,
  TARGET.DELIVERY_START_DT = SOURCE.src_DELIVERY_START_DTTM,
  TARGET.DELIVERY_END_DT = SOURCE.src_DELIVERY_END_DTTM,
  TARGET.REQ_DLVR_DT = SOURCE.src_REQ_DLVR_DTTM,
  TARGET.MUST_DLVR_DT = SOURCE.src_MUST_DLVR_DTTM,
  TARGET.SHIP_BY_DT = SOURCE.src_SHIP_BY_DATE,
  TARGET.READY_TO_SHIP_FLG = SOURCE.src_IS_READY_TO_SHIP,
  TARGET.CANCELLED_FLG = SOURCE.src_IS_CANCELLED,
  TARGET.CLOSED_FLG = SOURCE.src_IS_CLOSED,
  TARGET.DELETED_FLG = SOURCE.src_IS_DELETED,
  TARGET.SHIPPED_QTY = SOURCE.src_SHIPPED_QTY,
  TARGET.RECEIVED_QTY = SOURCE.src_RECEIVED_QTY,
  TARGET.CREATED_SOURCE_TYPE = SOURCE.src_CREATED_SOURCE_TYPE,
  TARGET.CREATED_SOURCE = SOURCE.src_CREATED_SOURCE,
  TARGET.CREATED_TSTMP = SOURCE.src_CREATED_DTTM,
  TARGET.LAST_UPDATED_TSTMP = SOURCE.src_LAST_UPDATED_DTTM,
  TARGET.DSG_CARRIER_ID = SOURCE.src_DSG_CARRIER_ID,
  TARGET.OMS_ORDER_LN_STATUS_ID = SOURCE.src_PURCHASE_ORDERS_LN_STATUS,
  TARGET.OMS_ORDER_LN_NBR = SOURCE.src_TC_PO_LN_ID,
  TARGET.ORDER_QTY = SOURCE.src_ORDER_QTY,
  TARGET.ALLOC_FINALIZER = SOURCE.src_ALLOC_FINALIZER,
  TARGET.DIST_ORDER_CREATED_FLG = SOURCE.src_IS_DO_CREATED,
  TARGET.ORIG_ORDER_QTY = SOURCE.src_ORIG_ORDER_QTY,
  TARGET.RETAIL_PRICE = SOURCE.src_RETAIL_PRICE,
  TARGET.DSG_SHIP_VIA = SOURCE.src_DSG_SHIP_VIA,
  TARGET.LINE_TOTAL = SOURCE.src_LINE_TOTAL,
  TARGET.REASON_ID = SOURCE.src_REASON_ID,
  TARGET.ORDER_FULFILLMENT_OPTION = SOURCE.src_ORDER_FULFILLMENT_OPTION,
  TARGET.PRICE_OVERRIDE_FLG = SOURCE.src_PRICE_OVERRIDE,
  TARGET.ORIGINAL_PRICE_AMT = SOURCE.src_ORIGINAL_PRICE,
  TARGET.REASON_CDS_GROUP_ID = SOURCE.src_REASON_CODES_GROUP_ID,
  TARGET.ORDER_FULFILLMENT_CHANNEL = SOURCE.src_ORDER_FULFILLMENT_CHANNEL,
  TARGET.ORDER_CREATION_CHANNEL = SOURCE.src_ORDER_CREATION_CHANNEL,
  TARGET.ORDER_CHANNEL = SOURCE.src_ORDER_CHANNEL,
  TARGET.ORDER_NBR = SOURCE.src_ORDER_NBR,
  TARGET.OMS_ORDER_CREATED_TSTMP = SOURCE.src_OMS_ORDER_CREATED_TSTMP,
  TARGET.SCHED_DELIVERY_FLG = SOURCE.src_SCHED_DELIVERY_FLG,
  TARGET.SUBSCRIPTION_ORDER_FLG = SOURCE.src_SUBSCRIPTION_ORDER_FLG,
  TARGET.ADD_ON_FLAG = SOURCE.src_ADD_ON_FLAG,
  TARGET.SHIP_CHARGE_NAME = SOURCE.src_CHARGE_NAME,
  TARGET.SHIP_CHARGE_AMT = SOURCE.src_CHARGE_AMOUNT,
  TARGET.ORIG_SHIP_CHARGE_AMT = SOURCE.src_ORIGINAL_CHARGE_AMOUNT,
  TARGET.SHIP_CHARGE_DESC = SOURCE.src_CODE_DESC,
  TARGET.RETURN_REASON_ID = SOURCE.src_RETURN_REASON_ID,
  TARGET.RETURN_SHIP_HANDLING_AMT = SOURCE.src_UNIT_SHIPPING_HANDLING_CHARGE,
  TARGET.RETURN_TOTAL_FEE_AMT = SOURCE.src_TOTAL_FEE,
  TARGET.RETURN_CODE_DESC = SOURCE.src_RETURN_CODE_DESC,
  TARGET.RETURN_SHORT_DESC = SOURCE.src_RETURN_SHORT_DESC,
  TARGET.CANCEL_REASON_DESC = SOURCE.src_REASON_CODE,
  TARGET.CANCELLED_TSTMP = SOURCE.src_CANCELLED_DTTM,
  TARGET.EXCHANGE_RATE_PCNT = SOURCE.EXCHANGE_RATE_PCNT,
  TARGET.TRACKING_NBR = SOURCE.src_TRACKING_NBR,
  TARGET.UPDATE_TSTMP = SOURCE.UPDATE_TSTMP,
  TARGET.LOAD_TSTMP = SOURCE.LOAD_TSTMP
  WHEN MATCHED
  AND SOURCE.UPDATE_STRATEGY_FLAG = "DD_DELETE"
  AND TARGET.OMS_COMPANY_ID = SOURCE.src_TC_COMPANY_ID
  AND TARGET.ORIG_LOCATION_NBR = SOURCE.src_O_FACILITY_ALIAS_ID
  AND TARGET.ORIG_LOCATION_ID = SOURCE.ORIG_LOCATION_ID
  AND TARGET.DEST_LOCATION_NBR = SOURCE.src_D_FACILITY_ALIAS_ID
  AND TARGET.DEST_LOCATION_ID = SOURCE.DEST_LOCATION_ID
  AND TARGET.SHIP_NAME = SOURCE.src_D_NAME
  AND TARGET.SHIP_LAST_NAME = SOURCE.src_D_LAST_NAME
  AND TARGET.SHIP_ADDRESS = SOURCE.src_D_ADDRESS
  AND TARGET.SHIP_CITY = SOURCE.src_D_CITY
  AND TARGET.SHIP_STATE = SOURCE.src_D_STATE_PROV
  AND TARGET.SHIP_POSTAL_CD = SOURCE.src_D_POSTAL_CODE
  AND TARGET.SHIP_COUNTRY_CD = SOURCE.src_D_COUNTRY_CODE
  AND TARGET.SHIP_PHONE = SOURCE.src_D_PHONE_NUMBER
  AND TARGET.SHIP_EMAIL = SOURCE.src_D_EMAIL
  AND TARGET.BILL_LOCATION_NBR = SOURCE.src_BILL_FACILITY_ALIAS_ID
  AND TARGET.BILL_LOCATION_ID = SOURCE.BILL_LOCATION_ID1
  AND TARGET.STORE_LOCATION_NBR = SOURCE.src_STORE_FACILITY_ALIAS_ID
  AND TARGET.STORE_LOCATION_ID = SOURCE.STORE_LOCATION_ID
  AND TARGET.PRODUCT_ID = SOURCE.PRODUCT_ID1
  AND TARGET.MV_CURRENCY_CD = SOURCE.src_MV_CURRENCY_CODE
  AND TARGET.TOTAL_MONETARY_VALUE_AMT = SOURCE.src_TOTAL_MONETARY_VALUE
  AND TARGET.UNIT_MONETARY_VALUE_AMT = SOURCE.src_UNIT_MONETARY_VALUE
  AND TARGET.UNIT_TAX_AMOUNT_AMT = SOURCE.src_UNIT_TAX_AMOUNT
  AND TARGET.PRODUCT_CLASS_ID = SOURCE.src_PRODUCT_CLASS_ID
  AND TARGET.ALLOCATED_QTY = SOURCE.src_ALLOCATED_QTY
  AND TARGET.RELEASED_QTY = SOURCE.src_RELEASED_QTY
  AND TARGET.CANCELLED_QTY = SOURCE.src_CANCELLED_QTY
  AND TARGET.PPACK_QTY = SOURCE.src_PPACK_QTY
  AND TARGET.DELIVERY_TZ = SOURCE.src_DELIVERY_TZ
  AND TARGET.PICKUP_TZ = SOURCE.src_PICKUP_TZ
  AND TARGET.PICKUP_START_DT = SOURCE.src_PICKUP_START_DTTM
  AND TARGET.PICKUP_END_DT = SOURCE.src_PICKUP_END_DTTM
  AND TARGET.DELIVERY_START_DT = SOURCE.src_DELIVERY_START_DTTM
  AND TARGET.DELIVERY_END_DT = SOURCE.src_DELIVERY_END_DTTM
  AND TARGET.REQ_DLVR_DT = SOURCE.src_REQ_DLVR_DTTM
  AND TARGET.MUST_DLVR_DT = SOURCE.src_MUST_DLVR_DTTM
  AND TARGET.SHIP_BY_DT = SOURCE.src_SHIP_BY_DATE
  AND TARGET.READY_TO_SHIP_FLG = SOURCE.src_IS_READY_TO_SHIP
  AND TARGET.CANCELLED_FLG = SOURCE.src_IS_CANCELLED
  AND TARGET.CLOSED_FLG = SOURCE.src_IS_CLOSED
  AND TARGET.DELETED_FLG = SOURCE.src_IS_DELETED
  AND TARGET.SHIPPED_QTY = SOURCE.src_SHIPPED_QTY
  AND TARGET.RECEIVED_QTY = SOURCE.src_RECEIVED_QTY
  AND TARGET.CREATED_SOURCE_TYPE = SOURCE.src_CREATED_SOURCE_TYPE
  AND TARGET.CREATED_SOURCE = SOURCE.src_CREATED_SOURCE
  AND TARGET.CREATED_TSTMP = SOURCE.src_CREATED_DTTM
  AND TARGET.LAST_UPDATED_TSTMP = SOURCE.src_LAST_UPDATED_DTTM
  AND TARGET.DSG_CARRIER_ID = SOURCE.src_DSG_CARRIER_ID
  AND TARGET.OMS_ORDER_LN_STATUS_ID = SOURCE.src_PURCHASE_ORDERS_LN_STATUS
  AND TARGET.OMS_ORDER_LN_NBR = SOURCE.src_TC_PO_LN_ID
  AND TARGET.ORDER_QTY = SOURCE.src_ORDER_QTY
  AND TARGET.ALLOC_FINALIZER = SOURCE.src_ALLOC_FINALIZER
  AND TARGET.DIST_ORDER_CREATED_FLG = SOURCE.src_IS_DO_CREATED
  AND TARGET.ORIG_ORDER_QTY = SOURCE.src_ORIG_ORDER_QTY
  AND TARGET.RETAIL_PRICE = SOURCE.src_RETAIL_PRICE
  AND TARGET.DSG_SHIP_VIA = SOURCE.src_DSG_SHIP_VIA
  AND TARGET.LINE_TOTAL = SOURCE.src_LINE_TOTAL
  AND TARGET.REASON_ID = SOURCE.src_REASON_ID
  AND TARGET.ORDER_FULFILLMENT_OPTION = SOURCE.src_ORDER_FULFILLMENT_OPTION
  AND TARGET.PRICE_OVERRIDE_FLG = SOURCE.src_PRICE_OVERRIDE
  AND TARGET.ORIGINAL_PRICE_AMT = SOURCE.src_ORIGINAL_PRICE
  AND TARGET.REASON_CDS_GROUP_ID = SOURCE.src_REASON_CODES_GROUP_ID
  AND TARGET.ORDER_FULFILLMENT_CHANNEL = SOURCE.src_ORDER_FULFILLMENT_CHANNEL
  AND TARGET.ORDER_CREATION_CHANNEL = SOURCE.src_ORDER_CREATION_CHANNEL
  AND TARGET.ORDER_CHANNEL = SOURCE.src_ORDER_CHANNEL
  AND TARGET.ORDER_NBR = SOURCE.src_ORDER_NBR
  AND TARGET.OMS_ORDER_CREATED_TSTMP = SOURCE.src_OMS_ORDER_CREATED_TSTMP
  AND TARGET.SCHED_DELIVERY_FLG = SOURCE.src_SCHED_DELIVERY_FLG
  AND TARGET.SUBSCRIPTION_ORDER_FLG = SOURCE.src_SUBSCRIPTION_ORDER_FLG
  AND TARGET.ADD_ON_FLAG = SOURCE.src_ADD_ON_FLAG
  AND TARGET.SHIP_CHARGE_NAME = SOURCE.src_CHARGE_NAME
  AND TARGET.SHIP_CHARGE_AMT = SOURCE.src_CHARGE_AMOUNT
  AND TARGET.ORIG_SHIP_CHARGE_AMT = SOURCE.src_ORIGINAL_CHARGE_AMOUNT
  AND TARGET.SHIP_CHARGE_DESC = SOURCE.src_CODE_DESC
  AND TARGET.RETURN_REASON_ID = SOURCE.src_RETURN_REASON_ID
  AND TARGET.RETURN_SHIP_HANDLING_AMT = SOURCE.src_UNIT_SHIPPING_HANDLING_CHARGE
  AND TARGET.RETURN_TOTAL_FEE_AMT = SOURCE.src_TOTAL_FEE
  AND TARGET.RETURN_CODE_DESC = SOURCE.src_RETURN_CODE_DESC
  AND TARGET.RETURN_SHORT_DESC = SOURCE.src_RETURN_SHORT_DESC
  AND TARGET.CANCEL_REASON_DESC = SOURCE.src_REASON_CODE
  AND TARGET.CANCELLED_TSTMP = SOURCE.src_CANCELLED_DTTM
  AND TARGET.EXCHANGE_RATE_PCNT = SOURCE.EXCHANGE_RATE_PCNT
  AND TARGET.TRACKING_NBR = SOURCE.src_TRACKING_NBR
  AND TARGET.UPDATE_TSTMP = SOURCE.UPDATE_TSTMP
  AND TARGET.LOAD_TSTMP = SOURCE.LOAD_TSTMP THEN DELETE
  WHEN NOT MATCHED
  AND SOURCE.UPDATE_STRATEGY_FLAG = "DD_INSERT" THEN
INSERT
  (
    TARGET.OMS_ORDER_ID,
    TARGET.OMS_ORDER_LN_ID,
    TARGET.OMS_COMPANY_ID,
    TARGET.ORIG_LOCATION_NBR,
    TARGET.ORIG_LOCATION_ID,
    TARGET.DEST_LOCATION_NBR,
    TARGET.DEST_LOCATION_ID,
    TARGET.SHIP_NAME,
    TARGET.SHIP_LAST_NAME,
    TARGET.SHIP_ADDRESS,
    TARGET.SHIP_CITY,
    TARGET.SHIP_STATE,
    TARGET.SHIP_POSTAL_CD,
    TARGET.SHIP_COUNTRY_CD,
    TARGET.SHIP_PHONE,
    TARGET.SHIP_EMAIL,
    TARGET.BILL_LOCATION_NBR,
    TARGET.BILL_LOCATION_ID,
    TARGET.STORE_LOCATION_NBR,
    TARGET.STORE_LOCATION_ID,
    TARGET.PRODUCT_ID,
    TARGET.MV_CURRENCY_CD,
    TARGET.TOTAL_MONETARY_VALUE_AMT,
    TARGET.UNIT_MONETARY_VALUE_AMT,
    TARGET.UNIT_TAX_AMOUNT_AMT,
    TARGET.PRODUCT_CLASS_ID,
    TARGET.ALLOCATED_QTY,
    TARGET.RELEASED_QTY,
    TARGET.CANCELLED_QTY,
    TARGET.PPACK_QTY,
    TARGET.DELIVERY_TZ,
    TARGET.PICKUP_TZ,
    TARGET.PICKUP_START_DT,
    TARGET.PICKUP_END_DT,
    TARGET.DELIVERY_START_DT,
    TARGET.DELIVERY_END_DT,
    TARGET.REQ_DLVR_DT,
    TARGET.MUST_DLVR_DT,
    TARGET.SHIP_BY_DT,
    TARGET.READY_TO_SHIP_FLG,
    TARGET.CANCELLED_FLG,
    TARGET.CLOSED_FLG,
    TARGET.DELETED_FLG,
    TARGET.SHIPPED_QTY,
    TARGET.RECEIVED_QTY,
    TARGET.CREATED_SOURCE_TYPE,
    TARGET.CREATED_SOURCE,
    TARGET.CREATED_TSTMP,
    TARGET.LAST_UPDATED_TSTMP,
    TARGET.DSG_CARRIER_ID,
    TARGET.OMS_ORDER_LN_STATUS_ID,
    TARGET.OMS_ORDER_LN_NBR,
    TARGET.ORDER_QTY,
    TARGET.ALLOC_FINALIZER,
    TARGET.DIST_ORDER_CREATED_FLG,
    TARGET.ORIG_ORDER_QTY,
    TARGET.RETAIL_PRICE,
    TARGET.DSG_SHIP_VIA,
    TARGET.LINE_TOTAL,
    TARGET.REASON_ID,
    TARGET.ORDER_FULFILLMENT_OPTION,
    TARGET.PRICE_OVERRIDE_FLG,
    TARGET.ORIGINAL_PRICE_AMT,
    TARGET.REASON_CDS_GROUP_ID,
    TARGET.ORDER_FULFILLMENT_CHANNEL,
    TARGET.ORDER_CREATION_CHANNEL,
    TARGET.ORDER_CHANNEL,
    TARGET.ORDER_NBR,
    TARGET.OMS_ORDER_CREATED_TSTMP,
    TARGET.SCHED_DELIVERY_FLG,
    TARGET.SUBSCRIPTION_ORDER_FLG,
    TARGET.ADD_ON_FLAG,
    TARGET.SHIP_CHARGE_NAME,
    TARGET.SHIP_CHARGE_AMT,
    TARGET.ORIG_SHIP_CHARGE_AMT,
    TARGET.SHIP_CHARGE_DESC,
    TARGET.RETURN_REASON_ID,
    TARGET.RETURN_SHIP_HANDLING_AMT,
    TARGET.RETURN_TOTAL_FEE_AMT,
    TARGET.RETURN_CODE_DESC,
    TARGET.RETURN_SHORT_DESC,
    TARGET.CANCEL_REASON_DESC,
    TARGET.CANCELLED_TSTMP,
    TARGET.EXCHANGE_RATE_PCNT,
    TARGET.TRACKING_NBR,
    TARGET.UPDATE_TSTMP,
    TARGET.LOAD_TSTMP
  )
VALUES
  (
    SOURCE.ORDER_ID,
    SOURCE.ORDER_LN_ID,
    SOURCE.src_TC_COMPANY_ID,
    SOURCE.src_O_FACILITY_ALIAS_ID,
    SOURCE.ORIG_LOCATION_ID,
    SOURCE.src_D_FACILITY_ALIAS_ID,
    SOURCE.DEST_LOCATION_ID,
    SOURCE.src_D_NAME,
    SOURCE.src_D_LAST_NAME,
    SOURCE.src_D_ADDRESS,
    SOURCE.src_D_CITY,
    SOURCE.src_D_STATE_PROV,
    SOURCE.src_D_POSTAL_CODE,
    SOURCE.src_D_COUNTRY_CODE,
    SOURCE.src_D_PHONE_NUMBER,
    SOURCE.src_D_EMAIL,
    SOURCE.src_BILL_FACILITY_ALIAS_ID,
    SOURCE.BILL_LOCATION_ID1,
    SOURCE.src_STORE_FACILITY_ALIAS_ID,
    SOURCE.STORE_LOCATION_ID,
    SOURCE.PRODUCT_ID1,
    SOURCE.src_MV_CURRENCY_CODE,
    SOURCE.src_TOTAL_MONETARY_VALUE,
    SOURCE.src_UNIT_MONETARY_VALUE,
    SOURCE.src_UNIT_TAX_AMOUNT,
    SOURCE.src_PRODUCT_CLASS_ID,
    SOURCE.src_ALLOCATED_QTY,
    SOURCE.src_RELEASED_QTY,
    SOURCE.src_CANCELLED_QTY,
    SOURCE.src_PPACK_QTY,
    SOURCE.src_DELIVERY_TZ,
    SOURCE.src_PICKUP_TZ,
    SOURCE.src_PICKUP_START_DTTM,
    SOURCE.src_PICKUP_END_DTTM,
    SOURCE.src_DELIVERY_START_DTTM,
    SOURCE.src_DELIVERY_END_DTTM,
    SOURCE.src_REQ_DLVR_DTTM,
    SOURCE.src_MUST_DLVR_DTTM,
    SOURCE.src_SHIP_BY_DATE,
    SOURCE.src_IS_READY_TO_SHIP,
    SOURCE.src_IS_CANCELLED,
    SOURCE.src_IS_CLOSED,
    SOURCE.src_IS_DELETED,
    SOURCE.src_SHIPPED_QTY,
    SOURCE.src_RECEIVED_QTY,
    SOURCE.src_CREATED_SOURCE_TYPE,
    SOURCE.src_CREATED_SOURCE,
    SOURCE.src_CREATED_DTTM,
    SOURCE.src_LAST_UPDATED_DTTM,
    SOURCE.src_DSG_CARRIER_ID,
    SOURCE.src_PURCHASE_ORDERS_LN_STATUS,
    SOURCE.src_TC_PO_LN_ID,
    SOURCE.src_ORDER_QTY,
    SOURCE.src_ALLOC_FINALIZER,
    SOURCE.src_IS_DO_CREATED,
    SOURCE.src_ORIG_ORDER_QTY,
    SOURCE.src_RETAIL_PRICE,
    SOURCE.src_DSG_SHIP_VIA,
    SOURCE.src_LINE_TOTAL,
    SOURCE.src_REASON_ID,
    SOURCE.src_ORDER_FULFILLMENT_OPTION,
    SOURCE.src_PRICE_OVERRIDE,
    SOURCE.src_ORIGINAL_PRICE,
    SOURCE.src_REASON_CODES_GROUP_ID,
    SOURCE.src_ORDER_FULFILLMENT_CHANNEL,
    SOURCE.src_ORDER_CREATION_CHANNEL,
    SOURCE.src_ORDER_CHANNEL,
    SOURCE.src_ORDER_NBR,
    SOURCE.src_OMS_ORDER_CREATED_TSTMP,
    SOURCE.src_SCHED_DELIVERY_FLG,
    SOURCE.src_SUBSCRIPTION_ORDER_FLG,
    SOURCE.src_ADD_ON_FLAG,
    SOURCE.src_CHARGE_NAME,
    SOURCE.src_CHARGE_AMOUNT,
    SOURCE.src_ORIGINAL_CHARGE_AMOUNT,
    SOURCE.src_CODE_DESC,
    SOURCE.src_RETURN_REASON_ID,
    SOURCE.src_UNIT_SHIPPING_HANDLING_CHARGE,
    SOURCE.src_TOTAL_FEE,
    SOURCE.src_RETURN_CODE_DESC,
    SOURCE.src_RETURN_SHORT_DESC,
    SOURCE.src_REASON_CODE,
    SOURCE.src_CANCELLED_DTTM,
    SOURCE.EXCHANGE_RATE_PCNT,
    SOURCE.src_TRACKING_NBR,
    SOURCE.UPDATE_TSTMP,
    SOURCE.LOAD_TSTMP
  )""")

# COMMAND ----------
#Post session variable updation
updateVariable(postVariableAssignment, variablesTableName, mainWorkflowId, parentName, "m_OMS_Order_Ln")

# COMMAND ----------
#Update Mapping Variables in database.
persistVariables(variablesTableName, "m_OMS_Order_Ln", mainWorkflowId, parentName)
